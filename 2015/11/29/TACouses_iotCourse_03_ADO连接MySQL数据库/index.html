<!DOCTYPE html>
<html lang="zh-Hans">
<head>

    <!-- hexo-inject:begin --><!-- hexo-inject:end --><!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]-->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no" />
<meta name="author" content="Gary Chan" />



<meta name="description" content="本文旨在指导大家如何通过使用ADO数据库访问技术实现对MySQL数据库的访问和CURD等相关操作。在这个过程中，大家将会初步接触并了解：　　　　+1.　 存在哪些数据库访问技术;　　　　+2.　 什么是Windows COM编程;　　　　+3.　 如何为MySQL数据库配置ODBC数据源;　　　　+4.　 ADO编程如">
<meta name="keywords" content="MFC">
<meta property="og:type" content="article">
<meta property="og:title" content="ADO连接MySQL数据库">
<meta property="og:url" content="http://durant35.github.io/2015/11/29/TACouses_iotCourse_03_ADO连接MySQL数据库/index.html">
<meta property="og:site_name" content="Gary Chan&#39;s Blog">
<meta property="og:description" content="本文旨在指导大家如何通过使用ADO数据库访问技术实现对MySQL数据库的访问和CURD等相关操作。在这个过程中，大家将会初步接触并了解：　　　　+1.　 存在哪些数据库访问技术;　　　　+2.　 什么是Windows COM编程;　　　　+3.　 如何为MySQL数据库配置ODBC数据源;　　　　+4.　 ADO编程如何实现访问和操作MySQL数据库。">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://durant35.github.io/img/RFID/03-00.png">
<meta property="og:image" content="http://durant35.github.io/img/RFID/03-01.png">
<meta property="og:image" content="http://durant35.github.io/img/RFID/03-04.png">
<meta property="og:image" content="http://durant35.github.io/img/RFID/03-05.png">
<meta property="og:image" content="http://durant35.github.io/img/RFID/03-06.png">
<meta property="og:image" content="http://durant35.github.io/img/RFID/03-07.png">
<meta property="og:image" content="http://durant35.github.io/img/RFID/03-08.png">
<meta property="og:image" content="http://durant35.github.io/img/RFID/03-02.png">
<meta property="og:image" content="http://durant35.github.io/img/RFID/03-03.png">
<meta property="og:updated_time" content="2020-03-28T04:37:22.326Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ADO连接MySQL数据库">
<meta name="twitter:description" content="本文旨在指导大家如何通过使用ADO数据库访问技术实现对MySQL数据库的访问和CURD等相关操作。在这个过程中，大家将会初步接触并了解：　　　　+1.　 存在哪些数据库访问技术;　　　　+2.　 什么是Windows COM编程;　　　　+3.　 如何为MySQL数据库配置ODBC数据源;　　　　+4.　 ADO编程如何实现访问和操作MySQL数据库。">
<meta name="twitter:image" content="http://durant35.github.io/img/RFID/03-00.png">

<link rel="apple-touch-icon" href= "/apple-touch-icon.png">


    <link rel="alternate" href="/atom.xml" title="Gary Chan&#39;s Blog" type="application/atom+xml">



    <link rel="shortcut icon" href="/img/favicon.ico">



    <link href="//cdn.bootcss.com/animate.css/3.5.1/animate.min.css" rel="stylesheet">



    <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">



    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet">


<link rel="stylesheet" href="/css/style.css">



<link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">


<title>ADO连接MySQL数据库 | Gary Chan&#39;s Blog</title>

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>

<script>
    var yiliaConfig = {
        fancybox: true,
        animate: true,
        isHome: false,
        isPost: true,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: true
    }
</script>


    <script> yiliaConfig.jquery_ui = [false]; </script>



    <script> yiliaConfig.rootUrl = "\/";</script><!-- hexo-inject:begin --><!-- hexo-inject:end -->






</head>
<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="/img/avatar.png" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">Gary Chan</a></h1>
        </hgroup>

        
        <p class="header-subtitle">　　你永远流淌在我的记忆里？River flows in you</p>
        

        
            <form id="search-form">
            <input type="text" id="local-search-input" name="q" placeholder="search..." class="search form-control" autocomplete="off" autocorrect="off" searchonload="false" />
            <i class="fa fa-times" onclick="resetSearch()"></i>
            </form>
            <div id="local-search-result"></div>
            <p class='no-result'>No results found <i class='fa fa-spinner fa-pulse'></i></p>
        


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">Home</a></li>
                        
                            <li><a href="/tags">All-tags</a></li>
                        
                            <li><a href="/archives">All-lists</a></li>
                        
                            <li><a href="/garychan">Contact</a></li>
                        
                            <li><a href="/about">About</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa 新浪微博" href="http://weibo.com/u/2911566017/home?topnav=1&wvr=6" title="新浪微博"></a>
                            
                                <a class="fa GitHub" href="https://github.com/Durant35" title="GitHub"></a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/3D/">3D</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/AES/">AES</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Algorithm/">Algorithm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Android/">Android</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/C-C/">C/C++</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CG/">CG</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CMD/">CMD</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CMake/">CMake</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CV/">CV</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DARPA/">DARPA</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DES/">DES</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DLL/">DLL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Encoding/">Encoding</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HUAWEI/">HUAWEI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hexo/">Hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JPEG/">JPEG</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JSP/">JSP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/">Java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Key-words/">Key-words</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LZW/">LZW</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MCU/">MCU</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MFC/">MFC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NotePad/">NotePad++</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OpenCL/">OpenCL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OpenGL/">OpenGL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PCB/">PCB</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Qt/">Qt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ROS/">ROS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Socket/">Socket</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VM/">VM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VS2013/">VS2013</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vim/">Vim</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Windows/">Windows</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/bash/">bash</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dumpbin/">dumpbin</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ini/">ini</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/leetcode/">leetcode</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pcap/">pcap</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tmux/">tmux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vimium/">vimium</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/文件操作/">文件操作</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/漫威电影/">漫威电影</a></li></ul>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a class="main-nav-link switch-friends-link" href="https://hexo.io">Hexo</a>
                    
                      <a class="main-nav-link switch-friends-link" href="https://github.com/">GitHub</a>
                    
                      <a class="main-nav-link switch-friends-link" href="http://wiki.ros.org/">ROS</a>
                    
                      <a class="main-nav-link switch-friends-link" href="http://zhiqiu.github.io/">Zhiqiu&#39;s Blog</a>
                    
                      <a class="main-nav-link switch-friends-link" href="http://www.ruanyifeng.com/blog/">阮一峰的网络日志</a>
                    
                      <a class="main-nav-link switch-friends-link" href="https://rh-song.github.io/">RiHui-Song&#39;s Blog</a>
                    
                      <a class="main-nav-link switch-friends-link" href="https://goshin.github.io/">Goshin&#39;s Blog</a>
                    
                      <a class="main-nav-link switch-friends-link" href="http://blog.csdn.net/u014593748">Kangdk&#39;s CSDN</a>
                    
                    </div>
                </section>
                

                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">Gary Chan</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="/img/avatar.png" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">Gary Chan</a></h1>
            </hgroup>
            
            <p class="header-subtitle">　　你永远流淌在我的记忆里？River flows in you</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">Home</a></li>
                
                    <li><a href="/tags">All-tags</a></li>
                
                    <li><a href="/archives">All-lists</a></li>
                
                    <li><a href="/garychan">Contact</a></li>
                
                    <li><a href="/about">About</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa 新浪微博" target="_blank" href="http://weibo.com/u/2911566017/home?topnav=1&wvr=6" title="新浪微博"></a>
                            
                                <a class="fa GitHub" target="_blank" href="https://github.com/Durant35" title="GitHub"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
    <link class="menu-list" tags="标签" friends="友情链接" about="关于我"/>
</nav>
      <div class="body-wrap"><article id="post-TACouses_iotCourse_03_ADO连接MySQL数据库" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/11/29/TACouses_iotCourse_03_ADO连接MySQL数据库/" class="article-date">
      <time datetime="2015-11-29T01:50:30.000Z" itemprop="datePublished">2015-11-29</time>
</a>



 
    <a href="/2015/11/29/TACouses_iotCourse_03_ADO连接MySQL数据库/#comments" title="查看评论">
        <i class="fa fa-comments-o" aria-hidden="true"></i>
        <span class="count-comment"></span>
        
        
            <span class="disqus-comment-count" data-disqus-identifier="2015/11/29/TACouses_iotCourse_03_ADO连接MySQL数据库/"></span>
        
    </a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      ADO连接MySQL数据库
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/TA-Cources/">TA Cources</a><a class="article-category-link" href="/categories/TA-Cources/IoT/">IoT</a>
    </div>


        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MFC/">MFC</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>　　本文旨在指导大家如何通过使用<strong>ADO数据库访问技术</strong>实现对<strong>MySQL数据库</strong>的访问和<strong>CURD</strong>等相关操作。在这个过程中，大家将会初步接触并了解：<br>　　　　<strong>+1.　</strong> 存在哪些<strong>数据库访问技术</strong>;<br>　　　　<strong>+2.　</strong> 什么是<strong>Windows COM编程</strong>;<br>　　　　<strong>+3.　</strong> 如何为<strong>MySQL数据库</strong>配置<strong>ODBC数据源</strong>;<br>　　　　<strong>+4.　</strong> <strong>ADO编程</strong>如何实现访问和操作<strong>MySQL数据库</strong>。<br><a id="more"></a></p>
<h2 id="第一节-数据库访问技术"><a href="#第一节-数据库访问技术" class="headerlink" title="第一节 数据库访问技术"></a><strong>第一节 数据库访问技术</strong></h2><p>　　当一个项目存在大量的数据需要存储时，通常都会采用数据库来存储这些数据。最初，厂商推出一个新的数据库产品时，会为程序员提供一套访问该数据库的接口(<strong>即API</strong>)，显然不同的数据库产商提供的访问接口是不会完全一样的。这样，在使用一个新的数据库时，就不得不学习一套新的<strong>API</strong>，无疑加大程序员的开发难度；数据移植性也受到影响，比如想使用另一种数据库的数据，你只能使用那种数据库提供的<strong>API</strong>重新写代码；总之，不利于数据库在软件开发过程中的应用。<br>　　解决这个问题的关键，就是<strong>实现一种隐藏机制，提供一套统一的访问接口，让访问接口与具体数据库实现脱离</strong>。<strong>Windows</strong>下一些标准的数据库访问技术应运而生，常用的有<strong>:</strong></p>
<p>　　<font color="green"><strong>+. ODBC(Open Database Connectivity)</strong></font><br>　　<strong>开放数据库互联</strong>体系结构如下图<strong>：</strong><br>    <center><img src="/img/RFID/03-00.png" width="600px"/></center><br>　　我们编写的客户程序直接与<strong>ODBC驱动程序管理器</strong>打交道，在访问不同的数据库时，需要指定相应的<strong>ODBC驱动程序</strong>，<strong>ODBC驱动程序管理器</strong>将客户的请求转换为相应的<strong>ODBC驱动</strong>传递给数据库。<strong>ODBC</strong>提供了一个单一的<strong>API</strong>，使用<strong>ODBC API</strong>的应用程序可以与任何具有<strong>ODBC驱动程序</strong>的<strong>关系型数据库</strong>进行通信。</p>
<p>　　<font color="green"><strong>+. OLE DB(Object Link and Embed Database)</strong></font><br>　　<strong>对象链接与嵌入数据库</strong>体系结构如下图<strong>：</strong><br>    <center><img src="/img/RFID/03-01.png" width="720px"/></center><br>　　<strong>OLE DB</strong>在两个方面对<strong>ODBC</strong>进行了扩展<strong>：</strong><br>　　　　<strong>1. </strong>提供了一个数据库编程的<a href="#com"><strong>COM接口</strong> (点击查看<strong>《COM(Componet Object Model)》</strong>一节)</a><strong>;</strong>　　<br>　　　　<strong>2. </strong>提供可用于<strong>关系型</strong>和<strong>非关系型</strong>的数据源的接口。<strong>ODBC</strong>只能访问关系型数据库，<strong>OLE DB</strong>还可以访问<strong>电子表格</strong>、<strong>文本文件</strong>等非关系型数据源。<br>　　<strong>OLE DB应用程序</strong>利用不同的<strong>OLE DB提供程序</strong>可以访问不同的数据源，只要这些数据源提供了相应的<strong>OLE DB提供程序；</strong>如果某个<strong>关系型数据库</strong>没有<strong>OLE DB提供程序</strong>，可以利用访问<strong>ODBC的OLE DB提供程序</strong>去访问<strong>ODBC</strong>，然后再利用<strong>ODBC</strong>去访问支持<strong>ODBC</strong>的数据库(<strong>我们访问MySQL数据库的方式正是如此，不过刚安装好的MySQL数据库还不能通过ODBC直接访问，需要先为其<a href="#ODBC">配置好ODBC数据源!!</a></strong>)。</p>
<p>　　<font color="green"><strong>+. ADO(ActiveX Data Object)</strong></font><br>　　如上 <strong>“图:OLE DB体系结构”</strong> 所示，<strong>ActiveX数据对象</strong>建立在<strong>OLE DB</strong>之上，本身就是一个<strong>OLE DB应用程序(Consumer)</strong>，<strong>ADO应用程序</strong>通过<strong>ADO</strong>再访问<strong>OLE DB提供程序  </strong><font color="red">(所以访问速度会变慢一些)</font>，实现对不同类型数据源的访问。<br>　　<strong>OLE DB</strong>通过一系列<strong>COM接口</strong>提供数据的底层连接，<strong>ADO</strong>则通过<strong>对象模型</strong>，将这些接口封装成一个对象，使其成为<strong>抽象实体</strong>，简化了<strong>OLE DB</strong>的数据访问过程。<br>　　此外，<strong>OLE DB</strong>对<strong>自动化</strong>的支持不是很好，像<strong>VBScript</strong>这种<strong>自动化脚本语言</strong>就不能使用<strong>OLE DB</strong>访问数据库，而<strong>ADO</strong>则能更好的支持<strong>自动化</strong>。</p>
<h2 id="第二节-COM-Componet-Object-Model"><a href="#第二节-COM-Componet-Object-Model" class="headerlink" title="第二节 COM(Componet Object Model)"></a><strong><span id="com">第二节 COM(Componet Object Model)</span></strong></h2><p>　　软件工程的目的是：<strong>软件能像堆积木一样累积起来、组装起来，而不是一点点编出来</strong>。大概历经了如下几个过程<strong>：</strong></p>
<p>　　　<font color="green"><strong>1&gt;. 面向功能的结构化编程</strong></font><br>　　　在这个过程中，程序员注重事物之间的联系，然而联系是多变的，而事物本身不会发生大的变化。<strong>软件工程的核心是模块化，</strong>联系一变，就是另一种功能，就得写多一个模块了。</p>
<p>　　　<font color="green"><strong>2&gt;. 面向对象编程</strong></font><br>　　　注重事物本身固有的属性，固有的行为。面向对象的着眼点就是事物这种稳定的概念，而事物之间的联系是多变的，运动的。用类描述事物，当类间的联系发生改变时只需重新使用类库即可。然而面向对象方法在重用上存在不少问题。<strong>类库的重用是基于源码</strong>，限制了编程语言；类库发行新版本时，必须重新编译，重新调试。</p>
<p>　　　<font color="green"><strong>3&gt;. DLL编程</strong></font><br>　　　<strong>DLL</strong>是基于二进制的代码重用，不存在类库重用时的问题，不过，<strong>DLL</strong>中存在的函数重名、各编译器对C++函数名字改编不兼容、<strong>DLL</strong>路径(将<strong>DLL</strong>放在自己的目录下面，别人的程序找不到，放在系统目录下，又可能有重名的问题，<strong>真正的组件应该可以放在任何地方甚至可以不在本机，用户根本不需考虑这个问题</strong>)、可执行程序的依赖性(如果<strong>DLL</strong>发行了一个新版本，很有必要重新链接一次，因为DLL里面导出函数的地址可能已经发生了改变)等问题。</p>
<p>　　　<font color="green"><strong>4&gt;. COM编程</strong></font><br>　　　<strong>COM</strong>中通过<strong>虚函数表</strong>、<strong>查找注册表</strong>等手段能够很好的解决上述列举的<strong>DLL</strong>不足。</p>
<p>　　所谓<strong>COM(Componet Object Model，组件对象模型) </strong>是一种跨应用和语言共享二进制代码的规范，此规范提供了为保证能够互操作，应用程序和共享组件应遵循的一些二进制和网络标准。<strong>COM</strong>定义了这样的一种二进制标准<strong>：</strong><br>　　　<strong>首先，COM </strong> 明确指出二进制模块<strong>(DLLs和EXEs)</strong>必须被编译成指定的结构，这个标准也确切规定了在内存中如何组织<strong>COM对象</strong>。<br>　　　<strong>其次，COM</strong> 定义的二进制标准必须独立于任何编程语言，即不允许出现类似<strong>DLL</strong>的名字改编不兼容的问题。</p>
<p>　　通过这种标准实现可以任意使用共享组件而不用考虑应用程序与共享组件所处的操作环境是否相同、使用的开发语言是否一致以及是否运行在同一台计算机上。<br>　　<font color="blue">遵循<strong>COM规范</strong>编写的任何一个<strong>组件</strong>(<strong>特指在二进制级别上进行集成和重用而能够被独立开发和配置的软件单元</strong>)都可以被用来组合成应用程序。在<strong>COM规范</strong>下将能够以高度灵活的编程手段来开发、维护应用程序，可以将一个单独的复杂应用程序划分为多个独立的模块进行开发，这里的每一个独立模块都是自给自足的<strong>组件</strong>，可以采用不同的开发语言，在运行时将这些<strong>组件</strong>通过<strong>接口</strong>组装起来以形成所需要的应用程序。构成应用程序的每一个<strong>组件</strong>都可以在不影响其它<strong>组件</strong>的前提下升级。</font><br>　　<font color="#625A05">应用程序在与<strong>COM组件</strong>进行交互时(如：使用<strong>ADO COM</strong>库操纵<strong>MySQL</strong>数据库)，只需知道与哪个<strong>COM对象</strong>进行交互即可，而不必关心组件模块的具体名称和所处的位置，也就是<strong>COM对象</strong>的位置对客户是透明的。通过调用<strong>COM库</strong>的<strong>API</strong>来创建对象，通过<strong>Release</strong>方法减少对象自己保持的引用计数，当引用计数为零时，<strong>COM对象</strong>将自己从内存中释放<strong>(记得调用Release，减少不必要的内存开销)</strong>。</font><br>　　最后，得记住的是，<strong>COM</strong>不是<strong>Win32</strong>特有的，从理论上讲，它可以被移植到其他操作系统，因为它本身只是一种规范!!</p>
<h2 id="第三节-配置ODBC数据源"><a href="#第三节-配置ODBC数据源" class="headerlink" title="第三节 配置ODBC数据源"></a><strong><span id="ODBC">第三节 配置ODBC数据源</strong></span></h2><p>　　经过上述的描述后，你现在应该大概明白，所谓通过<strong>ADO</strong>操纵<strong>MySQL数据库</strong>，即 <strong>我们写的应用程序直接与ADO COM库的API打交道，ADO则使用访问ODBC的OLE DB提供程序去访问ODBC，然后再利用ODBC去访问我们的MySQL数据库！</strong> <strong>MySQL数据库</strong>支持<strong>ODBC</strong>，但需要进行相关配置，安装好<strong>MySQL数据库</strong>后需要为其安装<strong>ODBC驱动程序</strong>以及<strong>配置ODBC数据源</strong>，才可以在应用程序中通过<strong>ADO访问该ODBC数据源</strong>进而操纵<strong>MySQL数据库</strong>。<a href="http://yunpan.cn/c3Vd49IQzEVs8">所有安装文件可以从这里获取</a>，访问密码<strong><code>bbaa</code></strong>。<br>　　安装<strong>MySQL</strong>及其<strong>ODBC驱动程序</strong>后，我们需要先在<strong>MySQL数据库</strong>中为项目创建一个数据库，然后才可以为<strong>MySQL数据库</strong>配置<strong>ODBC数据源</strong>。</p>
<p>　　<font color="#625A05"><strong>第一步，开始 <font size="5">→</font> 控制面板 <font size="5">→</font> 管理工具 <font size="5">→</font> 打开数据源(ODBC)</strong></font><strong>：</strong><br>    <center><img src="/img/RFID/03-04.png" /></center><br>　　<font color="red"><strong>注意： </strong></font>安装文件中用的是<strong>32位的MySQL</strong>，需要用<strong>32位的ODBC配置管理器</strong>，而一般<strong>64位系统存在的快捷方式都是64位的ODBC配置管理器(如上图Win7旗舰版管理工具下显示的数据源(ODBC))</strong>，这就需要你在<strong> C:\Windows\SysWOW64\ </strong>下找到<strong>32位的ODBC配置管理器 “odbcad32.exe”</strong>，双击运行它。<strong>Win8.1已经在这方面做出改进，如上图，32位和64位的数据源(ODBC)均将其列出！</strong></p>
<p>　　<font color="#625A05"><strong>第二步，在用户DSN选项卡中点击”添加”按钮，弹出”创建新数据源”窗口</strong></font><strong>：</strong><br>    <center><img src="/img/RFID/03-05.png" width="540px"/></center></p>
<p>　　<font color="#625A05"><strong>第三步，选中”MYSQL ODBC 5.1 Driver”，点击”完成”按钮</strong></font><strong>：</strong><br>    <center><img src="/img/RFID/03-06.png"  width="720px"/></center></p>
<p>　　<font color="#625A05"><strong>最后一步，正确输入数据源信息，进行Test验证</strong></font><strong>：</strong><br>    <center><img src="/img/RFID/03-07.png"  width="400px"/></center><br>　　<font color="red"><strong>注意： </strong></font>此处的数据源信息与<a href="#ConnString"> 下一节ADO编程使用的连接字符串</a> (<strong>“DSN=datasource_name; Database=database_name; uid=user_name;pwd=password”</strong>)密切相关，编程时使用的连接字符串必须与此处的配置信息保持一致才能访问成功。<strong>此处的Database下拉菜单中如不意外，将出现上面操作中为项目创建的数据库，我们选择其来创建数据源</strong>。</p>
<p>　　<font color="#625A05"><strong>如果出现以下结果，测试成功，数据源已经成功配置！否则，一般是数据库密码没有正确输入，重新输入后再次Test</strong></font><strong>：</strong><br>    <center><img src="/img/RFID/03-08.png"  width="720px"/></center></p>
<p>　　数据库开发环境搭建完毕后，就需要结合项目功能需求考虑<strong>需要哪几张表</strong>，每张<strong>表的结构</strong>如何设计等问题。<strong>DEMO </strong>中的数据库结构简单如下<strong>：</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">database</span> <span class="keyword">if</span> <span class="keyword">exists</span> ZD124UE_DEMO;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">database</span> ZD124UE_DEMO;</span><br><span class="line"><span class="keyword">use</span> ZD124UE_DEMO;</span><br><span class="line"> </span><br><span class="line"># 用户余时表</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> <span class="keyword">if</span> <span class="keyword">exists</span> RemainTimeTable;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> RemainTimeTable(</span><br><span class="line">　　UID <span class="built_in">char</span>(<span class="number">10</span>) primary <span class="keyword">key</span>,</span><br><span class="line">　　RemainTime <span class="built_in">int</span> <span class="keyword">default</span> <span class="number">0</span></span><br><span class="line">);</span><br><span class="line"> </span><br><span class="line"># 用户上机表</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> <span class="keyword">if</span> <span class="keyword">exists</span> OnTable;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="keyword">if</span> <span class="keyword">not</span> <span class="keyword">exists</span> OnTable(</span><br><span class="line">　　UID <span class="built_in">char</span>(<span class="number">10</span>) primary <span class="keyword">key</span>,</span><br><span class="line">　　RemainTime <span class="built_in">int</span> <span class="keyword">default</span> <span class="number">0</span>,</span><br><span class="line">　　# datetime格式必须是<span class="string">"%Y/%m/%d %H:%M:%S"</span></span><br><span class="line">　　StartTime datetime,</span><br><span class="line">　　isOvertime <span class="built_in">boolean</span> <span class="keyword">default</span> <span class="literal">false</span>,</span><br><span class="line">　　# 可以增加上机时间记录(单位:秒) UsingTime <span class="built_in">int</span> <span class="keyword">default</span> <span class="number">0</span>,</span><br><span class="line">　　foreign <span class="keyword">key</span>(UID) <span class="keyword">references</span> RemainTimeTable(UID)</span><br><span class="line">);</span><br></pre></td></tr></table></figure></p>
<h2 id="第四节-ADO编程"><a href="#第四节-ADO编程" class="headerlink" title="第四节 ADO编程"></a><strong>第四节 ADO编程</strong></h2><p>　　<strong>ADO</strong>通过<strong>OLE DB</strong>实现对不同类型数据源的访问。<strong>OLE DB</strong>是底层的编程接口，它通过一系列<strong> COM接口 </strong>提供数据的底层连接，<strong>ADO</strong>也是以<strong>COM</strong>的方式提供，所以它的很多行为遵循<strong>COM规范</strong>。我们也直接用<strong>COM</strong>提供的<strong>ADO API</strong>访问<strong>MySQL数据库</strong>。首先要导入<strong>ADO</strong>的<strong> COM文件</strong>。<br>　　<font color="#FF2400" size="4"><strong>@-引入ADO COM文件</strong></font><br>　　使用预处理指令<strong>#import</strong>导入<strong> msado15.dll </strong>这个<strong> ADO COM文件：</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment"> * 导入ADO的COM文件</span></span><br><span class="line"><span class="comment"> * no_namespace是指忽略命名空间，因此需要将EOF重命名为ADOEOF, BOF重命名为ADOBOF防止命名冲突</span></span><br><span class="line"><span class="comment"> * 该代码需要在一行中完成，如果写成两行或者多行，行末要加上“\”续行符，表示把这几行看成一行</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"./libs/msado15.dll"</span> no_namespace rename(<span class="meta-string">"EOF"</span>,<span class="meta-string">"ADOEOF"</span>) rename(<span class="meta-string">"BOF"</span>,<span class="meta-string">"ADOBOF"</span>)</span></span><br></pre></td></tr></table></figure></p>
<p>　　在<strong>XP及以上</strong>的系统都自带有<strong> msado15.dll </strong>，并且都已经在系统中注册(<strong>全局路径一般是C:\Program Files\Common Files\System\ado\msado15.dll</strong>)，所以我们的应用程序打包时，可以不用将<strong> msado15.dll </strong>打包，程序可以直接在<strong>XP及以上</strong>的系统上运行。<br>　　<font color="red"><strong>建议将 msado15.dll 拷贝到”工程目录/libs/“ 第三方库目录下(没有libs可以通过新建文件夹的方式创建)，此处的 “./libs/msado15.dll” 正是通过此方式导入</strong></font>。<br>　　程序在编译过程中，<strong>VC++</strong> 会读出<strong> msado15.dll </strong>中的类型库信息，自动产生两个该类型库的头文件(<strong> msado15.tlh </strong>)和实现文件(<strong> msado15.tli </strong>)，在这两个文件里定义了<strong>ADO</strong>的所有<strong>对象和方法</strong>，以及一些<strong>枚举型的常量</strong>等，我们只需直接调用这些方法就行了。</p>
<p>　　<font color="#FF2400" size="4"><strong>@-初始化COM</strong></font><br>　　用<strong>ADO</strong>写代码前，要将<strong>COM 初始化</strong>，这时因为<strong> COM组件 </strong>在使用前需要初始化<strong> COM库</strong>，访问完<strong> COM库 </strong>后，程序还需要卸载<strong> COM库</strong>。常见的手段是在代码前后加上<strong> CoInitialize(NULL); </strong>和<strong> CoUninitialize(); </strong>，也可以用<strong> AfxOleInit(); </strong>和<strong> AfxOleTerm(); </strong>来初始化库，后一种方法具体实现中除了调用<strong> CoInitialize(NULL); </strong>初始化<strong> COM库 </strong>外，还做了一些其他的操作，这些操作对<strong> OLE 应用 </strong>来说是必须的。考虑到性能，一般使用第一种方法初始化。</p>
<p>　　<font color="#FF2400" size="4"><strong>@-三个核心对象</strong></font><br>　　<strong>ADO</strong>主要包含了七个对象，包括三个独立对象(<strong>Connection、Recordset、Command</strong>)和依赖独立对象才能使用的四个非独立对象(<strong>Field、Parameter、Property、Error</strong>)。<br>　　<strong>+. Connection连接对象： </strong>表示到数据库的连接，管理应用程序和数据库之间的通信<strong>；</strong></p>
<p>　　<strong>+. Recordset记录集对象： </strong>存放查询的结果，结果由数据的行(<strong>称为记录</strong>)和列(<strong>称为字段</strong>)组成<strong>；</strong></p>
<p>　　<strong>+. Command命令对象： </strong>用于执行对数据库的操作<strong>；</strong></p>
<p>　　<strong>+. Field字段对象： </strong>依赖于<strong>Recordset对象</strong>使用，可使用<strong> Fields集合 </strong>获得记录集中每个字段的信息<strong>；</strong></p>
<p>　　<strong>+. Parameter参数对象： </strong>依赖于<strong>Command命令对象</strong>使用，用于为参数查询提供数据<strong>；</strong></p>
<p>　　<strong>+. Property属性对象： </strong>每个连接、记录集、命令对象以及字段对象都有一个属性对象集合<strong>；</strong></p>
<p>　　<strong>+. Error错误对象： </strong>依赖<strong>Connection对象</strong>使用，连接对象的<strong> Errors集合 </strong>保存错误信息<strong>。</strong></p>
<p>　　要实例化<strong>Connection、Recordset、Command</strong>这三个核心对象，进而使用它们提供的方法，需要使用它们的智能指针<strong>_XxxxPtr</strong> <font color="#625A05">(<strong>其中的”_Xxxx”可以是Connection、Recordset或者是Command</strong>)</font>。</p>
<p>　　<font color="#FF2400" size="4"><strong><span id="CoreObj">@-对象实例化</strong></span></font><br>　　通过名字创建对象可能会冲突，通过 <strong>uuid(通用唯一识别码)</strong> 创建对象则是唯一的。<strong>注意： 使用的名字必须为”ADODB.Xxxx”，其中的”Xxxx”可以是Connection、Recordset或者是Command！</strong><br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 方式一: 通过名字创建</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">_XxxxPtr m_pXxxx;</span><br><span class="line">m_pXxxx.CreateInstance(<span class="string">"ADODB.Xxxx"</span>);</span><br><span class="line"> </span><br><span class="line"># 或者直接初始化</span><br><span class="line">_<span class="function">XxxxPtr <span class="title">m_pXxxx</span><span class="params">(<span class="string">"ADODB.Xxxx"</span>)</span></span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 方式二: 通过uuid创建</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">_XxxxPtr m_pXxxx;</span><br><span class="line">m_pXxxx.CreateInstance(__uuidof(Xxxx));</span><br><span class="line"> </span><br><span class="line"># 或者直接初始化</span><br><span class="line">_XxxxPtr m_pXxxx(__uuidof(Xxxx));</span><br></pre></td></tr></table></figure></p>
<p>　　所谓<strong> 智能指针_XxxxPtr </strong>，在初始化(<strong>CreateInstance</strong>)或释放(<strong>Release</strong>)等操作时，它们是一个对象，用<strong><code>.</code>操作符</strong>，其他大部分操作则使用<code>-&gt;</code>操作符。<br>　　数据类型<strong> _XxxxPtr </strong>实际上是由类模板<strong> _com_ptr_t </strong>而得到的一个具体的实例类，<strong> msado15.tlh </strong>中有<strong>：</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">_COM_SMARTPTR_TYPEDEF(_Connection, __uuidof(_Connection));</span><br><span class="line">_COM_SMARTPTR_TYPEDEF(_Recordset, __uuidof(_Recordset));</span><br><span class="line">_COM_SMARTPTR_TYPEDEF(_Command, __uuidof(_Command));</span><br></pre></td></tr></table></figure></p>
<p>　　经宏扩展后就得到了<strong> _XxxxPtr </strong>类，该类封装了<strong> Xxxx </strong>对象、<strong>Idispath接口指针 </strong>及一些必要的操作，我们就是通过<strong> 智能指针_XxxxPtr </strong>来操纵<strong> Connection对象、Recordset对象和Command对象</strong>的<strong> !!!</strong></p>
<p>　　<font color="#FF2400" size="4"><strong><span id="ConnString">@- _ConnectionPtr实现数据库连接与断开</span></strong></font><br>　　<strong>ADO</strong>使用<strong>Connection对象</strong>来建立与数据库服务器的连接，只有建立了连接后，才能进行其他有关数据库的访问和操作。<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment"> * @function 连接数据库</span></span><br><span class="line"><span class="comment"> * @param void</span></span><br><span class="line"><span class="comment"> * @retval BOOL</span></span><br><span class="line"><span class="comment"> *    连接成功返回true，失败则返回false</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">BOOL CAdoMySQLHelper::MySQL_Connect()&#123;</span><br><span class="line">　　# 初始化OLE/COM库环境</span><br><span class="line">　　CoInitialize(<span class="literal">NULL</span>);		# ADO也是一个COM组件，COM组件在使用时需要调用CoInitialize初始化库</span><br><span class="line">　　<span class="comment">/*</span></span><br><span class="line"><span class="comment">　　 * 另外一种方式初始化COM库，建议使用第一种</span></span><br><span class="line"><span class="comment">　　 * AfxOleInit();</span></span><br><span class="line"><span class="comment">　　 */</span></span><br><span class="line">　　<span class="keyword">try</span> &#123;</span><br><span class="line">　　　　# 通过名字创建Connection对象</span><br><span class="line">　　　　HRESULT hr = <span class="keyword">this</span>-&gt;m_pConnection.CreateInstance(<span class="string">"ADODB.Connection"</span>);</span><br><span class="line">　　　　<span class="keyword">if</span>(FAILED(hr))&#123;</span><br><span class="line">　　　　　　AfxMessageBox(<span class="string">"创建_ConnectionPtr智能指针失败"</span>);</span><br><span class="line">　　　　　　<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">　　　　&#125;</span><br><span class="line"> </span><br><span class="line">　　　　# 设置连接超时时间  </span><br><span class="line">　　　　<span class="keyword">this</span>-&gt;m_pConnection-&gt;ConnectionTimeout = <span class="number">600</span>;</span><br><span class="line">　　　　# 设置执行命令超时时间</span><br><span class="line">　　　　<span class="keyword">this</span>-&gt;m_pConnection-&gt;CommandTimeout = <span class="number">120</span>;</span><br><span class="line"> </span><br><span class="line">　　　　<span class="comment">/*</span></span><br><span class="line"><span class="comment">　　　　 * 打开数据库连接两种方式</span></span><br><span class="line"><span class="comment">　　　　 * Connection对象的Open方法中的连接字符串参数必须是_bstr_t类型，形式为:</span></span><br><span class="line"><span class="comment">　　　　 *　　"DSN=datasource_name;Database=database_name;uid=user_name;pwd=password"</span></span><br><span class="line"><span class="comment">　　　　 * 调用Open方法，即通过ODBC Driver连接到Database Server</span></span><br><span class="line"><span class="comment">　　　　 * m_pConnection-&gt;Open("DSN=datasource_name;Database=database_name;uid=user_name;pwd=password",	</span></span><br><span class="line"><span class="comment">　　　　 *　　　　　　　　　　　　"",</span></span><br><span class="line"><span class="comment">　　　　 *　　　　　　　　　　　　"",</span></span><br><span class="line"><span class="comment">　　　　 *　　　　　　　　　　　　adModeUnknown);</span></span><br><span class="line"><span class="comment">　　　　 */</span></span><br><span class="line">　　　　<span class="keyword">this</span>-&gt;m_pConnection-&gt;Open(<span class="string">"DSN=MySQL5.5;Server=localhost;Database=ZD124UE_DEMO"</span>,  #数据库连接字符串</span><br><span class="line">  　　　　　　　　　　　<span class="string">"root"</span>,</span><br><span class="line">  　　　　　　　　　　　<span class="string">"Tarantula7"</span>,</span><br><span class="line">  　　　　　　　　　　　adModeUnknown);</span><br><span class="line">　　&#125; <span class="keyword">catch</span>(_com_error &amp;e)&#123;</span><br><span class="line">　　　　# 不能使用MessageBox函数，在CView CDialog等类之外要用全局函数AfxMessageBox</span><br><span class="line">　　　　AfxMessageBox(e.Description());</span><br><span class="line">　　　　<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">　　&#125;</span><br><span class="line">　　<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>　　<font color="red"><strong>需要注意的是：</font></strong> <strong> 连接字符串的格式为:</strong><br>　　　　<font color="#905a05"><strong>“DSN=datasource_name;Database=database_name;uid=user_name; pwd=password”</font></strong>，<strong>其中各参数的设置需与你的ODBC数据源配置保持一致，如：这里本人的数据源DSN=MySQL5.5，数据库名=ZD124UE_DEMO，用户名=root，密码=Tarantula7</strong>。<br>　　<font color="red"><strong>此外</strong></font>，<strong>CAdoMySQLHelper是一个自定义的数据库辅助类，m_pConnection是其_ConnectionPtr类型的私有成员变量；<code>#</code>后面内容为注释，这里只是为了显示美观才不用<code>//</code>，</strong><font color="red"><strong>后续代码与此部分雷同</strong></font>。</p>
<p>　　类似的，使用<strong>Connection对象</strong>断开数据库连接则相对简单一些。<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment"> * @function 断开数据库连接</span></span><br><span class="line"><span class="comment"> * @param void</span></span><br><span class="line"><span class="comment"> * @retval void</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">void</span> CAdoMySQLHelper::MySQL_Close()&#123;</span><br><span class="line">　　<span class="keyword">if</span>((<span class="literal">NULL</span> != <span class="keyword">this</span>-&gt;m_pConnection) &amp;&amp; (<span class="keyword">this</span>-&gt;m_pConnection-&gt;State))&#123;</span><br><span class="line">　　　　<span class="keyword">this</span>-&gt;m_pConnection-&gt;Close();		# 关闭连接</span><br><span class="line">　　　　<span class="keyword">this</span>-&gt;m_pConnection.Release();		# 释放连接</span><br><span class="line">　　　　<span class="keyword">this</span>-&gt;m_pConnection = <span class="literal">NULL</span>;</span><br><span class="line">　　&#125;</span><br><span class="line">   </span><br><span class="line">　　# 访问完COM库后，需要调用CoUninitialize函数卸载COM库</span><br><span class="line">　　CoUninitialize();		</span><br><span class="line">　　<span class="comment">/*</span></span><br><span class="line"><span class="comment">　　 * 另外一种方式卸载COM库，建议使用第一种</span></span><br><span class="line"><span class="comment">　　 * AfxOleTerm();</span></span><br><span class="line"><span class="comment">　　 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>　　<font color="red"><strong>注意：</font></strong> 使用<strong>Release方法释放智能指针在相应的COM接口的引用计数</strong>，回顾上一段有关<a href="#CoreObj">核心对象实例化</a>的描述，也应该明白此处<strong>必须使用<code>·</code>操作符</strong>。<br>　　<font color="red"><strong>此外</strong></font>，数据库的连接与断开通常处于一系列数据库操作的开始与结尾，故此处<strong>在数据库连接函数开头处初始化COM库，在数据库断开函数结尾处卸载COM库！</strong></p>
<p>　　<font color="#FF2400" size="4"><strong>@-_RecordsetPtr打开数据集，操作数据库</strong></font><br>　　使用<strong> Recordset记录集对象 </strong>几乎可以完成所有数据操作。</p>
<p>　　　<strong>&lt;1. 查询记录</strong><br>　　通过调用<strong> Recordset记录集对象 </strong>的<strong>Open方法</strong>即可打开一个数据集。<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"># 打开数据集SQL语句，table_name为表名</span><br><span class="line"><span class="keyword">_variant_t</span> sql = <span class="string">"SELECT * FROM table_name"</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">　　# 定义_RecordsetPtr智能指针，然后通过它调用Recordset记录集对象的Open方法</span><br><span class="line">　　_RecordsetPtr m_pRecordset;</span><br><span class="line">　　HRESULT hr = m_pRecordset.CreateInstance(__uuidof(Recordset));</span><br><span class="line">　　<span class="keyword">if</span>(FAILED(hr))&#123;</span><br><span class="line">　　　　AfxMessageBox(<span class="string">"创建_RecordsetPtr智能指针失败"</span>);</span><br><span class="line">　　　　<span class="keyword">return</span>;　　　　　　　　　　　　　　　　　　# 中止退出</span><br><span class="line">　　&#125;</span><br><span class="line"> </span><br><span class="line">　　# 打开连接，获取数据集</span><br><span class="line">　　m_pRecordset-&gt;Open( sql,</span><br><span class="line">　　　　　　　　　　　　　<span class="keyword">_variant_t</span>((IDispatch*)(<span class="keyword">this</span>-&gt;m_pConnection), <span class="literal">true</span>),</span><br><span class="line">　　　　　　　　　　　　　adOpenForwardOnly,　　# 游标类型 </span><br><span class="line">　　　　　　　　　　　　　　　　　　　　　　　　　# adOpenStatic(其他用户所做的添加、更改获删除不可见) </span><br><span class="line">　　　　　　　　　　　　　　　　　　　　　　　　　# adOpenDynamic(其他用户所做的添加、更改获删除均可见)</span><br><span class="line">　　　　　　　　　　　　　adLockReadOnly,　　　　# 表示数据库的锁定类型</span><br><span class="line">　　　　　　　　　　　　　　　　　　　　　　　　　# adLockReadOnly(只读记录集) </span><br><span class="line">　　　　　　　　　　　　　　　　　　　　　　　　　# adLockOptimistic(仅在调用m_pRecordset-&gt;Update方法时锁定记录)</span><br><span class="line">　　　　　　　　　　　　　　　　　　　　　　　　　# adLockBatchOptimistic(乐观批更新)</span><br><span class="line">　　　　　　　　　　　　　adCmdText);　　　　　　# 如果Source是SQL语句，则是adCmdText</span><br><span class="line">　　　　　　　　　　　　　　　　　　　　　　　　　# 如果Source是表名，则是adCmdTableDirect</span><br><span class="line"> </span><br><span class="line">　　# 确定表不为空</span><br><span class="line">　　<span class="keyword">if</span>(!m_pRecordset-&gt;ADOEOF)&#123;</span><br><span class="line">　　　　# 移动游标到最前，即ADOBOF</span><br><span class="line">　　　　m_pRecordset-&gt;MoveFirst();</span><br><span class="line">   		</span><br><span class="line">　　　　# 循环遍历数据集，可以获取每行记录每列字段的属性值</span><br><span class="line">　　　　<span class="keyword">while</span>(!m_pRecordset-&gt;ADOEOF)&#123;</span><br><span class="line">　　　　　　# 方式一</span><br><span class="line">　　　　　　<span class="keyword">_variant_t</span> var1 = m_pRecordset-&gt;Fields-&gt;GetItem(<span class="string">"字段名"</span>)-&gt;Value;</span><br><span class="line">　　　　　　# 此处需要进行类型转换</span><br><span class="line">　　　　　　var1.ChangeType(VT_INT);</span><br><span class="line">　　　　　　<span class="keyword">int</span> varInt = var1.intVal;</span><br><span class="line"> </span><br><span class="line">　　　　　　# 方式二</span><br><span class="line">　　　　　　<span class="keyword">_variant_t</span> var2 = m_pRecordset-&gt;Fields-&gt;GetItem(<span class="string">"字段名"</span>)-&gt;GetValue();</span><br><span class="line">　　　　　　# 此处需要进行类型转换</span><br><span class="line">　　　　　　var2.ChangeType(VT_BOOL);</span><br><span class="line">　　　　　　BOOL varBool = (var2.boolVal == VARIANT_FALSE);</span><br><span class="line"> </span><br><span class="line">　　　　　　# 方式三</span><br><span class="line">　　　　　　<span class="keyword">_variant_t</span> var3 = m_pRecordset-&gt;GetCollect(<span class="string">"字段名"</span>);</span><br><span class="line">　　　　　　# 此处需要进行类型转换</span><br><span class="line">　　　　　　CString varString = (LPCSTR)<span class="keyword">_bstr_t</span>(var3);</span><br><span class="line">　　　　　　# 游标向前移动</span><br><span class="line">　　　　　　m_pRecordset-&gt;MoveNext();</span><br><span class="line">　　　　&#125; <span class="comment">// end of while(!m_pRecordset-&gt;ADOEOF)</span></span><br><span class="line">　　　　m_pRecordset-&gt;Close();</span><br><span class="line">　　&#125; <span class="comment">// end of if(!m_pRecordset-&gt;ADOEOF)</span></span><br><span class="line">&#125;<span class="keyword">catch</span>(_com_error &amp;e)&#123;</span><br><span class="line">　　AfxMessageBox(e.ErrorMessage());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>　　<strong>Open</strong>方法<strong>：</strong><br>　　　　第一个参数可以是<strong>SQL语句、表名或一个命令对象；</strong><br>　　　　第二个参数就是前面建立的<strong>连接对象智能指针，编程时参考上述示例代码进行转换以满足参数类型要求；</strong><br>　　　　第三个参数为游标类型<strong>；</strong><br>　　　　第四个参数为数据库的锁定类型<strong>；</strong><br>　　　　第五个参数指定第一个参数<strong>Source</strong>的命令类型<strong>。</strong><br>　　第3-5个参数取值和说明如下表<strong>：</strong><br>    <center><img src="/img/RFID/03-02.png" width="720px"/></center><br>　　<font color="red"><strong>建议：</font></strong><br>　　　　游标类型采用默认的<strong>adOpenForwardOnly</strong>即可。<br>　　　　数据库的锁定类型如果只是查询记录，使用<strong>adLockReadOnly </strong>只读即可<strong>；</strong>如果涉及记录的修改，添加和删除的，则使用<strong>adLockOptimistic。</strong><br>　　　　至于命令类型，如果第一个参数是<strong>SQL语句</strong>，采用<strong>adCmdText</strong>，如果是表名，则是<strong>adCmdTableDirect</strong>。</p>
<p>　　另外，<strong>Fields </strong>是<strong> Recordset对象 </strong>的容器，<strong>GetItem</strong>方法返回的是<strong>Field对象</strong>，而<strong>Value </strong>则是<strong>Field对象 </strong>的一个属性，即该字段的值(即方式一)，也可以利用属性的<strong>Get</strong>方法获得属性(即方式二)。</p>
<p>　　判断是否达到记录集的末尾，使用记录集的<strong>EOF属性</strong>，其值为真则到了结尾；判断是否到达记录集的开头，则可用<strong>BOF属性(注意二者的重命名问题)</strong>。<br>　　上述过程中的类型转换将在后续的<a href="#TypeTransfer">《数据使用与类型转换》</a>部分详细说明。</p>
<p>　　　<strong>&lt;2. 修改记录</strong><br>　　在上述<strong>查询记录</strong>中，改变了<strong>Value属性</strong>的值，即改变了字段的值，同样地，也有三种方式。<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"># table_name为表名</span><br><span class="line"><span class="keyword">_variant_t</span> table_name = <span class="string">"table_name"</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">　　# 定义_RecordsetPtr智能指针，然后通过它调用Recordset记录集对象的Open方法</span><br><span class="line">　　_RecordsetPtr m_pRecordset;</span><br><span class="line">　　HRESULT hr = m_pRecordset.CreateInstance(__uuidof(Recordset));</span><br><span class="line">　　<span class="keyword">if</span>(FAILED(hr))&#123;</span><br><span class="line">　　　　AfxMessageBox(<span class="string">"创建_RecordsetPtr智能指针失败"</span>);</span><br><span class="line">　　　　<span class="keyword">return</span>;　　　　　　　　　　　　　　　　　　# 中止退出</span><br><span class="line">　　&#125;</span><br><span class="line"> </span><br><span class="line">　　# 打开连接，获取数据集</span><br><span class="line">　　m_pRecordset-&gt;Open( table_name,</span><br><span class="line">　　　　　　　　　　　　　<span class="keyword">_variant_t</span>((IDispatch*)(<span class="keyword">this</span>-&gt;m_pConnection), <span class="literal">true</span>),</span><br><span class="line">　　　　　　　　　　　　　adOpenForwardOnly,　　　# 游标类型</span><br><span class="line">　　　　　　　　　　　　　adLockOptimistic,　　　　# 仅在下方调用m_pRecordset-&gt;Update方法时锁定记录</span><br><span class="line">　　　　　　　　　　　　　adCmdTableDirect);　　　# Source是表名，则是adCmdTableDirect</span><br><span class="line"> </span><br><span class="line">　　# 确定表不为空</span><br><span class="line">　　<span class="keyword">if</span>(!m_pRecordset-&gt;ADOEOF)&#123;</span><br><span class="line">　　　　# 移动游标到最前，即ADOBOF</span><br><span class="line">　　　　m_pRecordset-&gt;MoveFirst();</span><br><span class="line"> 			</span><br><span class="line">　　　　# 循环遍历数据集，获取每行记录每列字段的属性值</span><br><span class="line">　　　　<span class="keyword">while</span>(!m_pRecordset-&gt;ADOEOF)&#123;</span><br><span class="line">　　　　　　# 寻找满足某个条件的记录</span><br><span class="line">　　　　　　<span class="keyword">if</span>(属性值 == (m_pRecordset-&gt;Fields-&gt;GetItem(<span class="string">"字段名"</span>)-&gt;Value))&#123;</span><br><span class="line">　　　　　　　　# 方式一</span><br><span class="line">　　　　　　　　<span class="keyword">_variant_t</span> var1;</span><br><span class="line">　　　　　　　　var1.ChangeType(VT_INT);</span><br><span class="line">　　　　　　　　var1.intVal = <span class="number">123</span>;</span><br><span class="line">　　　　　　　　m_pRecordset-&gt;Fields-&gt;GetItem(<span class="string">"字段名"</span>)-&gt;Value = var1;</span><br><span class="line"> </span><br><span class="line">　　　　　　　　# 方式二</span><br><span class="line">　　　　　　　　<span class="keyword">_variant_t</span> var2;</span><br><span class="line">　　　　　　　　var2.ChangeType(VT_BOOL);</span><br><span class="line">　　　　　　　　var2.boolVal == VARIANT_TRUE;</span><br><span class="line">　　　　　　　　m_pRecordset-&gt;Fields-&gt;GetItem(<span class="string">"字段名"</span>)-&gt;PutValue(var2);</span><br><span class="line"> </span><br><span class="line">　　　　　　　　# 方式三</span><br><span class="line">　　　　　　　　<span class="keyword">_variant_t</span> var3 = <span class="string">"xxx"</span>;</span><br><span class="line">　　　　　　　　m_pRecordset-&gt;PutCollect(<span class="string">"字段名"</span>, var3);</span><br><span class="line"> </span><br><span class="line">　　　　　　　　# 必须在移动游标前执行更新!!</span><br><span class="line">　　　　　　　　m_pRecordset-&gt;Update();</span><br><span class="line"> </span><br><span class="line">　　　　　　　　<span class="keyword">break</span>;</span><br><span class="line">　　　　　　&#125;</span><br><span class="line">　　　　　　# 游标向前移动</span><br><span class="line">　　　　　　m_pRecordset-&gt;MoveNext();</span><br><span class="line"> </span><br><span class="line">　　　　&#125; <span class="comment">// end of while(!m_pRecordset-&gt;ADOEOF)</span></span><br><span class="line">　　　　m_pRecordset-&gt;Close();</span><br><span class="line"> </span><br><span class="line">　　&#125; <span class="comment">// end of if(!m_pRecordset-&gt;ADOEOF)</span></span><br><span class="line">&#125;<span class="keyword">catch</span>(_com_error &amp;e)&#123;</span><br><span class="line">　　AfxMessageBox(e.ErrorMessage());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>　　<font color="red"><strong>注意：</font></strong> 此处涉及对数据库的修改，故第四个参数<strong>数据库锁定类型</strong>需采用<strong>adLockOptimistic</strong>，这样，数据集仅在执行<strong>第49行代码Update方法</strong> 时锁定<strong>；</strong>又第一个参数<strong>Source</strong>是表名，相应的最后一个参数应使用<strong>adCmdTableDirect</strong>。采用三种方式中的任何一种改变字段的值之后，必须在<strong>移动游标或者关闭数据库前</strong>调用<strong>Update 方法 </strong>更新数据集到数据库。</p>
<p>　　　<strong>&lt;3. 添加记录</strong><br>　　利用<strong> Recordset对象 </strong>也能实现增、删操作，不过建议使用<strong>Command对象</strong>完成这两类操作，达到简化的目的。<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"># table_name为表名</span><br><span class="line"><span class="keyword">_variant_t</span> table_name = <span class="string">"table_name"</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">　　# 定义_RecordsetPtr智能指针，通过它调用Recordset记录集对象的Open方法</span><br><span class="line">　　_RecordsetPtr m_pRecordset;</span><br><span class="line">　　HRESULT hr = m_pRecordset.CreateInstance(__uuidof(Recordset));</span><br><span class="line">　　<span class="keyword">if</span>(FAILED(hr))&#123;</span><br><span class="line">　　　　AfxMessageBox(<span class="string">"创建_RecordsetPtr智能指针失败"</span>);</span><br><span class="line">　　　　<span class="keyword">return</span>;　　　　　　　　　　　　　　　　　　# 中止退出</span><br><span class="line">　　&#125;</span><br><span class="line"> </span><br><span class="line">　　# 打开连接，获取数据集</span><br><span class="line">　　m_pRecordset-&gt;Open( table_name,</span><br><span class="line">　　　　　　　　　　　　　<span class="keyword">_variant_t</span>((IDispatch*)(<span class="keyword">this</span>-&gt;m_pConnection), <span class="literal">true</span>),</span><br><span class="line">　　　　　　　　　　　　　adOpenForwardOnly,　　　 # 游标类型</span><br><span class="line">　　　　　　　　　　　　　adLockOptimistic,　　　　 # 仅在调用m_pRecordset-&gt;Update方法时锁定记录</span><br><span class="line">　　　　　　　　　　　　　adCmdTableDirect);　　　 # Source是表名，则是adCmdTableDirect</span><br><span class="line">　　<span class="keyword">if</span>(!m_pRecordset-&gt;Supports(adAddNew))&#123;</span><br><span class="line">　　　　<span class="keyword">return</span>;　　# 不允许添加记录，中止退出</span><br><span class="line">　　&#125;</span><br><span class="line">　　# 新纪录添加成功后，即自动成为当前记录</span><br><span class="line">　　m_pRecordset-&gt;AddNew();</span><br><span class="line"> </span><br><span class="line">　　# 使用三种方式中的任意一种为新添加的记录各个字段赋值</span><br><span class="line">　　# ...</span><br><span class="line"> </span><br><span class="line">　　# 关闭数据库前执行更新</span><br><span class="line">　　m_pRecordset-&gt;Update();</span><br><span class="line">　　m_pRecordset-&gt;Close();</span><br><span class="line">&#125;<span class="keyword">catch</span>(_com_error &amp;e)&#123;</span><br><span class="line">　　AfxMessageBox(e.ErrorMessage());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>　　　<strong>&lt;4. 删除记录</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"># 打开数据集SQL语句，table_name为表名字符串，cond为类似<span class="string">"字段=属性值"</span>的条件字符串</span><br><span class="line"><span class="keyword">_variant_t</span> sql = <span class="string">"SELECT * FROM "</span> + table_name + <span class="string">" where "</span> + cond;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">　　# 定义_RecordsetPtr智能指针，通过它调用Recordset记录集对象的Open方法</span><br><span class="line">　　_RecordsetPtr m_pRecordset;</span><br><span class="line">　　HRESULT hr = m_pRecordset.CreateInstance(__uuidof(Recordset));</span><br><span class="line">　　<span class="keyword">if</span>(FAILED(hr))&#123;</span><br><span class="line">　　　　AfxMessageBox(<span class="string">"创建_RecordsetPtr智能指针失败"</span>);</span><br><span class="line">　　　　<span class="keyword">return</span>;　　　　　　　　　　　　　　　　　　# 中止退出</span><br><span class="line">　　&#125;</span><br><span class="line"> </span><br><span class="line">　　# 打开连接，获取数据集</span><br><span class="line">　　m_pRecordset-&gt;Open( sql,</span><br><span class="line">　　　　　　　　　　　　　<span class="keyword">_variant_t</span>((IDispatch*)(<span class="keyword">this</span>-&gt;m_pConnection), <span class="literal">true</span>),</span><br><span class="line">　　　　　　　　　　　　　adOpenForwardOnly,　　　</span><br><span class="line">　　　　　　　　　　　　　adLockOptimistic,</span><br><span class="line">　　　　　　　　　　　　　adCmdText);</span><br><span class="line"> </span><br><span class="line">　　# 确定表不为空</span><br><span class="line">　　<span class="keyword">if</span>(!m_pRecordset-&gt;ADOEOF)&#123;</span><br><span class="line">　　　　# 移动游标到最前，即ADOBOF</span><br><span class="line">　　　　m_pRecordset-&gt;MoveFirst();</span><br><span class="line">   		</span><br><span class="line">　　　　# 循环遍历数据集，删除所有满足条件的记录</span><br><span class="line">　　　　<span class="keyword">while</span>(!m_pRecordset-&gt;ADOEOF)&#123;</span><br><span class="line">　　　　　　# 删除的是当前游标所在记录</span><br><span class="line">　　　　　　m_pRecordset-&gt;Delete(adAffectCurrent);</span><br><span class="line">　　　 </span><br><span class="line">　　　　　　# 必须在移动游标前执行更新!!</span><br><span class="line">　　　　　　m_pRecordset-&gt;Update();</span><br><span class="line">　　　　　　m_pRecordset-&gt;MoveNext();</span><br><span class="line">　　　　&#125; <span class="comment">// end of while(!m_pRecordset-&gt;ADOEOF)</span></span><br><span class="line">　　　　m_pRecordset-&gt;Close();</span><br><span class="line"> </span><br><span class="line">　　&#125; <span class="comment">// end of if(!m_pRecordset-&gt;ADOEOF)</span></span><br><span class="line">&#125;<span class="keyword">catch</span>(_com_error &amp;e)&#123;</span><br><span class="line">　　AfxMessageBox(e.ErrorMessage());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>　　<font color="red"><strong>注意：</font></strong> <strong>cond条件字符串 </strong>查询条件为<strong>文本格式 </strong>时要求用引号，如<strong>varchar、char、time、datetime类型</strong>等(单引号、双引号一般都有效)；反之数值格式不要加引号，如bit、double、float、int类型等(不过加了引号也不会报错，会自动转换类型，但是最好不要加引号)。 <strong>SQL语句 </strong>拼接时注意拼接字符串间是否需要添加空格，防止拼接字符串中的两个关键字因连接在一次而出错。</p>
<p>　　<font color="#FF2400" size="4"><strong>@-_CommandPtr执行SQL语句</strong></font><br>　　使用<strong> Command对象 </strong>的关键就是把表示命令的<strong>MySQL语句</strong>设置到<strong>CommandText属性</strong> 中，然后再调用<strong> Command对象 </strong>的<strong>Execute方法</strong> 执行。一般情况下在命令中无需使用参数，但有时使用参数，可以增加其灵活性和效率。<strong>SQL语句</strong> 中的问号<code>?</code>就代表参数，如果有多个参数，就多放几个问号<code>?</code>，每个问号<code>?</code>代表一个参数。<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment"> * @function 对数据库进行删除操作</span></span><br><span class="line"><span class="comment"> * @param </span></span><br><span class="line"><span class="comment"> *   @CString uid唯一标识删除记录</span></span><br><span class="line"><span class="comment"> *   @Cstring table指定删除记录所在表名</span></span><br><span class="line"><span class="comment"> * @retval BOOL</span></span><br><span class="line"><span class="comment"> *   成功删除返回true，失败则返回false</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">BOOL CAdoMySQLHelper::MySQL_Delete(CString uid, CString table)&#123;</span><br><span class="line">　　_CommandPtr m_pCommand;</span><br><span class="line">　　<span class="keyword">try</span>&#123;</span><br><span class="line">　　　　HRESULT hr = m_pCommand.CreateInstance(<span class="string">"ADODB.Command"</span>);</span><br><span class="line">　　　　<span class="keyword">if</span>(FAILED(hr))&#123;</span><br><span class="line">　　　　　　AfxMessageBox(<span class="string">"创建_CommandPtr智能指针失败"</span>);</span><br><span class="line">　　　　　　<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">　　　　&#125;</span><br><span class="line">　　　　# 定义为无参数</span><br><span class="line">　　　　<span class="keyword">_variant_t</span> vNULL;</span><br><span class="line">　　　　vNULL.vt = VT_ERROR;</span><br><span class="line">　　　　vNULL.scode = DISP_E_PARAMNOTFOUND;	</span><br><span class="line">　　　　# 注意文本格式数据需要使用引号，\'此处使用转义符；拼接字符串间合理使用空格！</span><br><span class="line">　　　　m_pCommand-&gt;CommandText = <span class="string">"delete from "</span> + (<span class="keyword">_bstr_t</span>)table + <span class="string">" where UID=\'"</span> + (<span class="keyword">_bstr_t</span>)uid +<span class="string">"\'"</span>;</span><br><span class="line">　　　　 </span><br><span class="line">　　　　# 非常关键的一句，将建立的连接与命令对象绑定							</span><br><span class="line">　　　　m_pCommand-&gt;ActiveConnection = <span class="keyword">this</span>-&gt;m_pConnection;</span><br><span class="line">   </span><br><span class="line">　　　　# 执行删除命令</span><br><span class="line">　　　　m_pCommand-&gt;Execute(&amp;vNULL, &amp;vNULL, adCmdText);		</span><br><span class="line">　　&#125; <span class="keyword">catch</span>(_com_error &amp;e) &#123;	</span><br><span class="line">　　　　AfxMessageBox(e.ErrorMessage());</span><br><span class="line">　　　　<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">　　&#125;</span><br><span class="line">　　<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>　　当命令对象的<strong>SQL语句</strong> 带有参数时，可以通过以下方式为其添加参数数据<strong>：</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">_ParameterPtr Param;</span><br><span class="line"># adInteger为DataTypeEnum，表示数据类型；adParamInput则表示参数方向</span><br><span class="line">Param = m_pCommand-&gt;CreateParameter(<span class="keyword">_bstr_t</span>(<span class="string">"参数名"</span>), adInteger, adParamInput, <span class="number">-1</span>);</span><br><span class="line">Param-&gt;Value = <span class="keyword">_variant_t</span>(<span class="string">"参数值"</span>);</span><br><span class="line">m_pCommand-&gt;Parameters-&gt;Append(Param);</span><br></pre></td></tr></table></figure></p>
<p>　　第4个参数为长度，如果是固定长度的数据类型该参数为<strong>-1</strong>；如果是字符串等可变长度类型，该参数的值为实际长度。<strong>Parameters</strong>是<strong> Command对象 </strong>的一个容器，<strong>Append</strong>进去的参数按先后顺序与<strong>SQL语句</strong>中的<code>?</code>从左到右一一对应。</p>
<p>　　<font color="red"><strong>注意：</font></strong> 用<strong> Command 和 Connection对象 </strong>也能得到一个记录集，不过这种方式得到的<strong>Recordset </strong>是只读的，因为在打开<strong>Recordset </strong>之前，我们无法设置它的<strong> LockType(故使用默认值adLockReadOnly)</strong>，而在打开之后设置的<strong>LockType </strong>将不起作用。故一般我们通过<strong> Command对象 </strong>来执行<strong>Insert、Delete、Update三类SQL语句</strong>，并不需要操作数据集；<strong> Command对象 </strong>代码简洁( 你可以比较上述两种实现)，能够达到简化数据库操作的目的。</p>
<p>　　<font color="#FF2400" size="4"><span id="TypeTransfer"><strong>@-数据使用与类型转换</strong></span></font><br>　　计算机语言多种多样，各自又都有自己的数据类型，<strong>COM</strong> 产生目的，其中之一就是跨语言。<strong>_variant_t </strong>数据类型就具有跨语言的特性，同时它可以表示(存储)任意类型的数据。从C语言的角度来讲，<strong>_variant_t </strong>其实是一个结构，结构中用一个域(vt)表示该变量到底表示的是什么类型数据，同时真正的数据则存贮在<strong>union</strong>空间中。常见的<strong>COM类型 </strong>类型转换使用如下<strong>：</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">_variant_t</span> var;</span><br><span class="line"> </span><br><span class="line"># 对<span class="keyword">_variant_t</span>变量赋值</span><br><span class="line">var.ChangeType(VT_BOOL/VT_INT/VT_BSTR...);</span><br><span class="line">var.intVal/boolVal/bstrVal... = xxx;</span><br><span class="line"> </span><br><span class="line"># 从<span class="keyword">_variant_t</span>变量取值</span><br><span class="line"><span class="keyword">if</span>(var.vt != VT_NULL)&#123;</span><br><span class="line">　　var.ChangeType(VT_BOOL/VT_INT/VT_BSTR...);</span><br><span class="line">　　<span class="keyword">int</span>/<span class="keyword">bool</span>/CString... xxx = var.intVal/boolVal/bstrVal...;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"># 对于字符串，建议通过以下方式进行赋值和取值操作</span><br><span class="line">var = <span class="string">"..."</span>;</span><br><span class="line">xxx = (LPCSTR)<span class="keyword">_bstr_t</span>(var);</span><br></pre></td></tr></table></figure></p>
<p>　　其中需要留意的是<strong>VT_BOOL</strong>类型与更为常见的<strong>bool </strong>类型的区别<strong>：</strong><br>    <center><img src="/img/RFID/03-03.png" width="640px"/></center><br>　　注意到<strong>VARIANT_TRUE </strong>的值并不是<strong>1</strong>，而是<strong>-1！ </strong>另外，<strong>任何布尔类型的”假”都是0</strong>，因此作为一个好习惯，在做布尔判断的时候，<strong>不要和”真值”相比较，而要与”假值”做比较</strong>。<br>　　<br>　　<font color="#FF2400" size="4"><strong>@-关闭与释放</strong></font><br>　　用完三大核心对象之后，需要关闭并释放之，方法还是通过<strong>智能指针</strong>来实现，这一点在上述的实例代码中并没有很好的实现，是一个值得考虑和改进的地方(参见下一段<strong>错误捕获</strong>的示例代码)<strong>：</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">m_Recordset-&gt;Close();</span><br><span class="line">m_pConnection-&gt;Close();</span><br><span class="line"># 注意Command对象没有Close方法</span><br><span class="line">m_Recordset.Release();</span><br><span class="line">m_pCommand.Release();</span><br><span class="line">m_pConnection.Release();</span><br></pre></td></tr></table></figure></p>
<p>　　<font color="#FF2400" size="4"><strong>@-错误捕获</strong></font><br>　　数据库操作难免出现错误(<strong>连接串错误，SQL语句错误等</strong>)。对所有调用<strong>ADO COM库</strong>的语句一定要用<strong> try-catch </strong>语句捕捉异常，否则发生异常时，程序会异常退出。<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">　　<span class="comment">/*</span></span><br><span class="line"><span class="comment">　　 * 调用ADO API的所有语句</span></span><br><span class="line"><span class="comment">　　 */</span></span><br><span class="line">&#125; <span class="keyword">catch</span>(_com_error &amp;e)&#123;</span><br><span class="line">　　# 若连接打开，需要在异常处理中关闭和释放连接</span><br><span class="line">　　<span class="keyword">if</span>((<span class="literal">NULL</span> != <span class="keyword">this</span>-&gt;m_pConnection) &amp;&amp; <span class="keyword">this</span>-&gt;m_pConnection-&gt;State)&#123;</span><br><span class="line">　　	　<span class="keyword">this</span>-&gt;m_pConnection-&gt;Close();</span><br><span class="line">　　	　<span class="keyword">this</span>-&gt;m_pConnection.Release();</span><br><span class="line">　　	　<span class="keyword">this</span>-&gt;m_pConnection = <span class="literal">NULL</span>;			</span><br><span class="line">　　&#125;</span><br><span class="line"></span><br><span class="line">　　# 若记录集打开，需要在异常处理中关闭和释放记录集</span><br><span class="line">　　<span class="keyword">if</span>((<span class="literal">NULL</span> != m_pRecordset) &amp;&amp; m_pRecordset-&gt;State)&#123;</span><br><span class="line">　　	　m_pRecordset-&gt;Close();</span><br><span class="line">　　	　m_pRecordset.Release();</span><br><span class="line">　　	　m_pRecordset = <span class="literal">NULL</span>;			</span><br><span class="line">　　&#125;</span><br><span class="line"></span><br><span class="line">　　# 需要在异常处理中释放命令对象</span><br><span class="line">　　<span class="keyword">if</span>((<span class="literal">NULL</span> != m_pCommand) &amp;&amp; m_pCommand-&gt;State)&#123;</span><br><span class="line">　　	　m_pCommand.Release();</span><br><span class="line">　　	　m_pCommand = <span class="literal">NULL</span>;			</span><br><span class="line">　　&#125;</span><br><span class="line"></span><br><span class="line">　　# 不能使用MessageBox函数，在CView、CDialog等之外要用全局函数AfxMessageBox</span><br><span class="line">　　AfxMessageBox(e.Description());	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>　　<font color="red"><strong>注意： </strong></font> <strong>“&amp;”</strong>只是一个引用，写不写无所谓，切忌写成<strong> “_com_error *e” </strong>，因为这时异常是<strong> _com_error </strong>类型却对着<strong> _com_error* </strong>来捕获，当然捕获不到<strong>!! </strong>可能还是会导致程序异常退出。<br>　　另外，<strong>catch块 </strong>中只需释放<strong>try </strong>块中操纵的对象即可，上述代码只是为了演示所有例子。　<br>　　<br>　　<font color="#FF2400" size="4"><strong>@-封装自己的数据库辅助类</strong></font><br>　　习惯上，我们会将对数据库的一系列重复的操作封装起来，构建一个<strong>数据库辅助类</strong>，提供<strong>数据库连接、断开、以及基本的增、删、改、查操作</strong>。 这样，在应用开发过程中，我们就可以直接通过<strong> 数据库辅助类 </strong>完成需要实现的功能，大大简化代码，也使应用开发更有目的，更有层次；提高效率，方便维护。<br>　　<font color="#625A05"><strong>VC++类视图选中”工程名 classes”右键<font size="5">→</font> New Class<font size="5">→</font> Class Type选择Generic Class，输入数据库辅助类类名， </strong></font>即可自动生成辅助类代码框架。<strong>DEMO</strong>中的数据库辅助类定义如下<strong>：</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"># RemainTimeTable余时表记录结构</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">RemainTime</span>&#123;</span></span><br><span class="line">　　CString UID;</span><br><span class="line">　　<span class="keyword">int</span> RemainSeconds;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"># OnTable上机表记录结构</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">OnRecord</span>&#123;</span></span><br><span class="line">　　CString UID;</span><br><span class="line">　　<span class="keyword">int</span> RemainSeconds;</span><br><span class="line">　　CString StartTime;</span><br><span class="line">　　BOOL isOvertime;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CAdoMySQLHelper</span>  </span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">　　# 构造函数&amp;析构函数</span><br><span class="line">　　CAdoMySQLHelper();</span><br><span class="line">　　<span class="meta"># virtual是因为当用基类操作派生类(派生类引用赋值给基类指针)，在析构时防止只析构基类而不析构派生类的情况	</span></span><br><span class="line">　　<span class="keyword">virtual</span> ~CAdoMySQLHelper();	</span><br><span class="line"> </span><br><span class="line">　　# 连接数据库</span><br><span class="line">　　<span class="function">BOOL <span class="title">MySQL_Connect</span><span class="params">()</span></span>;</span><br><span class="line">　　# 关闭数据库</span><br><span class="line">　　<span class="function"><span class="keyword">void</span> <span class="title">MySQL_Close</span><span class="params">()</span></span>;</span><br><span class="line"> </span><br><span class="line">　　# 数据库增、删、改、查操作函数</span><br><span class="line">　　# 对数据库进行插入操作</span><br><span class="line">　　<span class="function">BOOL <span class="title">MySQL_Insert</span><span class="params">(struct RemainTime record)</span></span>;</span><br><span class="line">　　<span class="function">BOOL <span class="title">MySQL_Insert</span><span class="params">(struct OnRecord record)</span></span>;</span><br><span class="line">　　# 对数据库进行删除操作</span><br><span class="line">　　<span class="function">BOOL <span class="title">MySQL_Delete</span><span class="params">(CString uid, CString table)</span></span>;</span><br><span class="line">　　# 对数据库进行更新操作</span><br><span class="line">　　<span class="function">BOOL <span class="title">MySQL_UpdateRemainTime</span><span class="params">(CString uid, <span class="keyword">int</span> updateTime)</span></span>;</span><br><span class="line">　　# 对数据库进行查询操作，查询语句为cond，例如: <span class="string">"UID = xxxx"</span></span><br><span class="line">　　<span class="function"><span class="keyword">void</span>* <span class="title">MySQL_Query</span><span class="params">(CString cond, CString table)</span></span>;</span><br><span class="line">　　# 定时扫描OnTable，使用扫描周期timer更新当前上机用户余时，捕捉超时用户</span><br><span class="line">　　<span class="function"><span class="keyword">void</span> <span class="title">MySQL_ScanOnTable</span><span class="params">(<span class="keyword">int</span> timer)</span></span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">　　# 保存打开的数据库连接智能指针</span><br><span class="line">　　_ConnectionPtr m_pConnection;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>　　<font color="red"><strong>说明： </strong></font><br>　　　除了数据库的连接和断开属于典型、通用的功能外，其他关于数据库的<strong> 增、删、改、查 </strong>操作建议在需要时才添加，同时根据自己项目的实际需求对接口进行调整(调整参数、调整返回值等)，必要时也需要添加新的特定功能的接口函数。<br>　　　另外，强烈建议采用<strong> static </strong>将各部分接口调整为类方法，这样使用辅助类将更加方便，直接通过<strong>辅助类调用接口</strong> 即可；也更高效，<strong>不需要对辅助类进行实例化</strong> 即可使用接口！</p>
<h2 id="最后，小结"><a href="#最后，小结" class="headerlink" title="最后，小结"></a><strong>最后，小结</strong></h2><p>　　<font color="blue">本文通过对当前常用的几种<strong>数据库访问技术</strong>的介绍，引出项目中使用数据库的<strong>开发原理</strong>，进而推出项目数据库的<strong>开发流程</strong>。详细地介绍了如何通过<strong>ADO编程</strong>，实现操纵<strong>MySQL数据库</strong>。出于<strong>ADO编程</strong>采用其<strong>COM库</strong>的<strong>API</strong>这种方式，故跟大家简短叙说了<strong>COM规范 </strong>的由来，主要是领会其中蕴含的编程思想。相信到这里，你对如何<strong>使用ADO操纵MySQL数据库</strong> 肯定有了比较深刻的认识。思路清晰了，那就开始Coding吧！！！</font></p>
<h2 id="附录-常用的SQL语句整理"><a href="#附录-常用的SQL语句整理" class="headerlink" title="附录 - - 常用的SQL语句整理"></a><font color="#625A05" size="3"><strong>附录 - - 常用的SQL语句整理</strong></font></h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"># 修改数据库密码</span><br><span class="line"><span class="keyword">use</span> mysql;</span><br><span class="line"><span class="keyword">update</span> <span class="keyword">user</span> <span class="keyword">set</span> <span class="keyword">password</span>=<span class="keyword">password</span>(<span class="string">'新密码'</span>) <span class="keyword">where</span> <span class="keyword">user</span>=<span class="string">'root'</span>;</span><br><span class="line"><span class="keyword">flush</span> <span class="keyword">privileges</span>;</span><br><span class="line"> </span><br><span class="line"># 查看数据库是32位还是64位</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">variables</span> <span class="keyword">like</span> <span class="string">"%version_%"</span>;</span><br><span class="line"># 查询结果中的version_compile_os即为数据库位数，Win32和Win64分别对应32位和64位</span><br><span class="line"> </span><br><span class="line"># 创建数据库</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">database</span> <span class="keyword">if</span> <span class="keyword">exists</span> database_name;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">database</span> database_name;</span><br><span class="line"> </span><br><span class="line"># 查看所有数据库名</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">databases</span>;</span><br><span class="line"> </span><br><span class="line"># 表操作前需要使用某个数据库 注意database_name大小写不敏感</span><br><span class="line"><span class="keyword">use</span> database_name;</span><br><span class="line"> </span><br><span class="line"># 创建表</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> <span class="keyword">if</span> <span class="keyword">exists</span> table_name;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> table_name(</span><br><span class="line">　　字段<span class="number">1</span>名字 字段<span class="number">1</span>类型 字段<span class="number">1</span>属性,</span><br><span class="line">　　字段<span class="number">2</span>名字 字段<span class="number">2</span>类型 字段<span class="number">2</span>属性,</span><br><span class="line">　　...</span><br><span class="line">);</span><br><span class="line"> </span><br><span class="line"># 查看所有表名</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">tables</span>;</span><br><span class="line"> </span><br><span class="line"># 查看表的结构时使用，注意table_name大小写不敏感</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">table</span> table_name;</span><br><span class="line"> </span><br><span class="line"># 调整表某个字段的数据类型</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> table_name <span class="keyword">modify</span> <span class="keyword">column</span> 字段 新的数据类型;</span><br><span class="line"> </span><br><span class="line"># 删除表</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> <span class="keyword">if</span> <span class="keyword">exists</span> table_name;</span><br><span class="line"> </span><br><span class="line"># 删除数据库 </span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">database</span> <span class="keyword">if</span> <span class="keyword">exists</span> database_name;</span><br><span class="line"> </span><br><span class="line"># 查询记录(where不写则查询所有记录)</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> table_name [<span class="keyword">where</span> condition];</span><br><span class="line"> </span><br><span class="line"># 添加记录</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> table_name(字段<span class="number">1</span>, 字段<span class="number">2.</span>..) <span class="keyword">values</span>(字段<span class="number">1</span>值, 字段<span class="number">2</span>值...);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> table_name <span class="keyword">values</span>(字段<span class="number">1</span>值, 字段<span class="number">2</span>值, 字段<span class="number">3</span>值, ..., 最后一个字段值);</span><br><span class="line"> </span><br><span class="line"># 更新记录(where不写则更新所有记录)</span><br><span class="line"><span class="keyword">update</span> table_name <span class="keyword">set</span> 字段=字段值 [<span class="keyword">where</span> condition];</span><br><span class="line"> </span><br><span class="line"># 删除记录(where不写则删除所有记录)</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> table_name [<span class="keyword">where</span> condition];</span><br><span class="line">  </span><br><span class="line"># 其他的自行度娘"MySQL下如何xxxx"</span><br></pre></td></tr></table></figure>
<h2 id="Version-Control"><a href="#Version-Control" class="headerlink" title="Version Control"></a><strong>Version Control</strong></h2><table border="3" cellpadding="4px" style="font-family: verdana,arial,sans-serif; font-size:18px; color:#333333; background-color:#c3dde0; margin: 0; border-color: #333333; border-collapse:collapse"><br><tr><td style="width: 60px; text-align: center">版本号</td><td style="width: 80px; text-align: center">日期</td><td style="width: 320px; text-align: center">内容</td><td style="width: 100px; text-align: center">作者</td></tr><tr text-align="center"><td style="text-align: center">V0.1</td><td style="text-align: center">2015.11.29</td><td style="text-align: center">起草博客</td><td style="text-align: center">Tarantula-7</td></tr></table>

      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>本文标题:</span><a href="/2015/11/29/TACouses_iotCourse_03_ADO连接MySQL数据库/">ADO连接MySQL数据库</a></p>

        <!-- 
        <p><span>文章作者:</span><a href="/" title="回到主页">Gary Chan</a></p>
        -->
        <p><span>文章作者:</span>csj</p>

        <p><span>发布时间:</span>2015-11-29, 09:50:30</p>
        <p><span>最后更新:</span>2020-03-28, 12:37:22</p>
        <p>
            <span>原始链接:</span><a class="post-url" href="/2015/11/29/TACouses_iotCourse_03_ADO连接MySQL数据库/" title="ADO连接MySQL数据库">http://durant35.github.io/2015/11/29/TACouses_iotCourse_03_ADO连接MySQL数据库/</a>
            <span class="copy-path" data-clipboard-text="原文: http://durant35.github.io/2015/11/29/TACouses_iotCourse_03_ADO连接MySQL数据库/　　作者: Gary Chan" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>

        <!-- not to show license information
        <p>
            <span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="CC BY-NC-SA 4.0 International" target = "_blank">"署名-非商用-相同方式共享 4.0"</a> 转载请保留原文链接及作者。
        </p>
        -->
    </div>



    <nav id="article-nav">
        
            <div id="article-nav-newer" class="article-nav-title">
                <a href="/2016/01/22/hexo_push你的新博客到Github/">
                    hexo，push你的新博客到Github
                </a>
            </div>
        
        
            <div id="article-nav-older" class="article-nav-title">
                <a href="/2015/10/16/TACouses_iotCourse_02 Windows下的静态库和动态库/">
                    Windows下的静态库和动态库
                </a>
            </div>
        
    </nav>

  
</article>

    <div id="toc" class="toc-article">
        <strong class="toc-title">文章目录</strong>
        
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#第一节-数据库访问技术"><span class="toc-number">1.</span> <span class="toc-text">第一节 数据库访问技术</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第二节-COM-Componet-Object-Model"><span class="toc-number">2.</span> <span class="toc-text">第二节 COM(Componet Object Model)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第三节-配置ODBC数据源"><span class="toc-number">3.</span> <span class="toc-text">第三节 配置ODBC数据源</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第四节-ADO编程"><span class="toc-number">4.</span> <span class="toc-text">第四节 ADO编程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#最后，小结"><span class="toc-number">5.</span> <span class="toc-text">最后，小结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#附录-常用的SQL语句整理"><span class="toc-number">6.</span> <span class="toc-text">附录 - - 常用的SQL语句整理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Version-Control"><span class="toc-number">7.</span> <span class="toc-text">Version Control</span></a></li></ol>
        
    </div>
    <style>
        .left-col .switch-btn,
        .left-col .switch-area {
            display: none;
        }
        .toc-level-4 i,
        .toc-level-4 ol {
            display: none !important;
        }
    </style>

    <input type="button" id="tocButton" value="隐藏目录"  title="点击按钮隐藏或者显示文章目录">

    <script>
        yiliaConfig.toc = ["隐藏目录", "显示目录", !!"true"];
    </script>



    
<div class="share">
    
        <div class="bdsharebuttonbox">
        <!--
            <a href="#" class="fa fa-twitter bds_twi" data-cmd="twi" title="分享到推特"></a>
        -->
            <a href="#" class="fa fa-weibo bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
            <a href="#" class="fa fa-qq bds_sqq" data-cmd="sqq" title="分享给 QQ 好友"></a>
            <a href="#" class="fa fa-weixin bds_weixin" data-cmd="weixin" title="生成文章二维码"></a>
            <a href="#" class="fa fa-files-o bds_copy" data-cmd="copy" title="复制网址"></a>
        <!--
            <a href="#" class="fa fa fa-envelope-o bds_mail" data-cmd="mail" title="通过邮件分享"></a>
        -->
            <a href="#" class="fa fa-share-alt bds_more" data-cmd="more"></i></a>
        </div>
        <script>
            window._bd_share_config={
                "common":{"bdSnsKey":{},"bdText":"ADO连接MySQL数据库　| Gary Chan's Blog　","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
        </script>
    

    
</div>







    
        <section id="comments">
    <style> aside.comment-bar { margin: auto 30px; }</style>
    <div id="disqus_thread"></div>
    <script>
        var disqus_config = function(){
            this.page.url = 'http://durant35.github.io/2015/11/29/TACouses_iotCourse_03_ADO连接MySQL数据库/';
            this.page.identifier = '2015/11/29/TACouses_iotCourse_03_ADO连接MySQL数据库/';
        };
        var loadComment = function(){
            var d = document, s = d.createElement('script');
            s.src = '//durant35.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        }
    </script>
    
    <script> loadComment(); </script>

</section>


    




    <div class="scroll" id="post-nav-button">
        
            <a href="/2016/01/22/hexo_push你的新博客到Github/" title="上一篇: hexo，push你的新博客到Github">
                <i class="fa fa-angle-left"></i>
            </a>
        

        <a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>

        
            <a href="/2015/10/16/TACouses_iotCourse_02 Windows下的静态库和动态库/" title="下一篇: Windows下的静态库和动态库">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>

    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2019/07/21/tool_vimium几步走/">vimium几步走</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/02/26/tool_tmux几步走/">tmux几步走</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/09/10/cpp_C++ BasicMiscs/">C++ Basic</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/30/TACouses_ES2017_MCU_GPIO/">GPIO 的几种输入输出模式</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/06/VM_Changes4LifeCycle/">虚拟内存[02] 不同阶段下的内存变化</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/06/VM_VirtualAddr2PhysicalAddr/">虚拟内存[0?] 虚拟内存地址如何转换到物理内存地址</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/06/VM0_AddressSpace/">虚拟内存[00] 虚拟内存地址空间</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/06/VM_MemoryManage/">虚拟内存[0?] 内存管理</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/29/VM_Stacks/">虚拟内存[02] Linux 中的各种栈：进程栈 线程栈 内核栈 中断栈</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/29/VM1_UserSpaceSegments/">虚拟内存[01] 用户内存空间的各个段分布</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/24/TACouses_ES2017_MoCs/">嵌入式系统导论[03] Model of Computation</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/24/TACouses_ES2017_PriorityInversionbyResourceSharing/">嵌入式系统导论[04] Solutions for Priority Inversion in Real-time Scheduling</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/28/TACouses_ES2017_Java/">嵌入式系统导论[01] Linux 下手动配置 Java 环境</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/26/TACouses_ES2017_SystemC/">嵌入式系统导论[02] 浅谈 System C</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/03/programPearls_Summary after Interview in Robosense/">Summary after Robosense's Interview</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/08/linux_ldconfig4RuntimeLibraries/">ldconfig：[load]运行时库管理</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/21/Algorithms_LeastSquaresLineFitting/">[0025] Least Squares Line Fitting（最小二乘法直线拟合）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/21/Algorithms_ICP/">[0024] Iterative Closest Points（迭代最近点）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/21/programPearls_i=i++/">i = i++;</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/14/tool_CMake_find_package$pkg_check_module/">CMake 查找库: find_package vs pkg_check_modules</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/14/ROS_<arg>$<param>$<rosparam>/">ROS launch file: <arg> vs <param> vs <rosparam></a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/14/hexo_DisqusInsteadofDuoshuo/">hexo：告别多说，拥抱 Disqus</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/14/programPearls_32-bit program on 64-bit OS $ 64-bit program on 32-bit OS/">32-bit program on 64-bit OS & 64-bit program on 32-bit OS</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/13/Algorithms_OnlineJudge4Huawei2017/">算法设计与分析[0023] 秋招华为在线笔试</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/11/programPearls_JPEG$Arithmetic$LZW/">JPEG编码&算术编码、LZW编码</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/11/programPearls_DES$3DES$AES/">密码学：DES、3DES、AES</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/08/Algorithms_BST$R-B Tree/">算法设计与分析[0022] BST（二叉查找树）和 R-B Tree（红黑树）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/07/programPearls_declaration$definition$initialization$assignment/">声明/定义/初始化/赋值</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/06/programPearls_inline$static$const$extern$volatile/">C/C++常见修饰符（inline&static&const&extern&volatile）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/02/Algorithms_BasicMiscs/">算法设计与分析[0021] Some Algorithms Basic Details Review（课程总结）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/26/Algorithms_GraphProblems/">算法设计与分析[0020] 几个有关图的问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/26/Algorithms_GreedyAlgorithms/">算法设计与分析[0019] Greedy Algorithms（贪心策略）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/24/Algorithms_Vertex$Edge connectivity degree/">算法设计与分析[0018] 图的点连通度和边连通度</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/08/Algorithms_NP-Complete(I)/">算法设计与分析[0017] NP-完全问题：概述（两道证明习题）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/02/DARPA_Boss_MotionPlanninginUrbanEnvironments/">DARPA[Boss]: Motion Planning in Urban Environments</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/02/DARPA_Boss_BossandtheUrbanChallenge/">DARPA[Boss]: Boss and the Urban Challenge</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/01/Algorithms_BiGraphMatching/">算法设计与分析[0016] 二分图匹配问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/01/Algorithms_UnionFindSet/">算法设计与分析[0015] Union Find Set（并查集）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/26/Algorithms_Dynamic Programming(V)/">算法设计与分析[0014] Dynamic Programming(V) 一道习题</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/19/Algorithms_MaximizingFlow/">算法设计与分析[0013] 网络流：最大流（Max Flow）问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/16/hsw_CPUWipeoutIlliteracy/">CPU 扫盲（核心数/线程数）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/13/hsw_UbuntuSystemBootSequence/">一张图带你看 Ubuntu(Linux) 系统启动过程</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/12/Algorithms_LongestPalindromicSubsequence/">算法设计与分析[0012] Dynamic Programming(IV)（Longest Palindromic Subsequence）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/03/Algorithms_LongestCommonSubsequence/">算法设计与分析[0011] Dynamic Programming(III)（Longest Common Subsequence）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/28/Algorithms_LongestIncreasingSubsequence/">算法设计与分析[0010] Longest Increasing Subsequence（最长递增子序列）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/23/Algorithms_Dynamic Programming(II)/">算法设计与分析[0009] Dynamic Programming(II)（Maximum Sum/Product Subarray）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/13/Algorithms_Dynamic Programming(I)/">算法设计与分析[0008] Dynamic Programming(I)（Unique Paths）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/06/Algorithms_Minimum Spanning Tree/">算法设计与分析[0007] Minimum Spanning Tree（最小生成树）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/29/Algorithms_Some Shortest-path Algorithms/">算法设计与分析[0006] Some Shortest-path Algorithms（最短路径算法）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/22/Algorithms_BFS/">算法设计与分析[0005] Breadth First Search（广度优先搜索）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/15/Algorithms_DFS/">算法设计与分析[0004] Depth First Search（深度优先搜索）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/10/Algorithms_An Alibaba Interview Question/">算法设计与分析[0003] 一道阿里巴巴面试题（2017） </a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/04/Algorithms_FFT/">算法设计与分析[0002] Divide and Conquer——FFT（快速傅里叶变换）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/26/Algorithms_Divide and Conquer/">算法设计与分析[0001] Divide and Conquer </a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/04/programPearls_cv_Digital-Image-Process(pg_2016)/">Digital Image Process</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/04/linux_LinuxCommandNotes/">Linux命令小纸条</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/04/tool_vim几步走/">vim几步走</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/04/TACourses_Summer-trainning-in-July,2016/">Summer-trainning in July, 2016</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/02/hexo-md源文件内容修改预览页面刷新无效/">hexo，md源文件内容修改预览页面刷新无效</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/25/raspberry_using_an_external_wireless_card(CF-WU855P)/">RaspberryPi, Use an external wireless card(ComFast-WU855P)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/25/raspberry_enable-ssh-without-UI/">RaspberryPi, enable ssh without UI</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/24/python_sort-Functions/">8 sort functions using python</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/10/programPearls_libpcap 32-bit$64-bit/">libpcap, 32-bit&64-bit</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/09/misc_Key Word Engineering/">Key Word Engineering</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/07/hexo_Theme Yelee Migrant Note(2)/">hexo博客主题Yelee迁移笔记(二)</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/03/ROS_ROS_Navigation_GettingStarted/">初识ROS自主导航</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/03/linux_sudo_unable_to_resolve_host/">sudo, unable to resolve host</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/02/ROS_ROS_Basics/">ROS Basics</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/01/TACouses_Embedded_System_2016/">嵌入式系统导论[00] Overview, DOL and MPARM</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/17/hsw_从VS的dumpbin目录谈x86,i386,x86-64,amd64/">从 VS 的 dumpbin 目录谈 x86、xi386、x86-64、amd64...</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/16/hexo_Theme Yelee Migrant Note/">hexo博客主题Yelee迁移笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/16/programPearls_dumpbin指南/">dumpbin 指南</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/08/programPearls_Win$Linux下操作ini配置文件(DIY)/">Win/Linux下操作ini配置文件(DIY)</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/08/programPearls_Win$Linux下基本文件操作/">Win/Linux下基本文件操作</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/08/programPearls_Win$Linux Operate ini configuration files(API)/">Win/Linux下操作ini配置文件(API)</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/08/programPearls_precise delay using select/">使用 select 函数实现更为精确的延时</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/08/linux_瞎谈Socket编程_3/">瞎谈Socket编程(三) Win/Linux下的UDP编程</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/26/tool_git几步走/">git几步走</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/16/linux_瞎谈Socket编程_2/">瞎谈 Socket 编程(二)</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/16/hexo_hexo分级目录与多标签/">hexo分级目录与多标签</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/15/linux_瞎谈Socket编程_1/">瞎谈 Socket 编程(一)</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/02/programPearls_C语言中结构体内存free/">C语言中结构体内存free</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/30/programPearls_Java到底是不是一种纯面向对象语言？/">Java到底是不是一种纯面向对象语言？</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/12/OverlappingSounds_写于幸运保研后/">写于幸运保研后</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/09/OverlappingSounds_Basketball_Never_Stops/">Basketball Never Stops</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/21/tool_CMake_快速入门/">CMake 快速入门</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/21/programPearls_.h中的ifndef..define..endif/">.h中的#ifndef..#define..#endif</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/25/programPearls_Coding中的编码问题之回顾$深入/">Coding中的编码问题之回顾&深入</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/22/programPearls_Coding中的编码问题之系统学习/">Coding中的编码问题之系统学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/21/programPearls_Coding中的编码问题之入门$概览/">Coding中的编码问题之入门&概览</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/16/mcu_老顽童STM32开发板系列教程笔记/">老顽童STM32开发板系列教程笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/11/movies_漫威电影/">漫威21部系列电影(持续更新)</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/02/programPearls_Qt_借Qt中文乱码谈谈Coding中的编码问题/">借Qt中文乱码谈谈Coding中的编码问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/02/System_Win8.1简体中文系统切换到繁体中文系统/">Win8.1简体中文系统切换到繁体中文系统</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/02/tool_NotePad/">NotePad++</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/02/hexo_在hexo new之后立即打开新建的Markdown文稿/">在hexo new之后立即打开Markdown文稿</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/01/26/hexo_自定义主题/">hexo自定义主题</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/01/26/hexo_添加about导航栏/">hexo添加about导航栏</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/01/24/hexo_hexo错误的分类或标签无法删除/">hexo错误的分类或标签无法删除</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/01/24/hexo_hexo扫盲/">hexo扫盲</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/01/24/hexo_2.0x hexo迁移至最新版本笔记/">2.0x hexo迁移至最新版本笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/01/22/hexo_push你的新博客到Github/">hexo，push你的新博客到Github</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/11/29/TACouses_iotCourse_03_ADO连接MySQL数据库/">ADO连接MySQL数据库</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/10/16/TACouses_iotCourse_02 Windows下的静态库和动态库/">Windows下的静态库和动态库</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/10/03/graduatedesign_02 MFRC500-射频芯片射频读写模块完整设计/">MFRC500 射频芯片射频读写模块完整设计</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/09/28/TACouses_iotCourse_01 MFC-TabControl控件实现选项卡功能/">MFC TabControl控件实现选项卡功能</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/07/15/Android_快速搭建Android-ADT开发环境-基于Win7-Win8-1-其他仅供参考/">快速搭建Android ADT开发环境(基于Win7&Win8.1(both 64-bit),其他仅供参考)</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/07/09/graduatedesign_01 STM32_Keil$JLink/">(一) 搭建STM32开发环境</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/06/16/programPearls_opengl_数媒HW4参考资料/">数媒HW4参考资料</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/05/24/opencl_写两个星期OpenCL先-1/">写两个星期OpenCL先(1)</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/05/24/opencl_win7-64位下VS搭建OpenCL开发环境-Intel显卡/">win7 64位下VS2012搭建OpenCL开发环境(Intel显卡)[win8.1下VS2013亲测同样可行]</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/05/16/TACouses_JSP考勤系统-二-JDBC连接MySQL数据库/">JSP考勤系统(二) JDBC连接MySQL数据库</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/05/15/TACouses_JSP考勤系统-一-站点框架介绍与入门/">JSP考勤系统(一) 站点框架介绍与入门</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/05/11/TACouses_考勤系统-四-MFC-UI控件之ListCtrl/">考勤系统(四) MFC UI控件之ListCtrl</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/05/11/TACouses_考勤系统-三-MFC-UI控件之ComboBox/">考勤系统(三) MFC UI控件之ComboBox</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/05/06/TACouses_考勤系统-一-搭建起项目需要的开发环境/">考勤系统(一) 搭建起项目需要的开发环境</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/04/30/TACouses_考勤系统-二-MFC-ADO连接MySQL数据库/">考勤系统(二) MFC ADO连接MySQL数据库</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/04/30/hexo_win搭建hexo/">win搭建hexo</a></li></ul>




    <script>
        
    </script>



</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i> 
                2014-2020 Gary Chan
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的博客框架">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减 Hexo 双栏博客主题  v3.5">Yelee</a> by <a href="http://moxfive.xyz/" target="_blank"> MOxFIVE </a><i class="fa fa-heart animated infinite pulse"></i>
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" title="本站到访数"><i class="fa fa-user" aria-hidden="true"></i><span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>| </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit"  title="本页阅读量"><i class="fa fa-eye animated infinite pulse" aria-hidden="true"></i><span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>
    </div>
    
<script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.2.0/require.min.js"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 5;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>





    <script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<div class="scroll" id="scroll">
    <a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" onclick="load$hide();" title="查看评论"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        var oOpenInNew = {
            
            
             post: ".article-entry a[href], .copyright a[href]", 
            
            
            
            
            
            
             friends: "#js-friends a", 
             socail: ".social a" 
        }
        for (var x in oOpenInNew) {
            $(oOpenInNew[x]).attr("target", "_blank");
        }
    
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
</body>
</html>