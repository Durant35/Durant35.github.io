<!DOCTYPE html>
<html lang="zh-Hans">
<head>

    <!-- hexo-inject:begin --><!-- hexo-inject:end --><!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]-->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no" />
<meta name="author" content="Gary" />



<meta name="description" content="加密方法可以分为两大类：一类是对称密码体制，又称单钥或私钥密码体制（private key cryptography）；还有一类是非对称密码体制，也称双钥或公开密钥体制（public key cryptography）。前者的加密和解密过程都用同一套密码，后者的加密和解密过程用的是两套密码。　　在单钥加密的情况下，密钥">
<meta name="keywords" content="DES,AES">
<meta property="og:type" content="article">
<meta property="og:title" content="密码学：DES、3DES、AES">
<meta property="og:url" content="http://durant35.github.io/2017/07/11/programPearls_DES$3DES$AES/index.html">
<meta property="og:site_name" content="Gary&#39;s Blog">
<meta property="og:description" content="加密方法可以分为两大类：一类是对称密码体制，又称单钥或私钥密码体制（private key cryptography）；还有一类是非对称密码体制，也称双钥或公开密钥体制（public key cryptography）。前者的加密和解密过程都用同一套密码，后者的加密和解密过程用的是两套密码。　　在单钥加密的情况下，密钥只有一把，所以密钥的保存变得很重要，一旦秘钥泄露，密文也就被破解了；在双钥加">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://durant35.github.io/img/programPearls/encryption/DES_Diagram.jpg">
<meta property="og:image" content="http://durant35.github.io/img/programPearls/encryption/DES_KiGenerate.png">
<meta property="og:image" content="http://durant35.github.io/img/programPearls/encryption/DES_ReplacementOne.png">
<meta property="og:image" content="http://durant35.github.io/img/programPearls/encryption/DES_LeftShiftTable.png">
<meta property="og:image" content="http://durant35.github.io/img/programPearls/encryption/DES_CompressionReplacementTable.png">
<meta property="og:image" content="http://durant35.github.io/img/programPearls/encryption/DES_Details.png">
<meta property="og:image" content="http://durant35.github.io/img/programPearls/encryption/DES_IPTable.png">
<meta property="og:image" content="http://durant35.github.io/img/programPearls/encryption/DES_ProductTransform.png">
<meta property="og:image" content="http://durant35.github.io/img/programPearls/encryption/DES_ExtendedOperation.png">
<meta property="og:image" content="http://durant35.github.io/img/programPearls/encryption/DES_CompressionOperation.png">
<meta property="og:image" content="http://durant35.github.io/img/programPearls/encryption/DES_S1Box.png">
<meta property="og:image" content="http://durant35.github.io/img/programPearls/encryption/DES_ReplacementOperation.png">
<meta property="og:image" content="http://durant35.github.io/img/programPearls/encryption/DES_IPInverseTable.png">
<meta property="og:image" content="http://durant35.github.io/img/programPearls/encryption/DES_FlowChart.png">
<meta property="og:image" content="http://durant35.github.io/img/programPearls/encryption/3DES_Diagram.jpg">
<meta property="og:image" content="http://durant35.github.io/img/programPearls/encryption/AES_FlowChart(De&En).png">
<meta property="og:image" content="http://durant35.github.io/img/programPearls/encryption/AES_NbNkNr.png">
<meta property="og:image" content="http://durant35.github.io/img/programPearls/encryption/AES_OrganizeMatrix.png">
<meta property="og:image" content="http://durant35.github.io/img/programPearls/encryption/AES_KeyExpansionPseudocode.png">
<meta property="og:image" content="http://durant35.github.io/img/programPearls/encryption/AES_CipherPseudocode.png">
<meta property="og:image" content="http://durant35.github.io/img/programPearls/encryption/AES_ShiftRows.png">
<meta property="og:image" content="http://durant35.github.io/img/programPearls/encryption/AES_ShiftRowsTable.png">
<meta property="og:image" content="http://durant35.github.io/img/programPearls/encryption/AES_MixColumns.png">
<meta property="og:image" content="http://durant35.github.io/img/programPearls/encryption/AES_InvCipherPseudocode.png">
<meta property="og:image" content="http://durant35.github.io/img/programPearls/encryption/AES_InvMixColumns.png">
<meta property="og:updated_time" content="2017-07-14T09:21:43.589Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="密码学：DES、3DES、AES">
<meta name="twitter:description" content="加密方法可以分为两大类：一类是对称密码体制，又称单钥或私钥密码体制（private key cryptography）；还有一类是非对称密码体制，也称双钥或公开密钥体制（public key cryptography）。前者的加密和解密过程都用同一套密码，后者的加密和解密过程用的是两套密码。　　在单钥加密的情况下，密钥只有一把，所以密钥的保存变得很重要，一旦秘钥泄露，密文也就被破解了；在双钥加">
<meta name="twitter:image" content="http://durant35.github.io/img/programPearls/encryption/DES_Diagram.jpg">

<link rel="apple-touch-icon" href= "/apple-touch-icon.png">


    <link rel="alternate" href="/atom.xml" title="Gary&#39;s Blog" type="application/atom+xml">



    <link rel="shortcut icon" href="/img/favicon.ico">



    <link href="//cdn.bootcss.com/animate.css/3.5.1/animate.min.css" rel="stylesheet">



    <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">



    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet">


<link rel="stylesheet" href="/css/style.css">



<link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">


<title>密码学：DES、3DES、AES | Gary&#39;s Blog</title>

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>

<script>
    var yiliaConfig = {
        fancybox: true,
        animate: true,
        isHome: false,
        isPost: true,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: true
    }
</script>


    <script> yiliaConfig.jquery_ui = [false]; </script>



    <script> yiliaConfig.rootUrl = "\/";</script><!-- hexo-inject:begin --><!-- hexo-inject:end -->






</head>
<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="/img/avatar.png" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">Gary</a></h1>
        </hgroup>

        
        <p class="header-subtitle">　　你永远流淌在我的记忆里？River flows in you</p>
        

        
            <form id="search-form">
            <input type="text" id="local-search-input" name="q" placeholder="search..." class="search form-control" autocomplete="off" autocorrect="off" searchonload="false" />
            <i class="fa fa-times" onclick="resetSearch()"></i>
            </form>
            <div id="local-search-result"></div>
            <p class='no-result'>No results found <i class='fa fa-spinner fa-pulse'></i></p>
        


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">Home</a></li>
                        
                            <li><a href="/tags">All-tags</a></li>
                        
                            <li><a href="/archives">All-lists</a></li>
                        
                            <li><a href="/Shengjie">Contact</a></li>
                        
                            <li><a href="/about">About</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa 新浪微博" href="http://weibo.com/u/2911566017/home?topnav=1&wvr=6" title="新浪微博"></a>
                            
                                <a class="fa GitHub" href="https://github.com/Durant35" title="GitHub"></a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/3D/">3D</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/AES/">AES</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Algorithm/">Algorithm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Android/">Android</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/C-C/">C/C++</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CMD/">CMD</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CMake/">CMake</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CV/">CV</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DARPA/">DARPA</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DES/">DES</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DLL/">DLL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Encoding/">Encoding</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HUAWEI/">HUAWEI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hexo/">Hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JPEG/">JPEG</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JSP/">JSP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/">Java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Key-words/">Key-words</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LZW/">LZW</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MCU/">MCU</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MFC/">MFC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NotePad/">NotePad++</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OpenCL/">OpenCL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OpenGL/">OpenGL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PCB/">PCB</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Qt/">Qt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ROS/">ROS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Socket/">Socket</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VM/">VM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VS2013/">VS2013</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Windows/">Windows</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/bash/">bash</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dumpbin/">dumpbin</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ini/">ini</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/leetcode/">leetcode</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pcap/">pcap</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vim/">vim</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/文件操作/">文件操作</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/漫威电影/">漫威电影</a></li></ul>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a class="main-nav-link switch-friends-link" href="https://hexo.io">Hexo</a>
                    
                      <a class="main-nav-link switch-friends-link" href="https://github.com/">GitHub</a>
                    
                      <a class="main-nav-link switch-friends-link" href="http://wiki.ros.org/">ROS</a>
                    
                      <a class="main-nav-link switch-friends-link" href="http://zhiqiu.github.io/">Zhiqiu&#39;s Blog</a>
                    
                      <a class="main-nav-link switch-friends-link" href="http://www.ruanyifeng.com/blog/">阮一峰的网络日志</a>
                    
                      <a class="main-nav-link switch-friends-link" href="https://rh-song.github.io/">RiHui-Song&#39;s Blog</a>
                    
                      <a class="main-nav-link switch-friends-link" href="https://goshin.github.io/">Goshin&#39;s Blog</a>
                    
                      <a class="main-nav-link switch-friends-link" href="http://blog.csdn.net/u014593748">Kangdk&#39;s CSDN</a>
                    
                    </div>
                </section>
                

                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">Gary</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="/img/avatar.png" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">Gary</a></h1>
            </hgroup>
            
            <p class="header-subtitle">　　你永远流淌在我的记忆里？River flows in you</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">Home</a></li>
                
                    <li><a href="/tags">All-tags</a></li>
                
                    <li><a href="/archives">All-lists</a></li>
                
                    <li><a href="/Shengjie">Contact</a></li>
                
                    <li><a href="/about">About</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa 新浪微博" target="_blank" href="http://weibo.com/u/2911566017/home?topnav=1&wvr=6" title="新浪微博"></a>
                            
                                <a class="fa GitHub" target="_blank" href="https://github.com/Durant35" title="GitHub"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
    <link class="menu-list" tags="标签" friends="友情链接" about="关于我"/>
</nav>
      <div class="body-wrap"><article id="post-programPearls_DES$3DES$AES" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/07/11/programPearls_DES$3DES$AES/" class="article-date">
      <time datetime="2017-07-11T10:02:16.000Z" itemprop="datePublished">2017-07-11</time>
</a>



 
    <a href="/2017/07/11/programPearls_DES$3DES$AES/#comments" title="查看评论">
        <i class="fa fa-comments-o" aria-hidden="true"></i>
        <span class="count-comment"></span>
        
        
            <span class="disqus-comment-count" data-disqus-identifier="2017/07/11/programPearls_DES$3DES$AES/"></span>
        
    </a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      密码学：DES、3DES、AES
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/编程珠玑/">编程珠玑</a><a class="article-category-link" href="/categories/编程珠玑/Algorithm/">Algorithm</a>
    </div>


        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/AES/">AES</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/DES/">DES</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>　　加密方法可以分为两大类：一类是对称密码体制，又称单钥或私钥密码体制（private key cryptography）；还有一类是非对称密码体制，也称双钥或公开密钥体制（public key cryptography）。前者的加密和解密过程都用同一套密码，后者的加密和解密过程用的是两套密码。<br>　　在单钥加密的情况下，密钥只有一把，所以密钥的保存变得很重要，一旦秘钥泄露，密文也就被破解了；在双钥加密的情况下，秘钥有两把，一把是公开的公钥，还有一把是不公开的私钥，公钥与私钥是一一对应的关系，有一把公钥就必然有一把与之对应的、独一无二的私钥，反之亦成立。此外，①同时生成公钥和私钥应该是相对比较容易的：所有的公钥、私钥对都不同，用公钥可以解开私钥加密的信息，反之用私钥也可以解开公钥加密的信息；但是②从公钥推算出私钥，应该是很困难或者是不可能的。<br>　　目前，通用的单钥加密算法有 DES（Data Encryption Standard），通用的双钥加密算法为 RSA（Rivest-Shamir-Adleman），本文主要介绍三种常用的单钥加密算法：DES、3DES（Triple DES） 以及 AES（Advanced Encryption Standard）。<a id="more"></a></p>
<h3 id="DES-算法"><a href="#DES-算法" class="headerlink" title="DES 算法"></a>DES 算法</h3><ul>
<li>DES 算法简介<ul>
<li>DES 算法为密码体制中的对称密码体制，又被称为美国数据加密标准，是 1972 年美国 IBM 公司研制的对称密码体制加密算法；</li>
<li>DES 是一种用 56 位密钥来加密 64 位数据的方法，密钥长度为 56 位，明文按 64 位进行分组，将分组后的明文组和 56 位的密钥按位替代或交换的方法形成密文组；</li>
<li>DES 加密算法特点：分组比较短、密钥太短、秘钥生命周期短，运行速度较慢。</li>
</ul>
</li>
<li>DES 工作的基本原理<ul>
<li>入口参数有三个：key、data、mode<ul>
<li>key：加密解密使用的密钥</li>
<li>data：加密解密的数据</li>
<li>mode：工作模式<center><img src="/img/programPearls/encryption/DES_Diagram.jpg" width="320px" alt="" /></center></li>
</ul>
</li>
<li>当模式为加密模式时，明文按照 64 位进行分组，形成明文组，key 用于对数据加密。<ul>
<li>把输入的 64 位数据块经过初始置换按位重新组合，并把输出 $L_0$、$R_0$ 两部分，每部分各长32 位；</li>
<li>然后 $R_0$ 与第一轮子密钥 $K_1$ 进行 $f(R_0, K_1)$ 运算，运算结果再与 $L_0$ 进行按位异或运算，运行结果交换为下一轮的 $R_1$，$R_0$ 交换作为下一轮的 $L_1$；下一轮同样进行 $f(R_i, K_i)$ 运算，以此类推共进行 16 轮；</li>
<li>最后一轮不用进行交换，最后进行逆初始置换，即为密文输出。</li>
</ul>
</li>
<li>子密钥 $K_i$（48 bit）生成算法（概述）<ul>
<li>初始 key 值为 64 位，但 DES 算法规定，其中第 8、16、…、64 位是奇偶校验位，不参与 DES 运算，故 key 实际可用位数便只有 56 位；</li>
<li>经过缩小选择换位表 1 的变换后，key 的位数由 64 位变成了 56 位，此 56 位分为 $C_0$、$D_0$ 两部分，各 28 位；分别进行第 1 次循环左移，得到 $C_1$、$D_1$，将 $C_1$（28位）、$D_1$（28位）合并得到 56 位，再经过缩小选择换位 2，从而便得到了密钥 $K_0$（48位）；</li>
<li>以此类推，便可得到 $K_1$、$K_2$、…、$K_{15}$，不过需要注意的是，16 次循环左移对应的左移位数要依据下述规则进行：循环左移位数 $1, 1, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 1$。</li>
</ul>
</li>
<li>当模式为解密模式时，key 用于对数据解密<ul>
<li>DES 的解密过程与加密一样，区别仅仅在于第一次迭代时用子密钥 $K_{15}$、第二次 $K_{14}$、…，最后一次用 $K_0$，算法本身并没有任何变化。</li>
</ul>
</li>
<li>在通信网络的两端，双方约定一致的 key，在通信的源点用 key 对核心数据进行 DES 加密，然后以密文形式在公共通信网（如电话网）中传输到通信网络的终点，数据到达目的地后，用同样的 key 对密文数据进行解密，便再现了明码形式的核心数据。</li>
<li>实际运用中，密钥只用到了 64 位中的 56 位，这样才具有高的安全性。<br><br/></li>
</ul>
</li>
</ul>
<h4 id="密钥的产生：子密钥-K-i-（48-bit）生成算法"><a href="#密钥的产生：子密钥-K-i-（48-bit）生成算法" class="headerlink" title="密钥的产生：子密钥 $K_i$（48 bit）生成算法"></a>密钥的产生：子密钥 $K_i$（48 bit）生成算法</h4><p>　　DES 含有 16 轮非线性变换，每一轮变换都用一个 48bits 的子密钥，共需 16 个不同的 48bits 的子密钥。一个 64bits 的外部密钥经过以下密钥产生器产生 16 个 48bits 的子密钥。</p>
<p><center><img src="/img/programPearls/encryption/DES_KiGenerate.png" width="540px" alt="" /></center></p>
<ul>
<li>奇偶校验：64 位 $K$ 中第 8、16、…、64 位是奇偶校验位。</li>
<li>置换 1：作用是将 56bits 密钥 $K’$ 各位上的数按规定方式进行换位，置换后的 56bits 分别存到两个 28bits 的寄存器 $C_0$、$D_0$ 中，如下图：<br><center><img src="/img/programPearls/encryption/DES_ReplacementOne.png" width="460px" alt="" /></center><ul>
<li>$C_0$ 的各位依次为原密钥中的第 57、49、41、…、36 位，$D_0$ 的各位依次为原密钥中的第 63、55、47、…、4 位。</li>
</ul>
</li>
<li>循环左移寄存器：每个循环左移寄存器都有 28bits，加密时，循环寄存器 $C_{i+1}$、$D_{i+1}$ 的内容是将循环寄存器 $C_i$、$D_i$ 的内容分别左移 1 至 2 位得到的，各级寄存器移位的比特数如下表：<center><img src="/img/programPearls/encryption/DES_LeftShiftTable.png" width="540px" alt="" /></center></li>
<li>压缩置换：从 56bits 内容中选出 48bits，产生 16 轮加密的 16 个子密钥，压缩置换表如下：<br><center><img src="/img/programPearls/encryption/DES_CompressionReplacementTable.png" width="340px" alt="" /></center><ul>
<li>压缩置换表中的数字表示循环寄存器对 $(C_i, D_i)$ 的比特序号，读取顺序是从左到右、从上到下，即 $D_i$ 的第 14、17、11、…、32位分别置换成 $C_i$ 的第 1、2、3、…、48位。</li>
</ul>
</li>
<li>具体实现如下<code>void initKey(const char key[8])</code>函数。</li>
<li>  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 置换 1 置换表</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> REPLACE_ONE_TABLE[] = &#123;</span><br><span class="line">  <span class="number">57</span>,<span class="number">49</span>,<span class="number">41</span>,<span class="number">33</span>,<span class="number">25</span>,<span class="number">17</span>,<span class="number">9</span>,<span class="number">1</span>,</span><br><span class="line">  <span class="number">58</span>,<span class="number">50</span>,<span class="number">42</span>,<span class="number">34</span>,<span class="number">26</span>,<span class="number">18</span>,<span class="number">10</span>,<span class="number">2</span>,</span><br><span class="line">  <span class="number">59</span>,<span class="number">51</span>,<span class="number">43</span>,<span class="number">35</span>,<span class="number">27</span>,<span class="number">19</span>,<span class="number">11</span>,<span class="number">3</span>,</span><br><span class="line">  <span class="number">60</span>,<span class="number">52</span>,<span class="number">44</span>,<span class="number">36</span>,<span class="number">63</span>,<span class="number">55</span>,<span class="number">47</span>,<span class="number">39</span>,</span><br><span class="line">  <span class="number">31</span>,<span class="number">23</span>,<span class="number">15</span>,<span class="number">7</span>,<span class="number">62</span>,<span class="number">54</span>,<span class="number">46</span>,<span class="number">38</span>,</span><br><span class="line">  <span class="number">30</span>,<span class="number">22</span>,<span class="number">14</span>,<span class="number">6</span>,<span class="number">61</span>,<span class="number">53</span>,<span class="number">45</span>,<span class="number">37</span>,</span><br><span class="line">  <span class="number">29</span>,<span class="number">21</span>,<span class="number">13</span>,<span class="number">5</span>,<span class="number">28</span>,<span class="number">20</span>,<span class="number">12</span>,<span class="number">4</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 压缩置换表</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> COMPRESSION_REPLACE_TABLE[] = &#123;</span><br><span class="line">  <span class="number">14</span>,<span class="number">17</span>,<span class="number">11</span>,<span class="number">24</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">28</span>,</span><br><span class="line">  <span class="number">15</span>,<span class="number">6</span>,<span class="number">21</span>,<span class="number">10</span>,<span class="number">23</span>,<span class="number">19</span>,<span class="number">12</span>,<span class="number">4</span>,</span><br><span class="line">  <span class="number">26</span>,<span class="number">8</span>,<span class="number">16</span>,<span class="number">7</span>,<span class="number">27</span>,<span class="number">20</span>,<span class="number">13</span>,<span class="number">2</span>,</span><br><span class="line">  <span class="number">41</span>,<span class="number">52</span>,<span class="number">31</span>,<span class="number">37</span>,<span class="number">47</span>,<span class="number">55</span>,<span class="number">30</span>,<span class="number">40</span>,</span><br><span class="line">  <span class="number">51</span>,<span class="number">45</span>,<span class="number">33</span>,<span class="number">48</span>,<span class="number">44</span>,<span class="number">49</span>,<span class="number">39</span>,<span class="number">56</span>,</span><br><span class="line">  <span class="number">34</span>,<span class="number">53</span>,<span class="number">46</span>,<span class="number">42</span>,<span class="number">50</span>,<span class="number">36</span>,<span class="number">29</span>,<span class="number">32</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 每轮迭代循环左移位数表</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> LEFT_SHIFT_TABLE[] = &#123;</span><br><span class="line">  <span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 16 轮子密钥</span></span><br><span class="line"><span class="keyword">bool</span> subKey[<span class="number">16</span>][<span class="number">48</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//--------------byte转换bit---------------</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bytetobit</span><span class="params">(<span class="keyword">bool</span>* out, <span class="keyword">const</span> <span class="keyword">char</span>* in, <span class="keyword">int</span> bitslen)</span></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; bitslen; i++)&#123;</span><br><span class="line">    out[i] = in[i/<span class="number">8</span>]&gt;&gt;(i%<span class="number">8</span>) &amp; <span class="number">0x1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//--------------置换操作---------------</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">tableReplace</span><span class="params">(<span class="keyword">bool</span>* out, <span class="keyword">const</span> <span class="keyword">bool</span>* in, <span class="keyword">const</span> <span class="keyword">int</span>* table, <span class="keyword">int</span> len)</span></span>&#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">bool</span> temp[<span class="number">256</span>];</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++)&#123;</span><br><span class="line">    temp[i] = in[table[i]<span class="number">-1</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">memcpy</span>(out, temp, len);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//--------------循环左移---------------</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">leftLoopShift</span><span class="params">(<span class="keyword">bool</span>* in, <span class="keyword">int</span> len, <span class="keyword">int</span> loop)</span></span>&#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">bool</span> temp[<span class="number">256</span>];</span><br><span class="line">  <span class="built_in">memcpy</span>(temp, in, loop);</span><br><span class="line">  <span class="built_in">memcpy</span>(in, in+loop, len-loop);</span><br><span class="line">  <span class="built_in">memcpy</span>(in+len-loop, temp, loop);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/*--------------密钥初始化---------------</span></span><br><span class="line"><span class="comment"> * key[8]: 64 位密钥</span></span><br><span class="line"><span class="comment"> * subKey[16][48]: 16 个 48-bit 子密钥</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">initKey</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> key[<span class="number">8</span>])</span></span>&#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">bool</span> kbit[<span class="number">64</span>],*kl = &amp;kbit[<span class="number">0</span>], *kr = &amp;kbit[<span class="number">28</span>];</span><br><span class="line">  bytetobit(kbit, key, <span class="number">64</span>);</span><br><span class="line">  <span class="comment">// 置换1</span></span><br><span class="line">  tableReplace(kbit, kbit, REPLACE_ONE_TABLE, <span class="number">56</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i ++)&#123;</span><br><span class="line">    leftloop(kl, <span class="number">28</span>, LEFT_SHIFT_TABLE[i]);</span><br><span class="line">    leftloop(kr, <span class="number">28</span>, LEFT_SHIFT_TABLE[i]);</span><br><span class="line">    <span class="comment">// 压缩置换</span></span><br><span class="line">    tableReplace(subKey[i], kbit, COMPRESSION_REPLACE_TABLE, <span class="number">48</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="明文加密过程"><a href="#明文加密过程" class="headerlink" title="明文加密过程"></a>明文加密过程</h4><p><center><img src="/img/programPearls/encryption/DES_Details.png" width="720px" alt="" /></center></p>
<ul>
<li>初始置换 $IP$：将 64bits 明文的位置进行置换，得到一个乱序的 64bits 明文组，而后分成左右两段，每段为 32bits，以 $L_0$ 和 $R_0$ 表示；$IP$ 中各列元素位置号相差为 8，相当于将明文各字节按列读出，各列比特经过偶采样和奇采样置换后，再对各行进行逆序。<ul>
<li>初始置换表 $IP$ 如下：<br>  <center><img src="/img/programPearls/encryption/DES_IPTable.png" width="360px" alt="" /></center><ul>
<li>即将初始置换表中的元素按行读出构成置换输出。</li>
<li>$IP$ 和最后的 $IP^{-1}$ 在密码上意义不大，它们的作用在于打乱原输入的 ASCII 码字划分的关系，并将原来明文的校验位<code>[8]</code>、<code>[16]</code>、…、<code>[64]</code>变成 $IP$ 输出的一个字节。</li>
</ul>
</li>
</ul>
</li>
<li>乘积变换 $f$：DES 算法的核心部分。<ul>
<li>将经过 $IP$ 置换后的数据分成 32bits 的左右两组，在迭代过程中彼此左右交换位置。</li>
<li>每次迭代时只对右边的 32bits $R_{i-1}$ 进行一系列的加密交换，在此轮迭代即将结束时，把左边的 32bits $L_{i-1}$ 与右边得到的 32bits $R_{i-1}$ 逐位模 2 相加，作为下一轮迭代时右边的段 $R_{i}$，并将原来右边未经变换的段 $R_{i-1}$ 直接送到左边的寄存器作为下一轮迭代时左边的段 $L_i$。<center><img src="/img/programPearls/encryption/DES_ProductTransform.png" width="420px" alt="" /></center></li>
<li>在每一轮迭代时，右边的段 $R_{i-1}$ 要经过选择扩展运算 E、密钥加密运算、选择压缩算法 S、置换运算 P 和左右混合运算。<ul>
<li>选择扩展运算 E（扩展置换）：将输入的 32bits $R_{i-1}$ 扩展成 48bits 的输出，令 s 表示 E 原输入数据比特的原下标，则 E 的输出是将原下标 $s[ 0或1 (mod 4)]$ 的各比特重复一次得到，即对原来第 1、4、5、8、9、…、32 各位都重复一次，实现数据扩展，将下表中数据按行读出得到 48bits 输出。<br>  <center><img src="/img/programPearls/encryption/DES_ExtendedOperation.png" width="720px" alt="" /></center><ul>
<li>扩展置换的目的有两个：①生成与密钥长度相同的数据以进行异或运算；②提供更长的结果，在后续的替代运算中可以进行压缩。</li>
</ul>
</li>
<li>选择压缩运算 S（S-盒代替）：将前面送来的 48bits 数据自左至右分成 8 组，每组 6bits，而后并行送入 8 个 S-盒，每个 S-盒为一个非线性代换网络，有 4 个输出，如下图：<br>  <center><img src="/img/programPearls/encryption/DES_CompressionOperation.png" width="420px" alt="" /></center><ul>
<li>每个 S-盒都是一个 4×16 的矩阵，每行都是 0～15 的数字，但每行的数字排列都不同；每个 S-盒有 6 位输入，4 位输出，6 位输入中的第 1 位和第 6 位数字组成的二进制数值决定置换矩阵的行数，其余 4 位数字所组成的二进制数值决定置换矩阵的列数，行数和列数交点的数字便是 S-盒的输出。<center><img src="/img/programPearls/encryption/DES_S1Box.png" width="480px" alt="" /></center></li>
<li>上表是 $S_1$-盒：假设 $S_1$-盒的输入是<code>110010</code>，因第 1 位和第 6 位数字组成的二进制数为：$10_{(2) = 2}$，对应$S_1$-盒行号为 2 的那一行，其余 4 个数字所组成的二进制数为：$1001{(2) = 9}$，对应 $S_1$-盒列号为 9 的那一列，交点处的数是 12，则 $S_1$-盒的输出为<code>1100</code>。</li>
<li><font color="blue">S-盒代替是 DES 算法的关键步骤，所有其它的运算都是线性的，易于分析；而 S-盒是非线性的，相比于其它步骤，提供了更好的安全性</font>。</li>
</ul>
</li>
<li>置换运算  P（P-盒置换）：对 $S_1$-至 $S_8$-盒输出的 32bits 数据进行坐标置换，置换表如下：<center><img src="/img/programPearls/encryption/DES_ReplacementOperation.png" width="720px" alt="" /></center></li>
<li>置换 P 输出的 32bits 数据与左边 32bits，即 $R{i-1}$ 逐位模 2 相加（异或运算），所得到的 32bits 作为下一轮迭代用的右边的数字段 $R_i$，并将 $R_{i-1}$ 并行送到左边的寄存器，作为下一轮迭代用的左边的数字段 $L_i$。</li>
</ul>
</li>
</ul>
</li>
<li>逆初始置换 $IP^{-1}$：将 16 轮迭代后给出的 64bits 组进行置换，得到输出的密文组，输出为逆初始置换表中元素按行读得的结果。<ul>
<li>逆初始置换表 $IP^{-1}$ 如下：<br><center><img src="/img/programPearls/encryption/DES_IPInverseTable.png" width="360px" alt="" /></center><br>$\quad$ 逆初始置换是初始置换的逆过程，DES 最后一轮后，左、右两半部分并未进行交换，而是两部分合并形成一个分组作为逆置换的输入，置换方法同上。</li>
</ul>
</li>
<li>具体实现如下<code>void DES(char out[8], char in[8], bool mode=encrypt)</code>函数。</li>
<li>  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> &#123;encrypt, decrypt&#125;;</span><br><span class="line"><span class="comment">// 初始置换表</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> IP_TABLE[] = &#123;</span><br><span class="line">  <span class="number">58</span>,<span class="number">50</span>,<span class="number">42</span>,<span class="number">34</span>,<span class="number">26</span>,<span class="number">18</span>,<span class="number">10</span>,<span class="number">2</span>,</span><br><span class="line">  <span class="number">60</span>,<span class="number">52</span>,<span class="number">44</span>,<span class="number">36</span>,<span class="number">28</span>,<span class="number">20</span>,<span class="number">12</span>,<span class="number">4</span>,</span><br><span class="line">  <span class="number">62</span>,<span class="number">54</span>,<span class="number">46</span>,<span class="number">38</span>,<span class="number">30</span>,<span class="number">22</span>,<span class="number">14</span>,<span class="number">6</span>,</span><br><span class="line">  <span class="number">64</span>,<span class="number">56</span>,<span class="number">48</span>,<span class="number">40</span>,<span class="number">32</span>,<span class="number">24</span>,<span class="number">16</span>,<span class="number">8</span>,</span><br><span class="line">  <span class="number">57</span>,<span class="number">49</span>,<span class="number">41</span>,<span class="number">33</span>,<span class="number">25</span>,<span class="number">17</span>,<span class="number">9</span>,<span class="number">1</span>,</span><br><span class="line">  <span class="number">59</span>,<span class="number">51</span>,<span class="number">43</span>,<span class="number">35</span>,<span class="number">27</span>,<span class="number">19</span>,<span class="number">11</span>,<span class="number">3</span>,</span><br><span class="line">  <span class="number">61</span>,<span class="number">53</span>,<span class="number">45</span>,<span class="number">37</span>,<span class="number">29</span>,<span class="number">21</span>,<span class="number">13</span>,<span class="number">5</span>,</span><br><span class="line">  <span class="number">63</span>,<span class="number">55</span>,<span class="number">47</span>,<span class="number">39</span>,<span class="number">31</span>,<span class="number">23</span>,<span class="number">15</span>,<span class="number">7</span></span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 逆初始置换表</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> IIP_TABLE[] = &#123;</span><br><span class="line">  <span class="number">40</span>,<span class="number">8</span>,<span class="number">48</span>,<span class="number">16</span>,<span class="number">56</span>,<span class="number">24</span>,<span class="number">64</span>,<span class="number">32</span>,</span><br><span class="line">  <span class="number">39</span>,<span class="number">7</span>,<span class="number">47</span>,<span class="number">15</span>,<span class="number">55</span>,<span class="number">23</span>,<span class="number">63</span>,<span class="number">31</span>,</span><br><span class="line">  <span class="number">38</span>,<span class="number">6</span>,<span class="number">46</span>,<span class="number">14</span>,<span class="number">54</span>,<span class="number">22</span>,<span class="number">62</span>,<span class="number">30</span>,</span><br><span class="line">  <span class="number">37</span>,<span class="number">5</span>,<span class="number">45</span>,<span class="number">13</span>,<span class="number">53</span>,<span class="number">21</span>,<span class="number">61</span>,<span class="number">29</span>,</span><br><span class="line">  <span class="number">36</span>,<span class="number">4</span>,<span class="number">44</span>,<span class="number">12</span>,<span class="number">52</span>,<span class="number">20</span>,<span class="number">60</span>,<span class="number">28</span>,</span><br><span class="line">  <span class="number">35</span>,<span class="number">3</span>,<span class="number">43</span>,<span class="number">11</span>,<span class="number">51</span>,<span class="number">19</span>,<span class="number">59</span>,<span class="number">27</span>,</span><br><span class="line">  <span class="number">34</span>,<span class="number">2</span>,<span class="number">42</span>,<span class="number">10</span>,<span class="number">50</span>,<span class="number">18</span>,<span class="number">58</span>,<span class="number">26</span>,</span><br><span class="line">  <span class="number">33</span>,<span class="number">1</span>,<span class="number">41</span>,<span class="number">9</span>,<span class="number">49</span>,<span class="number">17</span>,<span class="number">57</span>,<span class="number">25</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// E 位选择表</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> E_TABLE[] = &#123;</span><br><span class="line">  <span class="number">32</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,</span><br><span class="line">  <span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,</span><br><span class="line">  <span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">13</span>,</span><br><span class="line">  <span class="number">12</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">16</span>,<span class="number">17</span>,</span><br><span class="line">  <span class="number">16</span>,<span class="number">17</span>,<span class="number">18</span>,<span class="number">19</span>,<span class="number">20</span>,<span class="number">21</span>,</span><br><span class="line">  <span class="number">20</span>,<span class="number">21</span>,<span class="number">22</span>,<span class="number">23</span>,<span class="number">24</span>,<span class="number">25</span>,</span><br><span class="line">  <span class="number">24</span>,<span class="number">25</span>,<span class="number">26</span>,<span class="number">27</span>,<span class="number">28</span>,<span class="number">29</span>,</span><br><span class="line">  <span class="number">28</span>,<span class="number">29</span>,<span class="number">30</span>,<span class="number">31</span>,<span class="number">32</span>,<span class="number">1</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// S1-S8盒</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span> S_BOX[<span class="number">8</span>][<span class="number">4</span>][<span class="number">16</span>] = &#123;</span><br><span class="line">  <span class="comment">//S1</span></span><br><span class="line">  <span class="number">14</span>, <span class="number">4</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">15</span>, <span class="number">11</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">7</span>,</span><br><span class="line">  <span class="number">0</span>, <span class="number">15</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">14</span>, <span class="number">2</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">12</span>, <span class="number">11</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">8</span>,</span><br><span class="line">  <span class="number">4</span>, <span class="number">1</span>, <span class="number">14</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">3</span>, <span class="number">10</span>, <span class="number">5</span>, <span class="number">0</span>,</span><br><span class="line">  <span class="number">15</span>, <span class="number">12</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">11</span>, <span class="number">3</span>, <span class="number">14</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">13</span>,</span><br><span class="line">  <span class="comment">//S2</span></span><br><span class="line">  <span class="number">15</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">14</span>, <span class="number">6</span>, <span class="number">11</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">13</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">10</span>,</span><br><span class="line">  <span class="number">3</span>, <span class="number">13</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">15</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">14</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">11</span>, <span class="number">5</span>,</span><br><span class="line">  <span class="number">0</span>, <span class="number">14</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">10</span>, <span class="number">4</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">15</span>,</span><br><span class="line">  <span class="number">13</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">15</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">11</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">14</span>, <span class="number">9</span>,</span><br><span class="line">  <span class="comment">//S3</span></span><br><span class="line">  <span class="number">10</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">14</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">15</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">13</span>, <span class="number">12</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>,</span><br><span class="line">  <span class="number">13</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">14</span>, <span class="number">12</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">1</span>,</span><br><span class="line">  <span class="number">13</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">11</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">7</span>,</span><br><span class="line">  <span class="number">1</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">15</span>, <span class="number">14</span>, <span class="number">3</span>, <span class="number">11</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">12</span>,</span><br><span class="line">  <span class="comment">//S4</span></span><br><span class="line">  <span class="number">7</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">15</span>,</span><br><span class="line">  <span class="number">13</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">9</span>,</span><br><span class="line">  <span class="number">10</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">11</span>, <span class="number">7</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">14</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">4</span>,</span><br><span class="line">  <span class="number">3</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">13</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">14</span>,</span><br><span class="line">  <span class="comment">//S5</span></span><br><span class="line">  <span class="number">2</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">15</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">14</span>, <span class="number">9</span>,</span><br><span class="line">  <span class="number">14</span>, <span class="number">11</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">6</span>,</span><br><span class="line">  <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">11</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">9</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">14</span>,</span><br><span class="line">  <span class="number">11</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">14</span>, <span class="number">2</span>, <span class="number">13</span>, <span class="number">6</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">3</span>,</span><br><span class="line">  <span class="comment">//S6</span></span><br><span class="line">  <span class="number">12</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">13</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">14</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">11</span>,</span><br><span class="line">  <span class="number">10</span>, <span class="number">15</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">0</span>, <span class="number">11</span>, <span class="number">3</span>, <span class="number">8</span>,</span><br><span class="line">  <span class="number">9</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">13</span>, <span class="number">11</span>, <span class="number">6</span>,</span><br><span class="line">  <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">14</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">13</span>,</span><br><span class="line">  <span class="comment">//S7</span></span><br><span class="line">  <span class="number">4</span>, <span class="number">11</span>, <span class="number">2</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">3</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">1</span>,</span><br><span class="line">  <span class="number">13</span>, <span class="number">0</span>, <span class="number">11</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">12</span>, <span class="number">2</span>, <span class="number">15</span>, <span class="number">8</span>, <span class="number">6</span>,</span><br><span class="line">  <span class="number">1</span>, <span class="number">4</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">12</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">14</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">2</span>,</span><br><span class="line">  <span class="number">6</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">10</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">15</span>, <span class="number">14</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">12</span>,</span><br><span class="line">  <span class="comment">//S8</span></span><br><span class="line">  <span class="number">13</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">15</span>, <span class="number">11</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">14</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">7</span>,</span><br><span class="line">  <span class="number">1</span>, <span class="number">15</span>, <span class="number">13</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">11</span>, <span class="number">0</span>, <span class="number">14</span>, <span class="number">9</span>, <span class="number">2</span>,</span><br><span class="line">  <span class="number">7</span>, <span class="number">11</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">12</span>, <span class="number">14</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">8</span>,</span><br><span class="line">  <span class="number">2</span>, <span class="number">1</span>, <span class="number">14</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">10</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">11</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// P-盒置换表</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> P_TABLE[] = &#123;</span><br><span class="line">  <span class="number">16</span>,<span class="number">7</span>,<span class="number">20</span>,<span class="number">21</span>,<span class="number">29</span>,<span class="number">12</span>,<span class="number">28</span>,<span class="number">17</span>,</span><br><span class="line">  <span class="number">1</span>,<span class="number">15</span>,<span class="number">23</span>,<span class="number">26</span>,<span class="number">5</span>,<span class="number">18</span>,<span class="number">31</span>,<span class="number">10</span>,</span><br><span class="line">  <span class="number">2</span>,<span class="number">8</span>,<span class="number">24</span>,<span class="number">14</span>,<span class="number">32</span>,<span class="number">27</span>,<span class="number">3</span>,<span class="number">9</span>,</span><br><span class="line">  <span class="number">19</span>,<span class="number">13</span>,<span class="number">30</span>,<span class="number">6</span>,<span class="number">22</span>,<span class="number">11</span>,<span class="number">4</span>,<span class="number">25</span></span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//--------------byte转换bit---------------</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bytetobit</span><span class="params">(<span class="keyword">bool</span>* out, <span class="keyword">const</span> <span class="keyword">char</span>* in, <span class="keyword">int</span> bitslen)</span></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; bitslen; i++)&#123;</span><br><span class="line">    out[i] = in[i/<span class="number">8</span>]&gt;&gt;(i%<span class="number">8</span>) &amp; <span class="number">0x1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//--------------置换操作---------------</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">tableReplace</span><span class="params">(<span class="keyword">bool</span>* out, <span class="keyword">const</span> <span class="keyword">bool</span>* in, <span class="keyword">const</span> <span class="keyword">int</span>* table, <span class="keyword">int</span> len)</span></span>&#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">bool</span> temp[<span class="number">256</span>];</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++)&#123;</span><br><span class="line">    temp[i] = in[table[i]<span class="number">-1</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">memcpy</span>(out, temp, len);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//--------------异或操作---------------</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">xor</span><span class="params">(<span class="keyword">bool</span>* ina, <span class="keyword">const</span> <span class="keyword">bool</span>* inb, <span class="keyword">int</span> len)</span></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;len; i++)&#123;</span><br><span class="line">    ina[i] ^= inb[i];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//--------------S盒变换---------------</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sFunc</span><span class="params">(<span class="keyword">bool</span> out[<span class="number">32</span>], <span class="keyword">const</span> <span class="keyword">bool</span> in[<span class="number">48</span>])</span></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>,j,k; i&lt;<span class="number">8</span>; i++,in+=<span class="number">6</span>,out+=<span class="number">4</span>)&#123;</span><br><span class="line">    j = (in[<span class="number">0</span>]&lt;&lt;<span class="number">1</span>) + in[<span class="number">5</span>];</span><br><span class="line">    k = (in[<span class="number">1</span>]&lt;&lt;<span class="number">3</span>) + (in[<span class="number">2</span>]&lt;&lt;<span class="number">2</span>) + (in[<span class="number">3</span>]&lt;&lt;<span class="number">1</span>) + in[<span class="number">4</span>];</span><br><span class="line">    bytetobit(out, &amp;S_BOX[i][j][k], <span class="number">4</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//--------------密码处理 f 函数---------------</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fFunc</span><span class="params">(<span class="keyword">bool</span> in[<span class="number">32</span>], <span class="keyword">const</span> <span class="keyword">bool</span> subkey[<span class="number">48</span>])</span></span>&#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">bool</span> mr[<span class="number">48</span>];</span><br><span class="line">  <span class="comment">// E 扩展置换</span></span><br><span class="line">  tableReplace(mr, in, E_TABLE, <span class="number">48</span>);</span><br><span class="line">  <span class="comment">// 异或操作</span></span><br><span class="line">  xor(mr, subkey, <span class="number">48</span>);</span><br><span class="line">  <span class="comment">// S-盒代替</span></span><br><span class="line">  sFunc(in, mr);</span><br><span class="line">  <span class="comment">// P-盒置换</span></span><br><span class="line">    tableReplace(in, in, P_TABLE, <span class="number">32</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//--------------bite转换byte---------------</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bittobyte</span><span class="params">(<span class="keyword">char</span>* out, <span class="keyword">const</span> <span class="keyword">bool</span>* in, <span class="keyword">int</span> bitslen)</span></span>&#123;</span><br><span class="line">  <span class="built_in">memset</span>(out, <span class="number">0</span>, (bitslen+<span class="number">7</span>)/<span class="number">8</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;bitslen; i++)&#123;</span><br><span class="line">    out[i/<span class="number">8</span>] |= in[i]&lt;&lt;(i%<span class="number">8</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//--------------加密解密处理---------------</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DES</span><span class="params">(<span class="keyword">char</span> out[<span class="number">8</span>], <span class="keyword">char</span> in[<span class="number">8</span>], <span class="keyword">bool</span> mode=encrypt)</span></span>&#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">bool</span> obit[<span class="number">64</span>], temp[<span class="number">32</span>], *li = &amp;obit[<span class="number">0</span>], *ri = &amp;obit[<span class="number">32</span>];</span><br><span class="line"> </span><br><span class="line">  bytetobit(obit, in, <span class="number">64</span>);</span><br><span class="line">  <span class="comment">// 初始置换</span></span><br><span class="line">  tableReplace(obit, obit, IP_TABLE, <span class="number">64</span>);</span><br><span class="line"> 	<span class="comment">// 乘积变换</span></span><br><span class="line">  <span class="keyword">if</span>(mode == encrypt) &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">16</span>; i++)&#123;</span><br><span class="line">      <span class="built_in">memcpy</span>(temp, ri, <span class="number">32</span>);</span><br><span class="line">      fFunc(ri, subKey[i]);</span><br><span class="line">      xor(ri, li, <span class="number">32</span>);</span><br><span class="line">      <span class="built_in">memcpy</span>(li, temp, <span class="number">32</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">15</span>; i&gt;=<span class="number">0</span>; i--)&#123;</span><br><span class="line">      <span class="built_in">memcpy</span>(temp, li, <span class="number">32</span>);</span><br><span class="line">      fFunc(li, subkey[i]);</span><br><span class="line">      xor(li, ri, <span class="number">32</span>);</span><br><span class="line">      <span class="built_in">memcpy</span>(ri, temp, <span class="number">32</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 逆初始置换</span></span><br><span class="line">  tableReplace(obit, obit, IIP_TABLE, <span class="number">64</span>);</span><br><span class="line">  bittobyte(out, obit, <span class="number">64</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="密文解密过程"><a href="#密文解密过程" class="headerlink" title="密文解密过程"></a>密文解密过程</h4><ul>
<li>DES 是一种 16 轮循环的 <strong>Feistel 网络</strong>，在 Feistel 网络中，加密的各个步骤称为轮，整个加密过程就是进行若干次轮的循环；无论是任何轮数、任何轮函数，Feistel 网络都可以用相同的结构实现加密和解密，且加密结果必定能够正确解密。<center><img src="/img/programPearls/encryption/DES_FlowChart.png" width="420px" alt="" /></center></li>
<li>那么，基于 Feistel 网络的 DES 算法如何解密呢？很简单，只要按照逆序来使用子密钥，即输入变成密文，输出则为明文了；<font color="blue">此外，需要注意的是，加密过程的最后一轮存在左右互换（如上图），因此在解密过程中，在进入 Feistel 网络之前需要先将经过初始置换的密文左右互换，完成 $L_{16}$、$R_{16}$ 初始化</font>。</li>
<li>  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// DES 解密</span></span><br><span class="line"><span class="built_in">bitset</span>&lt;64&gt; decrypt(<span class="built_in">bitset</span>&lt;<span class="number">64</span>&gt;&amp; cipher) &#123;</span><br><span class="line">  <span class="built_in">bitset</span>&lt;64&gt; plain;</span><br><span class="line">  <span class="built_in">bitset</span>&lt;64&gt; currentBits;</span><br><span class="line">  <span class="built_in">bitset</span>&lt;32&gt; left;</span><br><span class="line">  <span class="built_in">bitset</span>&lt;32&gt; right;</span><br><span class="line">  <span class="built_in">bitset</span>&lt;32&gt; newLeft;</span><br><span class="line">  <span class="comment">// 第一步：初始置换IP</span></span><br><span class="line">  ...</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 第二步：获取 L16 和 R16</span></span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">32</span>; i&lt;<span class="number">64</span>; ++i)</span><br><span class="line">    left[i<span class="number">-32</span>] = currentBits[i];</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">32</span>; ++i)</span><br><span class="line">    right[i] = currentBits[i];</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 第三步：共16轮迭代（子密钥逆序应用）</span></span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> round=<span class="number">0</span>; round&lt;<span class="number">16</span>; ++round &#123;</span><br><span class="line">    ... subKey[<span class="number">15</span>-round]</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 第四步：合并 L0 和 R0，注意合并为 R0L0</span></span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">32</span>; ++i)</span><br><span class="line">    plain[i] = left[i];</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">32</span>; i&lt;<span class="number">64</span>; ++i)</span><br><span class="line">    plain[i] = right[i<span class="number">-32</span>];</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 第五步：逆初始置换</span></span><br><span class="line">  ...</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 返回明文</span></span><br><span class="line">  <span class="keyword">return</span> plain;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br/></p>
<ul>
<li>虽然 56 位密钥的 DES 算法已经风光不在，而且常有用 DES 加密的明文被破译的报道，但目前 DES 算法得到了广泛的应用，在某些场合，仍然发挥着余热。</li>
</ul>
<h3 id="3DES-算法"><a href="#3DES-算法" class="headerlink" title="3DES 算法"></a>3DES 算法</h3><ul>
<li>3DES 简介<ul>
<li>密码学中，3DES（Triple DES）是三重数据加密算法（Triple Data Encryption Algorithm）块密码的通称，它相当于是对每个数据块应用三次 DES 加密算法。</li>
<li>由于计算机运算能力的增强，原版 DES 密码的密钥长度变得容易被暴力破解；3DES 即是设计用来提供一种相对简单的方法，即通过增加 DES 的密钥长度来避免类似的攻击，而不是设计一种全新的块密码算法。</li>
</ul>
</li>
<li>3DES 加密过程<ul>
<li>加密算法为：密文 = $E_{K_3}(D_{K_2}(E_{K_1}(明文)))$，其中 $E$ 为 DES 加密操作，$D$ 为 DES 解密操作。<center><img src="/img/programPearls/encryption/3DES_Diagram.jpg" width="480px" alt="" /></center></li>
<li>3DES 将密钥长度增至 112 位或 168 位，通过增加迭代次数提高安全性；标准定义了三种密钥选项：<ul>
<li>密钥选项①：三个密钥独立的，强度最高，拥有 3×56=168 个独立的密钥位；</li>
<li>密钥选项②：$K_1$ 和 $K_2$ 是独立的，而 $K_3 = K_1$，安全性稍低，拥有 2×56=112 个独立的密钥位；</li>
<li>密钥选项③：三个密钥均相等，即 $K_1 = K_2 = K_3$，等同于 DES，只有 56 个密钥位，因为第 1 和第 2 次 DES 操作相互抵消了，因此与 DES 兼容。</li>
</ul>
</li>
</ul>
</li>
<li>3DES 解密过程<ul>
<li>解密算法为：明文 = $D_{K_3}(E_{K_2}(D_{K_3}(密文)))$，3DES 的解密过程和加密相反，是以密钥 $K_3$、$K_2$、$K_1$ 的顺序进行解密、加密、解密的操作，即将上图从明文到密文的箭头反过来就是解密的流程。</li>
</ul>
</li>
<li>3DES 是 DES 向 AES 过渡的加密算法，3DES 存在以下缺点：处理速度较慢、密钥计算时间较长，加密效率不高。</li>
</ul>
<h3 id="AES-算法"><a href="#AES-算法" class="headerlink" title="AES 算法"></a>AES 算法</h3><ul>
<li>AES 简介<ul>
<li>对于三种对称密码，DES 因为已经很容易被暴力破解，因此不建议再使用；3DES 目前还被银行等机构使用，但其处理速度不高，而且在安全性方面也逐渐显现出了一些问题；AES 作为最新标准，安全、快速，而且可以在各种平台上工作，可以算是目前最佳的选择。</li>
<li>AES 是取代其前任标准 DES 而成为新标准的一种对称密码算法。AES 最终候选算法名单中，总共有 5 种算法，分别为：MARS、RC6、Rijndael、Serpent、Twofish，最终被选定为 AES 的是 <strong>Rijndael 算法</strong>。<center><img src="/img/programPearls/encryption/AES_FlowChart(De&En).png" width="640px" alt="" /></center></li>
</ul>
</li>
<li>AES 算法（即 Rijndael 算法）是一种对称分组密码算法，数据长度必须是 128bits，使用的密钥长度为 128bits、192bits 或 256bits，对于三种不同长度的 AES 算法，分别称为<strong>“AES-128”</strong>、<strong>“AES-192”</strong>、<strong>“AES-256”</strong>，上图是 AES 加密解密的整体流程图，其中<ul>
<li>状态（State）：密码运算的中间结果称为状态，状态用以字节为基本构成元素的矩阵阵列来表示，该阵列有 4 行，列数记为 $Nb$，Nb = 分组长度（bits）÷32；</li>
<li>密码密钥（Cipher Key）的表示：Cipher Key类似地用一个 4 行的矩阵阵列来表示，列数记为 $Nk$，Nk = 密钥长度（bits）÷32；<center><img src="/img/programPearls/encryption/AES_NbNkNr.png" width="480px" alt="" /></center></li>
<li>$Nr$：加密的轮数，对于不同的密钥长度，轮数不一样，具体如上表。<center><img src="/img/programPearls/encryption/AES_OrganizeMatrix.png" width="480px" alt="" /></center></li>
<li>算法中 16 字节（128bits）、192bits、256bits 的明文、密文和轮密钥以一个 4×4、4×6、4×8 的矩阵表示，组织排列方式如上，以字节为单位。</li>
</ul>
</li>
</ul>
<h4 id="密钥扩展"><a href="#密钥扩展" class="headerlink" title="密钥扩展"></a>密钥扩展</h4><ul>
<li>加解密中每轮的密钥分别由初始密钥扩展得到。密钥 bit 的总数 = 分组长度 ×（轮数 + 1）；字总数 = 分组列数 Nb ×（轮数 Nr + 1）。</li>
<li>AES 算法通过密钥扩展（Key Expansion）将用户输入的密钥 K 扩展生成 <font color="blue">$Nb(Nr+1)$ 个字</font>，存放在一个线性数组<code>w[Nb*(Nr+1)]</code>中，具体如下：<ul>
<li>位置变换（<code>RotWord</code>）：接受一个字 [a0, a1, a2, a3] 作为输入，循环左移一个字节后输出 [a1, a2, a3, a0]；</li>
<li>S-盒变换（<code>SubWord</code>/<code>SubBytes</code>）：S-盒是一个 16×16 的表，其中每一个元素是一个字节；接受一个字 [a0, a1, a2, a3] 的输入，对于输入的每一个字节 ai，前四位 ai[7…4] 组成十六进制数作为行号，后四位 ai[3…0] 组成十六进制数作为列号，查找表中对应的值；最后函数输出 4 个新字节组成的 32-bit 字；</li>
<li>轮常数（<code>Rcon</code>）：直接当做常量数组使用；</li>
<li>扩展密钥数组<code>w[]</code>的前 $Nk$ 个元素就是外部密钥 $K$，以后的元素<code>w[i]</code>等于它的前一个元素<code>w[i-1]</code>与前 $Nk$ 个元素 <code>w[i-Nk]</code>的异或，即 <code>w[i] = w[i-1] XOR w[i-Nk]</code>；但若 $i$ 为 $Nk$ 的倍数，则 <code>w[i] = w[i-Nk] XOR SubWord(RotWord(w[i-1]) XOR Rcon[i/Nk - 1])$</code>。</li>
<li>详细的伪代码如下：<br><img src="/img/programPearls/encryption/AES_KeyExpansionPseudocode.png" width="540px" alt="" /></li>
</ul>
</li>
<li>  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="built_in">bitset</span>&lt;8&gt; byte;</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">bitset</span>&lt;32&gt; word;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Nr = <span class="number">10</span>;  <span class="comment">// AES-128需要 10 轮加密</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Nk = <span class="number">4</span>;   <span class="comment">// Nk 表示输入密钥的 word 个数</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">// S盒</span></span><br><span class="line">byte S_BOX[<span class="number">16</span>][<span class="number">16</span>] = &#123;</span><br><span class="line">  <span class="comment">/*  0    1    2    3    4    5    6    7    8    9    a    b    c    d    e    f */</span></span><br><span class="line">  <span class="number">0x63</span>,<span class="number">0x7c</span>,<span class="number">0x77</span>,<span class="number">0x7b</span>,<span class="number">0xf2</span>,<span class="number">0x6b</span>,<span class="number">0x6f</span>,<span class="number">0xc5</span>,<span class="number">0x30</span>,<span class="number">0x01</span>,<span class="number">0x67</span>,<span class="number">0x2b</span>,<span class="number">0xfe</span>,<span class="number">0xd7</span>,<span class="number">0xab</span>,<span class="number">0x76</span>, <span class="comment">/*0*/</span> </span><br><span class="line">  <span class="number">0xca</span>,<span class="number">0x82</span>,<span class="number">0xc9</span>,<span class="number">0x7d</span>,<span class="number">0xfa</span>,<span class="number">0x59</span>,<span class="number">0x47</span>,<span class="number">0xf0</span>,<span class="number">0xad</span>,<span class="number">0xd4</span>,<span class="number">0xa2</span>,<span class="number">0xaf</span>,<span class="number">0x9c</span>,<span class="number">0xa4</span>,<span class="number">0x72</span>,<span class="number">0xc0</span>, <span class="comment">/*1*/</span></span><br><span class="line">  <span class="number">0xb7</span>,<span class="number">0xfd</span>,<span class="number">0x93</span>,<span class="number">0x26</span>,<span class="number">0x36</span>,<span class="number">0x3f</span>,<span class="number">0xf7</span>,<span class="number">0xcc</span>,<span class="number">0x34</span>,<span class="number">0xa5</span>,<span class="number">0xe5</span>,<span class="number">0xf1</span>,<span class="number">0x71</span>,<span class="number">0xd8</span>,<span class="number">0x31</span>,<span class="number">0x15</span>, <span class="comment">/*2*/</span></span><br><span class="line">  <span class="number">0x04</span>,<span class="number">0xc7</span>,<span class="number">0x23</span>,<span class="number">0xc3</span>,<span class="number">0x18</span>,<span class="number">0x96</span>,<span class="number">0x05</span>,<span class="number">0x9a</span>,<span class="number">0x07</span>,<span class="number">0x12</span>,<span class="number">0x80</span>,<span class="number">0xe2</span>,<span class="number">0xeb</span>,<span class="number">0x27</span>,<span class="number">0xb2</span>,<span class="number">0x75</span>, <span class="comment">/*3*/</span></span><br><span class="line">  <span class="number">0x09</span>,<span class="number">0x83</span>,<span class="number">0x2c</span>,<span class="number">0x1a</span>,<span class="number">0x1b</span>,<span class="number">0x6e</span>,<span class="number">0x5a</span>,<span class="number">0xa0</span>,<span class="number">0x52</span>,<span class="number">0x3b</span>,<span class="number">0xd6</span>,<span class="number">0xb3</span>,<span class="number">0x29</span>,<span class="number">0xe3</span>,<span class="number">0x2f</span>,<span class="number">0x84</span>, <span class="comment">/*4*/</span></span><br><span class="line">  <span class="number">0x53</span>,<span class="number">0xd1</span>,<span class="number">0x00</span>,<span class="number">0xed</span>,<span class="number">0x20</span>,<span class="number">0xfc</span>,<span class="number">0xb1</span>,<span class="number">0x5b</span>,<span class="number">0x6a</span>,<span class="number">0xcb</span>,<span class="number">0xbe</span>,<span class="number">0x39</span>,<span class="number">0x4a</span>,<span class="number">0x4c</span>,<span class="number">0x58</span>,<span class="number">0xcf</span>, <span class="comment">/*5*/</span></span><br><span class="line">  <span class="number">0xd0</span>,<span class="number">0xef</span>,<span class="number">0xaa</span>,<span class="number">0xfb</span>,<span class="number">0x43</span>,<span class="number">0x4d</span>,<span class="number">0x33</span>,<span class="number">0x85</span>,<span class="number">0x45</span>,<span class="number">0xf9</span>,<span class="number">0x02</span>,<span class="number">0x7f</span>,<span class="number">0x50</span>,<span class="number">0x3c</span>,<span class="number">0x9f</span>,<span class="number">0xa8</span>, <span class="comment">/*6*/</span> </span><br><span class="line">  <span class="number">0x51</span>,<span class="number">0xa3</span>,<span class="number">0x40</span>,<span class="number">0x8f</span>,<span class="number">0x92</span>,<span class="number">0x9d</span>,<span class="number">0x38</span>,<span class="number">0xf5</span>,<span class="number">0xbc</span>,<span class="number">0xb6</span>,<span class="number">0xda</span>,<span class="number">0x21</span>,<span class="number">0x10</span>,<span class="number">0xff</span>,<span class="number">0xf3</span>,<span class="number">0xd2</span>, <span class="comment">/*7*/</span></span><br><span class="line">  <span class="number">0xcd</span>,<span class="number">0x0c</span>,<span class="number">0x13</span>,<span class="number">0xec</span>,<span class="number">0x5f</span>,<span class="number">0x97</span>,<span class="number">0x44</span>,<span class="number">0x17</span>,<span class="number">0xc4</span>,<span class="number">0xa7</span>,<span class="number">0x7e</span>,<span class="number">0x3d</span>,<span class="number">0x64</span>,<span class="number">0x5d</span>,<span class="number">0x19</span>,<span class="number">0x73</span>, <span class="comment">/*8*/</span></span><br><span class="line">  <span class="number">0x60</span>,<span class="number">0x81</span>,<span class="number">0x4f</span>,<span class="number">0xdc</span>,<span class="number">0x22</span>,<span class="number">0x2a</span>,<span class="number">0x90</span>,<span class="number">0x88</span>,<span class="number">0x46</span>,<span class="number">0xee</span>,<span class="number">0xb8</span>,<span class="number">0x14</span>,<span class="number">0xde</span>,<span class="number">0x5e</span>,<span class="number">0x0b</span>,<span class="number">0xdb</span>, <span class="comment">/*9*/</span></span><br><span class="line">  <span class="number">0xe0</span>,<span class="number">0x32</span>,<span class="number">0x3a</span>,<span class="number">0x0a</span>,<span class="number">0x49</span>,<span class="number">0x06</span>,<span class="number">0x24</span>,<span class="number">0x5c</span>,<span class="number">0xc2</span>,<span class="number">0xd3</span>,<span class="number">0xac</span>,<span class="number">0x62</span>,<span class="number">0x91</span>,<span class="number">0x95</span>,<span class="number">0xe4</span>,<span class="number">0x79</span>, <span class="comment">/*a*/</span></span><br><span class="line">  <span class="number">0xe7</span>,<span class="number">0xc8</span>,<span class="number">0x37</span>,<span class="number">0x6d</span>,<span class="number">0x8d</span>,<span class="number">0xd5</span>,<span class="number">0x4e</span>,<span class="number">0xa9</span>,<span class="number">0x6c</span>,<span class="number">0x56</span>,<span class="number">0xf4</span>,<span class="number">0xea</span>,<span class="number">0x65</span>,<span class="number">0x7a</span>,<span class="number">0xae</span>,<span class="number">0x08</span>, <span class="comment">/*b*/</span></span><br><span class="line">  <span class="number">0xba</span>,<span class="number">0x78</span>,<span class="number">0x25</span>,<span class="number">0x2e</span>,<span class="number">0x1c</span>,<span class="number">0xa6</span>,<span class="number">0xb4</span>,<span class="number">0xc6</span>,<span class="number">0xe8</span>,<span class="number">0xdd</span>,<span class="number">0x74</span>,<span class="number">0x1f</span>,<span class="number">0x4b</span>,<span class="number">0xbd</span>,<span class="number">0x8b</span>,<span class="number">0x8a</span>, <span class="comment">/*c*/</span></span><br><span class="line">  <span class="number">0x70</span>,<span class="number">0x3e</span>,<span class="number">0xb5</span>,<span class="number">0x66</span>,<span class="number">0x48</span>,<span class="number">0x03</span>,<span class="number">0xf6</span>,<span class="number">0x0e</span>,<span class="number">0x61</span>,<span class="number">0x35</span>,<span class="number">0x57</span>,<span class="number">0xb9</span>,<span class="number">0x86</span>,<span class="number">0xc1</span>,<span class="number">0x1d</span>,<span class="number">0x9e</span>, <span class="comment">/*d*/</span></span><br><span class="line">  <span class="number">0xe1</span>,<span class="number">0xf8</span>,<span class="number">0x98</span>,<span class="number">0x11</span>,<span class="number">0x69</span>,<span class="number">0xd9</span>,<span class="number">0x8e</span>,<span class="number">0x94</span>,<span class="number">0x9b</span>,<span class="number">0x1e</span>,<span class="number">0x87</span>,<span class="number">0xe9</span>,<span class="number">0xce</span>,<span class="number">0x55</span>,<span class="number">0x28</span>,<span class="number">0xdf</span>, <span class="comment">/*e*/</span></span><br><span class="line">  <span class="number">0x8c</span>,<span class="number">0xa1</span>,<span class="number">0x89</span>,<span class="number">0x0d</span>,<span class="number">0xbf</span>,<span class="number">0xe6</span>,<span class="number">0x42</span>,<span class="number">0x68</span>,<span class="number">0x41</span>,<span class="number">0x99</span>,<span class="number">0x2d</span>,<span class="number">0x0f</span>,<span class="number">0xb0</span>,<span class="number">0x54</span>,<span class="number">0xbb</span>,<span class="number">0x16</span>  <span class="comment">/*f*/</span></span><br><span class="line">&#125;;</span><br><span class="line">  </span><br><span class="line"><span class="comment">// 将4个 byte 转换为一个 word.</span></span><br><span class="line"><span class="function">word <span class="title">Word</span><span class="params">(byte&amp; k1, byte&amp; k2, byte&amp; k3, byte&amp; k4)</span> </span>&#123;</span><br><span class="line">  <span class="function">word <span class="title">result</span><span class="params">(<span class="number">0x00000000</span>)</span></span>;</span><br><span class="line">  word temp;</span><br><span class="line">  temp = k1.to_ulong();  <span class="comment">// K1</span></span><br><span class="line">  temp &lt;&lt;= <span class="number">24</span>;</span><br><span class="line">  result |= temp;</span><br><span class="line">  temp = k2.to_ulong();  <span class="comment">// K2</span></span><br><span class="line">  temp &lt;&lt;= <span class="number">16</span>;</span><br><span class="line">  result |= temp;</span><br><span class="line">  temp = k3.to_ulong();  <span class="comment">// K3</span></span><br><span class="line">  temp &lt;&lt;= <span class="number">8</span>;</span><br><span class="line">  result |= temp;</span><br><span class="line">  temp = k4.to_ulong();  <span class="comment">// K4</span></span><br><span class="line">  result |= temp;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  按字节 循环左移一位</span></span><br><span class="line"><span class="comment"> *  即把[a0, a1, a2, a3]变成[a1, a2, a3, a0]</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function">word <span class="title">RotWord</span><span class="params">(word&amp; rw)</span> </span>&#123;</span><br><span class="line">  word high = rw &lt;&lt; <span class="number">8</span>;</span><br><span class="line">  word low = rw &gt;&gt; <span class="number">24</span>;</span><br><span class="line">  <span class="keyword">return</span> high | low;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  对输入word中的每一个字节进行S-盒变换</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function">word <span class="title">SubWord</span><span class="params">(word&amp; sw)</span> </span>&#123;</span><br><span class="line">  word temp;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">32</span>; i+=<span class="number">8</span>) &#123;</span><br><span class="line">    <span class="keyword">int</span> row = sw[i+<span class="number">7</span>]*<span class="number">8</span> + sw[i+<span class="number">6</span>]*<span class="number">4</span> + sw[i+<span class="number">5</span>]*<span class="number">2</span> + sw[i+<span class="number">4</span>];</span><br><span class="line">    <span class="keyword">int</span> col = sw[i+<span class="number">3</span>]*<span class="number">8</span> + sw[i+<span class="number">2</span>]*<span class="number">4</span> + sw[i+<span class="number">1</span>]*<span class="number">2</span> + sw[i];</span><br><span class="line">    byte val = S_Box[row][col];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>; j&lt;<span class="number">8</span>; ++j)</span><br><span class="line">      temp[i+j] = val[j];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> temp;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  密钥扩展函数 - 对Nk-word密钥进行扩展得到 w[4*(Nr+1)]</span></span><br><span class="line"><span class="comment"> */</span> </span><br><span class="line">void KeyExpansion(byte key[4*Nk], word w[4*(Nr+1)])</span><br><span class="line">&#123;</span><br><span class="line">  word temp;</span><br><span class="line">  <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">  <span class="comment">// w[]的前4个就是输入的key</span></span><br><span class="line">  <span class="keyword">while</span>(i &lt; Nk) &#123;</span><br><span class="line">    w[i] = Word(key[<span class="number">4</span>*i], key[<span class="number">4</span>*i+<span class="number">1</span>], key[<span class="number">4</span>*i+<span class="number">2</span>], key[<span class="number">4</span>*i+<span class="number">3</span>]);</span><br><span class="line">    ++i;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  i = Nk;</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">while</span>(i &lt; <span class="number">4</span>*(Nr+<span class="number">1</span>))&#123;</span><br><span class="line">    temp = w[i<span class="number">-1</span>]; <span class="comment">// 记录前一个word</span></span><br><span class="line">    <span class="keyword">if</span>(i % Nk == <span class="number">0</span>)</span><br><span class="line">      w[i] = w[i-Nk] ^ SubWord(RotWord(temp)) ^ Rcon[i/Nk<span class="number">-1</span>];</span><br><span class="line">    <span class="keyword">else</span> </span><br><span class="line">      w[i] = w[i-Nk] ^ temp;</span><br><span class="line">    ++i;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li>从扩展密钥中取出轮密钥：第一个轮密钥由扩展密钥的第一个 $Nb$ 个字（4 字节），第二个轮密钥由接下来的 $Nb$ 个字组成，一次类推。<h4 id="加密过程"><a href="#加密过程" class="headerlink" title="加密过程"></a>加密过程</h4></li>
<li>依据本节开头的 AES 流程图可以得到下图的伪代码：<br>  <center><img src="/img/programPearls/encryption/AES_CipherPseudocode.png" width="640px" alt="" /></center><ul>
<li>从伪代码描述中可以看出，AES 加密时主要涉及以下几个步骤<ul>
<li>字节替换（SubBytes） 就是根据一张替换表（S-Box），将输入中每个字节的值替换成另一个字节的值，在密钥扩展部分已经介绍了；</li>
<li>行移位（ShiftRows） 即将 SubBytes 的输出以字节为单位进行打乱出路，这种打乱处理也是有规律的：通过作用于行上的循环左移，第 0 行不变，第 1 行循环移位 $C1$ 字节，第 2 行循环移位 $C2$ 字节，第 3 行循环移位 $C3$ 字节，如下图：<center><img src="/img/programPearls/encryption/AES_ShiftRows.png" width="540px" alt="" /></center><br>$\quad$ 偏移量 $C1$、$C2$、$C3$ 与分组长度 $Nb$ 有关，如下表所示：<br><center><img src="/img/programPearls/encryption/AES_ShiftRowsTable.png" width="280px" alt="" /></center></li>
<li>列混淆（MixColumns） 即对一个 4 字节的值进行变换，将其变成另外一个 4 字节的值，变换方式如下：<br><center><img src="/img/programPearls/encryption/AES_MixColumns.png" width="540px" alt="" /></center><br>$\quad$ <font color="red">注意公式中用到的乘法是伽罗华域（$GF(2^8)$，有限域）上的乘法</font>。</li>
<li>轮密钥加（AddRoundKey） ：扩展密钥只参与了这一步，就是将 MixColumns 的输出与轮密钥进行按位 XOR 处理，至此，一轮就结束了。</li>
</ul>
</li>
</ul>
</li>
<li>  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="built_in">bitset</span>&lt;8&gt; byte;</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">bitset</span>&lt;32&gt; word;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Nr = <span class="number">10</span>;  <span class="comment">// AES-128需要 10 轮加密</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Nk = <span class="number">4</span>;   <span class="comment">// Nk 表示输入密钥的 word 个数</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">// S盒</span></span><br><span class="line">byte S_BOX[<span class="number">16</span>][<span class="number">16</span>] = &#123;</span><br><span class="line">  <span class="comment">/*  0    1    2    3    4    5    6    7    8    9    a    b    c    d    e    f */</span></span><br><span class="line">  <span class="number">0x63</span>,<span class="number">0x7c</span>,<span class="number">0x77</span>,<span class="number">0x7b</span>,<span class="number">0xf2</span>,<span class="number">0x6b</span>,<span class="number">0x6f</span>,<span class="number">0xc5</span>,<span class="number">0x30</span>,<span class="number">0x01</span>,<span class="number">0x67</span>,<span class="number">0x2b</span>,<span class="number">0xfe</span>,<span class="number">0xd7</span>,<span class="number">0xab</span>,<span class="number">0x76</span>, <span class="comment">/*0*/</span> </span><br><span class="line">  <span class="number">0xca</span>,<span class="number">0x82</span>,<span class="number">0xc9</span>,<span class="number">0x7d</span>,<span class="number">0xfa</span>,<span class="number">0x59</span>,<span class="number">0x47</span>,<span class="number">0xf0</span>,<span class="number">0xad</span>,<span class="number">0xd4</span>,<span class="number">0xa2</span>,<span class="number">0xaf</span>,<span class="number">0x9c</span>,<span class="number">0xa4</span>,<span class="number">0x72</span>,<span class="number">0xc0</span>, <span class="comment">/*1*/</span></span><br><span class="line">  <span class="number">0xb7</span>,<span class="number">0xfd</span>,<span class="number">0x93</span>,<span class="number">0x26</span>,<span class="number">0x36</span>,<span class="number">0x3f</span>,<span class="number">0xf7</span>,<span class="number">0xcc</span>,<span class="number">0x34</span>,<span class="number">0xa5</span>,<span class="number">0xe5</span>,<span class="number">0xf1</span>,<span class="number">0x71</span>,<span class="number">0xd8</span>,<span class="number">0x31</span>,<span class="number">0x15</span>, <span class="comment">/*2*/</span></span><br><span class="line">  <span class="number">0x04</span>,<span class="number">0xc7</span>,<span class="number">0x23</span>,<span class="number">0xc3</span>,<span class="number">0x18</span>,<span class="number">0x96</span>,<span class="number">0x05</span>,<span class="number">0x9a</span>,<span class="number">0x07</span>,<span class="number">0x12</span>,<span class="number">0x80</span>,<span class="number">0xe2</span>,<span class="number">0xeb</span>,<span class="number">0x27</span>,<span class="number">0xb2</span>,<span class="number">0x75</span>, <span class="comment">/*3*/</span></span><br><span class="line">  <span class="number">0x09</span>,<span class="number">0x83</span>,<span class="number">0x2c</span>,<span class="number">0x1a</span>,<span class="number">0x1b</span>,<span class="number">0x6e</span>,<span class="number">0x5a</span>,<span class="number">0xa0</span>,<span class="number">0x52</span>,<span class="number">0x3b</span>,<span class="number">0xd6</span>,<span class="number">0xb3</span>,<span class="number">0x29</span>,<span class="number">0xe3</span>,<span class="number">0x2f</span>,<span class="number">0x84</span>, <span class="comment">/*4*/</span></span><br><span class="line">  <span class="number">0x53</span>,<span class="number">0xd1</span>,<span class="number">0x00</span>,<span class="number">0xed</span>,<span class="number">0x20</span>,<span class="number">0xfc</span>,<span class="number">0xb1</span>,<span class="number">0x5b</span>,<span class="number">0x6a</span>,<span class="number">0xcb</span>,<span class="number">0xbe</span>,<span class="number">0x39</span>,<span class="number">0x4a</span>,<span class="number">0x4c</span>,<span class="number">0x58</span>,<span class="number">0xcf</span>, <span class="comment">/*5*/</span></span><br><span class="line">  <span class="number">0xd0</span>,<span class="number">0xef</span>,<span class="number">0xaa</span>,<span class="number">0xfb</span>,<span class="number">0x43</span>,<span class="number">0x4d</span>,<span class="number">0x33</span>,<span class="number">0x85</span>,<span class="number">0x45</span>,<span class="number">0xf9</span>,<span class="number">0x02</span>,<span class="number">0x7f</span>,<span class="number">0x50</span>,<span class="number">0x3c</span>,<span class="number">0x9f</span>,<span class="number">0xa8</span>, <span class="comment">/*6*/</span> </span><br><span class="line">  <span class="number">0x51</span>,<span class="number">0xa3</span>,<span class="number">0x40</span>,<span class="number">0x8f</span>,<span class="number">0x92</span>,<span class="number">0x9d</span>,<span class="number">0x38</span>,<span class="number">0xf5</span>,<span class="number">0xbc</span>,<span class="number">0xb6</span>,<span class="number">0xda</span>,<span class="number">0x21</span>,<span class="number">0x10</span>,<span class="number">0xff</span>,<span class="number">0xf3</span>,<span class="number">0xd2</span>, <span class="comment">/*7*/</span></span><br><span class="line">  <span class="number">0xcd</span>,<span class="number">0x0c</span>,<span class="number">0x13</span>,<span class="number">0xec</span>,<span class="number">0x5f</span>,<span class="number">0x97</span>,<span class="number">0x44</span>,<span class="number">0x17</span>,<span class="number">0xc4</span>,<span class="number">0xa7</span>,<span class="number">0x7e</span>,<span class="number">0x3d</span>,<span class="number">0x64</span>,<span class="number">0x5d</span>,<span class="number">0x19</span>,<span class="number">0x73</span>, <span class="comment">/*8*/</span></span><br><span class="line">  <span class="number">0x60</span>,<span class="number">0x81</span>,<span class="number">0x4f</span>,<span class="number">0xdc</span>,<span class="number">0x22</span>,<span class="number">0x2a</span>,<span class="number">0x90</span>,<span class="number">0x88</span>,<span class="number">0x46</span>,<span class="number">0xee</span>,<span class="number">0xb8</span>,<span class="number">0x14</span>,<span class="number">0xde</span>,<span class="number">0x5e</span>,<span class="number">0x0b</span>,<span class="number">0xdb</span>, <span class="comment">/*9*/</span></span><br><span class="line">  <span class="number">0xe0</span>,<span class="number">0x32</span>,<span class="number">0x3a</span>,<span class="number">0x0a</span>,<span class="number">0x49</span>,<span class="number">0x06</span>,<span class="number">0x24</span>,<span class="number">0x5c</span>,<span class="number">0xc2</span>,<span class="number">0xd3</span>,<span class="number">0xac</span>,<span class="number">0x62</span>,<span class="number">0x91</span>,<span class="number">0x95</span>,<span class="number">0xe4</span>,<span class="number">0x79</span>, <span class="comment">/*a*/</span></span><br><span class="line">  <span class="number">0xe7</span>,<span class="number">0xc8</span>,<span class="number">0x37</span>,<span class="number">0x6d</span>,<span class="number">0x8d</span>,<span class="number">0xd5</span>,<span class="number">0x4e</span>,<span class="number">0xa9</span>,<span class="number">0x6c</span>,<span class="number">0x56</span>,<span class="number">0xf4</span>,<span class="number">0xea</span>,<span class="number">0x65</span>,<span class="number">0x7a</span>,<span class="number">0xae</span>,<span class="number">0x08</span>, <span class="comment">/*b*/</span></span><br><span class="line">  <span class="number">0xba</span>,<span class="number">0x78</span>,<span class="number">0x25</span>,<span class="number">0x2e</span>,<span class="number">0x1c</span>,<span class="number">0xa6</span>,<span class="number">0xb4</span>,<span class="number">0xc6</span>,<span class="number">0xe8</span>,<span class="number">0xdd</span>,<span class="number">0x74</span>,<span class="number">0x1f</span>,<span class="number">0x4b</span>,<span class="number">0xbd</span>,<span class="number">0x8b</span>,<span class="number">0x8a</span>, <span class="comment">/*c*/</span></span><br><span class="line">  <span class="number">0x70</span>,<span class="number">0x3e</span>,<span class="number">0xb5</span>,<span class="number">0x66</span>,<span class="number">0x48</span>,<span class="number">0x03</span>,<span class="number">0xf6</span>,<span class="number">0x0e</span>,<span class="number">0x61</span>,<span class="number">0x35</span>,<span class="number">0x57</span>,<span class="number">0xb9</span>,<span class="number">0x86</span>,<span class="number">0xc1</span>,<span class="number">0x1d</span>,<span class="number">0x9e</span>, <span class="comment">/*d*/</span></span><br><span class="line">  <span class="number">0xe1</span>,<span class="number">0xf8</span>,<span class="number">0x98</span>,<span class="number">0x11</span>,<span class="number">0x69</span>,<span class="number">0xd9</span>,<span class="number">0x8e</span>,<span class="number">0x94</span>,<span class="number">0x9b</span>,<span class="number">0x1e</span>,<span class="number">0x87</span>,<span class="number">0xe9</span>,<span class="number">0xce</span>,<span class="number">0x55</span>,<span class="number">0x28</span>,<span class="number">0xdf</span>, <span class="comment">/*e*/</span></span><br><span class="line">  <span class="number">0x8c</span>,<span class="number">0xa1</span>,<span class="number">0x89</span>,<span class="number">0x0d</span>,<span class="number">0xbf</span>,<span class="number">0xe6</span>,<span class="number">0x42</span>,<span class="number">0x68</span>,<span class="number">0x41</span>,<span class="number">0x99</span>,<span class="number">0x2d</span>,<span class="number">0x0f</span>,<span class="number">0xb0</span>,<span class="number">0x54</span>,<span class="number">0xbb</span>,<span class="number">0x16</span>  <span class="comment">/*f*/</span></span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// S盒变换 -每个字节前4位为行号，后4位为列号</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SubBytes</span><span class="params">(byte mtx[<span class="number">4</span>*<span class="number">4</span>])</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">16</span>; ++i) &#123;</span><br><span class="line">    <span class="keyword">int</span> row = mtx[i][<span class="number">7</span>]*<span class="number">8</span> + mtx[i][<span class="number">6</span>]*<span class="number">4</span> + mtx[i][<span class="number">5</span>]*<span class="number">2</span> + mtx[i][<span class="number">4</span>];</span><br><span class="line">    <span class="keyword">int</span> col = mtx[i][<span class="number">3</span>]*<span class="number">8</span> + mtx[i][<span class="number">2</span>]*<span class="number">4</span> + mtx[i][<span class="number">1</span>]*<span class="number">2</span> + mtx[i][<span class="number">0</span>];</span><br><span class="line">    mtx[i] = S_Box[row][col];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 行变换 - 按字节循环移位</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ShiftRows</span><span class="params">(byte mtx[<span class="number">4</span>*<span class="number">4</span>])</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 第二行循环左移一位</span></span><br><span class="line">  byte temp = mtx[<span class="number">4</span>];</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">3</span>; ++i)</span><br><span class="line">    mtx[i+<span class="number">4</span>] = mtx[i+<span class="number">5</span>];</span><br><span class="line">  mtx[<span class="number">7</span>] = temp;</span><br><span class="line">  <span class="comment">// 第三行循环左移两位</span></span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">2</span>; ++i) &#123;</span><br><span class="line">    temp = mtx[i+<span class="number">8</span>];</span><br><span class="line">    mtx[i+<span class="number">8</span>] = mtx[i+<span class="number">10</span>];</span><br><span class="line">    mtx[i+<span class="number">10</span>] = temp;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 第四行循环左移三位</span></span><br><span class="line">  temp = mtx[<span class="number">15</span>];</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">3</span>; i&gt;<span class="number">0</span>; --i)</span><br><span class="line">    mtx[i+<span class="number">12</span>] = mtx[i+<span class="number">11</span>];</span><br><span class="line">  mtx[<span class="number">12</span>] = temp;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 有限域上的乘法 GF(2^8)</span></span><br><span class="line"><span class="function">byte <span class="title">GFMul</span><span class="params">(byte a, byte b)</span> </span>&#123; </span><br><span class="line">  byte p = <span class="number">0</span>;</span><br><span class="line">  byte hi_bit_set;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> counter = <span class="number">0</span>; counter &lt; <span class="number">8</span>; counter++) &#123;</span><br><span class="line">    <span class="keyword">if</span> ((b &amp; byte(<span class="number">1</span>)) != <span class="number">0</span>) &#123;</span><br><span class="line">      p ^= a;</span><br><span class="line">    &#125;</span><br><span class="line">    hi_bit_set = (byte) (a &amp; byte(<span class="number">0x80</span>));</span><br><span class="line">    a &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (hi_bit_set != <span class="number">0</span>) &#123;</span><br><span class="line">      a ^= <span class="number">0x1b</span>; <span class="comment">/* x^8 + x^4 + x^3 + x + 1 */</span></span><br><span class="line">    &#125;</span><br><span class="line">    b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 列混淆</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">MixColumns</span><span class="params">(byte mtx[<span class="number">4</span>*<span class="number">4</span>])</span> </span>&#123;</span><br><span class="line">  byte arr[<span class="number">4</span>];</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">4</span>; ++i) &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>; j&lt;<span class="number">4</span>; ++j)</span><br><span class="line">      arr[j] = mtx[i+j*<span class="number">4</span>];</span><br><span class="line"> </span><br><span class="line">    mtx[i] = GFMul(<span class="number">0x02</span>, arr[<span class="number">0</span>]) ^ GFMul(<span class="number">0x03</span>, arr[<span class="number">1</span>]) ^ arr[<span class="number">2</span>] ^ arr[<span class="number">3</span>];</span><br><span class="line">    mtx[i+<span class="number">4</span>] = arr[<span class="number">0</span>] ^ GFMul(<span class="number">0x02</span>, arr[<span class="number">1</span>]) ^ GFMul(<span class="number">0x03</span>, arr[<span class="number">2</span>]) ^ arr[<span class="number">3</span>];</span><br><span class="line">    mtx[i+<span class="number">8</span>] = arr[<span class="number">0</span>] ^ arr[<span class="number">1</span>] ^ GFMul(<span class="number">0x02</span>, arr[<span class="number">2</span>]) ^ GFMul(<span class="number">0x03</span>, arr[<span class="number">3</span>]);</span><br><span class="line">    mtx[i+<span class="number">12</span>] = GFMul(<span class="number">0x03</span>, arr[<span class="number">0</span>]) ^ arr[<span class="number">1</span>] ^ arr[<span class="number">2</span>] ^ GFMul(<span class="number">0x02</span>, arr[<span class="number">3</span>]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 轮密钥加变换 - 将每一列与扩展密钥进行异或</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">AddRoundKey</span><span class="params">(byte mtx[<span class="number">4</span>*<span class="number">4</span>], word k[<span class="number">4</span>])</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">4</span>; ++i) &#123;</span><br><span class="line">    word k1 = k[i] &gt;&gt; <span class="number">24</span>;</span><br><span class="line">    word k2 = (k[i] &lt;&lt; <span class="number">8</span>) &gt;&gt; <span class="number">24</span>;</span><br><span class="line">    word k3 = (k[i] &lt;&lt; <span class="number">16</span>) &gt;&gt; <span class="number">24</span>;</span><br><span class="line">    word k4 = (k[i] &lt;&lt; <span class="number">24</span>) &gt;&gt; <span class="number">24</span>;</span><br><span class="line">    </span><br><span class="line">    mtx[i] = mtx[i] ^ byte(k1.to_ulong());</span><br><span class="line">    mtx[i+<span class="number">4</span>] = mtx[i+<span class="number">4</span>] ^ byte(k2.to_ulong());</span><br><span class="line">    mtx[i+<span class="number">8</span>] = mtx[i+<span class="number">8</span>] ^ byte(k3.to_ulong());</span><br><span class="line">    mtx[i+<span class="number">12</span>] = mtx[i+<span class="number">12</span>] ^ byte(k4.to_ulong());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 加密</span></span><br><span class="line">void encrypt(byte in[4*4], word w[4*(Nr+1)]) &#123;</span><br><span class="line">  word key[<span class="number">4</span>];</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">4</span>; ++i)</span><br><span class="line">    key[i] = w[i];</span><br><span class="line">  AddRoundKey(in, key);</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> round=<span class="number">1</span>; round&lt;Nr; ++round)&#123;</span><br><span class="line">    SubBytes(in);</span><br><span class="line">    ShiftRows(in);</span><br><span class="line">    MixColumns(in);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">4</span>; ++i)</span><br><span class="line">      key[i] = w[<span class="number">4</span>*round+i];</span><br><span class="line">    AddRoundKey(in, key);</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  SubBytes(in);</span><br><span class="line">  ShiftRows(in);</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">4</span>; ++i)</span><br><span class="line">    key[i] = w[<span class="number">4</span>*Nr+i];</span><br><span class="line">  AddRoundKey(in, key);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="解密过程"><a href="#解密过程" class="headerlink" title="解密过程"></a>解密过程</h4><ul>
<li>①AES 使用的并不是 Feistel 网络，而是 SPN 结构，加密时的 SubBytes、ShiftRows、MixColumns，解密时分别为反向运算的 InvSubBytes、InvShiftRows、InvMixColumns，这是因为 SPN 结构不像 Feistel 网络一样能够用一种结构实现加密和解密；②加解密所有操作的顺序正好是相反的；正是这两点，保证了解密能够正确地恢复明文。</li>
<li>依据本节开头的 AES 流程图可以得到下图的伪代码：<br>  <center><img src="/img/programPearls/encryption/AES_InvCipherPseudocode.png" width="640px" alt="" /></center><ul>
<li>从伪代码描述中可以看出，AES 解密时主要涉及以下几个步骤<ul>
<li>逆行移位（InvShiftRows）：加密时是对矩阵每一行进行循环左移，所以解密时的 InvShiftRows 操作是对矩阵每一行进行循环右移；</li>
<li>逆字节替换（InvSubBytes）：与加密时的字节替换一样也是查表，查表的方式也一样，只不过查的是另外一张表，S-Box 的逆表；</li>
<li>逆列混淆（MixColumns）：与加密时的列混淆一样，只不过变换公式中的系数矩阵发生了变化，如下图：<center><img src="/img/programPearls/encryption/AES_InvMixColumns.png" width="640px" alt="" /></center></li>
<li>轮密钥加（AddRoundKey） ：与加密时的操作一致。</li>
</ul>
</li>
</ul>
</li>
<li>  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="built_in">bitset</span>&lt;8&gt; byte;</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">bitset</span>&lt;32&gt; word;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Nr = <span class="number">10</span>;  <span class="comment">// AES-128需要 10 轮加密</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Nk = <span class="number">4</span>;   <span class="comment">// Nk 表示输入密钥的 word 个数</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">// S-盒逆表</span></span><br><span class="line">byte INV_S_BOX[<span class="number">16</span>][<span class="number">16</span>] = &#123;</span><br><span class="line">  <span class="comment">/*  0    1    2    3    4    5    6    7    8    9    a    b    c    d    e    f  */</span> </span><br><span class="line">  <span class="number">0x52</span>,<span class="number">0x09</span>,<span class="number">0x6a</span>,<span class="number">0xd5</span>,<span class="number">0x30</span>,<span class="number">0x36</span>,<span class="number">0xa5</span>,<span class="number">0x38</span>,<span class="number">0xbf</span>,<span class="number">0x40</span>,<span class="number">0xa3</span>,<span class="number">0x9e</span>,<span class="number">0x81</span>,<span class="number">0xf3</span>,<span class="number">0xd7</span>,<span class="number">0xfb</span>, <span class="comment">/*0*/</span></span><br><span class="line">  <span class="number">0x7c</span>,<span class="number">0xe3</span>,<span class="number">0x39</span>,<span class="number">0x82</span>,<span class="number">0x9b</span>,<span class="number">0x2f</span>,<span class="number">0xff</span>,<span class="number">0x87</span>,<span class="number">0x34</span>,<span class="number">0x8e</span>,<span class="number">0x43</span>,<span class="number">0x44</span>,<span class="number">0xc4</span>,<span class="number">0xde</span>,<span class="number">0xe9</span>,<span class="number">0xcb</span>, <span class="comment">/*1*/</span></span><br><span class="line">  <span class="number">0x54</span>,<span class="number">0x7b</span>,<span class="number">0x94</span>,<span class="number">0x32</span>,<span class="number">0xa6</span>,<span class="number">0xc2</span>,<span class="number">0x23</span>,<span class="number">0x3d</span>,<span class="number">0xee</span>,<span class="number">0x4c</span>,<span class="number">0x95</span>,<span class="number">0x0b</span>,<span class="number">0x42</span>,<span class="number">0xfa</span>,<span class="number">0xc3</span>,<span class="number">0x4e</span>, <span class="comment">/*2*/</span></span><br><span class="line">  <span class="number">0x08</span>,<span class="number">0x2e</span>,<span class="number">0xa1</span>,<span class="number">0x66</span>,<span class="number">0x28</span>,<span class="number">0xd9</span>,<span class="number">0x24</span>,<span class="number">0xb2</span>,<span class="number">0x76</span>,<span class="number">0x5b</span>,<span class="number">0xa2</span>,<span class="number">0x49</span>,<span class="number">0x6d</span>,<span class="number">0x8b</span>,<span class="number">0xd1</span>,<span class="number">0x25</span>, <span class="comment">/*3*/</span></span><br><span class="line">  <span class="number">0x72</span>,<span class="number">0xf8</span>,<span class="number">0xf6</span>,<span class="number">0x64</span>,<span class="number">0x86</span>,<span class="number">0x68</span>,<span class="number">0x98</span>,<span class="number">0x16</span>,<span class="number">0xd4</span>,<span class="number">0xa4</span>,<span class="number">0x5c</span>,<span class="number">0xcc</span>,<span class="number">0x5d</span>,<span class="number">0x65</span>,<span class="number">0xb6</span>,<span class="number">0x92</span>, <span class="comment">/*4*/</span></span><br><span class="line">  <span class="number">0x6c</span>,<span class="number">0x70</span>,<span class="number">0x48</span>,<span class="number">0x50</span>,<span class="number">0xfd</span>,<span class="number">0xed</span>,<span class="number">0xb9</span>,<span class="number">0xda</span>,<span class="number">0x5e</span>,<span class="number">0x15</span>,<span class="number">0x46</span>,<span class="number">0x57</span>,<span class="number">0xa7</span>,<span class="number">0x8d</span>,<span class="number">0x9d</span>,<span class="number">0x84</span>, <span class="comment">/*5*/</span></span><br><span class="line">  <span class="number">0x90</span>,<span class="number">0xd8</span>,<span class="number">0xab</span>,<span class="number">0x00</span>,<span class="number">0x8c</span>,<span class="number">0xbc</span>,<span class="number">0xd3</span>,<span class="number">0x0a</span>,<span class="number">0xf7</span>,<span class="number">0xe4</span>,<span class="number">0x58</span>,<span class="number">0x05</span>,<span class="number">0xb8</span>,<span class="number">0xb3</span>,<span class="number">0x45</span>,<span class="number">0x06</span>, <span class="comment">/*6*/</span></span><br><span class="line">  <span class="number">0xd0</span>,<span class="number">0x2c</span>,<span class="number">0x1e</span>,<span class="number">0x8f</span>,<span class="number">0xca</span>,<span class="number">0x3f</span>,<span class="number">0x0f</span>,<span class="number">0x02</span>,<span class="number">0xc1</span>,<span class="number">0xaf</span>,<span class="number">0xbd</span>,<span class="number">0x03</span>,<span class="number">0x01</span>,<span class="number">0x13</span>,<span class="number">0x8a</span>,<span class="number">0x6b</span>, <span class="comment">/*7*/</span></span><br><span class="line">  <span class="number">0x3a</span>,<span class="number">0x91</span>,<span class="number">0x11</span>,<span class="number">0x41</span>,<span class="number">0x4f</span>,<span class="number">0x67</span>,<span class="number">0xdc</span>,<span class="number">0xea</span>,<span class="number">0x97</span>,<span class="number">0xf2</span>,<span class="number">0xcf</span>,<span class="number">0xce</span>,<span class="number">0xf0</span>,<span class="number">0xb4</span>,<span class="number">0xe6</span>,<span class="number">0x73</span>, <span class="comment">/*8*/</span></span><br><span class="line">  <span class="number">0x96</span>,<span class="number">0xac</span>,<span class="number">0x74</span>,<span class="number">0x22</span>,<span class="number">0xe7</span>,<span class="number">0xad</span>,<span class="number">0x35</span>,<span class="number">0x85</span>,<span class="number">0xe2</span>,<span class="number">0xf9</span>,<span class="number">0x37</span>,<span class="number">0xe8</span>,<span class="number">0x1c</span>,<span class="number">0x75</span>,<span class="number">0xdf</span>,<span class="number">0x6e</span>, <span class="comment">/*9*/</span></span><br><span class="line">  <span class="number">0x47</span>,<span class="number">0xf1</span>,<span class="number">0x1a</span>,<span class="number">0x71</span>,<span class="number">0x1d</span>,<span class="number">0x29</span>,<span class="number">0xc5</span>,<span class="number">0x89</span>,<span class="number">0x6f</span>,<span class="number">0xb7</span>,<span class="number">0x62</span>,<span class="number">0x0e</span>,<span class="number">0xaa</span>,<span class="number">0x18</span>,<span class="number">0xbe</span>,<span class="number">0x1b</span>, <span class="comment">/*a*/</span></span><br><span class="line">  <span class="number">0xfc</span>,<span class="number">0x56</span>,<span class="number">0x3e</span>,<span class="number">0x4b</span>,<span class="number">0xc6</span>,<span class="number">0xd2</span>,<span class="number">0x79</span>,<span class="number">0x20</span>,<span class="number">0x9a</span>,<span class="number">0xdb</span>,<span class="number">0xc0</span>,<span class="number">0xfe</span>,<span class="number">0x78</span>,<span class="number">0xcd</span>,<span class="number">0x5a</span>,<span class="number">0xf4</span>, <span class="comment">/*b*/</span></span><br><span class="line">  <span class="number">0x1f</span>,<span class="number">0xdd</span>,<span class="number">0xa8</span>,<span class="number">0x33</span>,<span class="number">0x88</span>,<span class="number">0x07</span>,<span class="number">0xc7</span>,<span class="number">0x31</span>,<span class="number">0xb1</span>,<span class="number">0x12</span>,<span class="number">0x10</span>,<span class="number">0x59</span>,<span class="number">0x27</span>,<span class="number">0x80</span>,<span class="number">0xec</span>,<span class="number">0x5f</span>, <span class="comment">/*c*/</span></span><br><span class="line">  <span class="number">0x60</span>,<span class="number">0x51</span>,<span class="number">0x7f</span>,<span class="number">0xa9</span>,<span class="number">0x19</span>,<span class="number">0xb5</span>,<span class="number">0x4a</span>,<span class="number">0x0d</span>,<span class="number">0x2d</span>,<span class="number">0xe5</span>,<span class="number">0x7a</span>,<span class="number">0x9f</span>,<span class="number">0x93</span>,<span class="number">0xc9</span>,<span class="number">0x9c</span>,<span class="number">0xef</span>, <span class="comment">/*d*/</span></span><br><span class="line">  <span class="number">0xa0</span>,<span class="number">0xe0</span>,<span class="number">0x3b</span>,<span class="number">0x4d</span>,<span class="number">0xae</span>,<span class="number">0x2a</span>,<span class="number">0xf5</span>,<span class="number">0xb0</span>,<span class="number">0xc8</span>,<span class="number">0xeb</span>,<span class="number">0xbb</span>,<span class="number">0x3c</span>,<span class="number">0x83</span>,<span class="number">0x53</span>,<span class="number">0x99</span>,<span class="number">0x61</span>, <span class="comment">/*e*/</span></span><br><span class="line">  <span class="number">0x17</span>,<span class="number">0x2b</span>,<span class="number">0x04</span>,<span class="number">0x7e</span>,<span class="number">0xba</span>,<span class="number">0x77</span>,<span class="number">0xd6</span>,<span class="number">0x26</span>,<span class="number">0xe1</span>,<span class="number">0x69</span>,<span class="number">0x14</span>,<span class="number">0x63</span>,<span class="number">0x55</span>,<span class="number">0x21</span>,<span class="number">0x0c</span>,<span class="number">0x7d</span>  <span class="comment">/*f*/</span></span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 逆行变换 - 以字节为单位循环右移</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">InvShiftRows</span><span class="params">(byte mtx[<span class="number">4</span>*<span class="number">4</span>])</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 第二行循环右移一位</span></span><br><span class="line">  byte temp = mtx[<span class="number">7</span>];</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">3</span>; i&gt;<span class="number">0</span>; --i)</span><br><span class="line">    mtx[i+<span class="number">4</span>] = mtx[i+<span class="number">3</span>];</span><br><span class="line">  mtx[<span class="number">4</span>] = temp;</span><br><span class="line">  <span class="comment">// 第三行循环右移两位</span></span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">2</span>; ++i) &#123;</span><br><span class="line">    temp = mtx[i+<span class="number">8</span>];</span><br><span class="line">    mtx[i+<span class="number">8</span>] = mtx[i+<span class="number">10</span>];</span><br><span class="line">    mtx[i+<span class="number">10</span>] = temp;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 第四行循环右移三位</span></span><br><span class="line">  temp = mtx[<span class="number">12</span>];</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">3</span>; ++i)</span><br><span class="line">    mtx[i+<span class="number">12</span>] = mtx[i+<span class="number">13</span>];</span><br><span class="line">  mtx[<span class="number">15</span>] = temp;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 逆字节替换</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">InvSubBytes</span><span class="params">(byte mtx[<span class="number">4</span>*<span class="number">4</span>])</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">16</span>; ++i) &#123;</span><br><span class="line">    <span class="keyword">int</span> row = mtx[i][<span class="number">7</span>]*<span class="number">8</span> + mtx[i][<span class="number">6</span>]*<span class="number">4</span> + mtx[i][<span class="number">5</span>]*<span class="number">2</span> + mtx[i][<span class="number">4</span>];</span><br><span class="line">    <span class="keyword">int</span> col = mtx[i][<span class="number">3</span>]*<span class="number">8</span> + mtx[i][<span class="number">2</span>]*<span class="number">4</span> + mtx[i][<span class="number">1</span>]*<span class="number">2</span> + mtx[i][<span class="number">0</span>];</span><br><span class="line">    mtx[i] = Inv_S_Box[row][col];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 有限域上的乘法 GF(2^8)</span></span><br><span class="line"><span class="function">byte <span class="title">GFMul</span><span class="params">(byte a, byte b)</span> </span>&#123; </span><br><span class="line">  byte p = <span class="number">0</span>;</span><br><span class="line">  byte hi_bit_set;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> counter = <span class="number">0</span>; counter &lt; <span class="number">8</span>; counter++) &#123;</span><br><span class="line">    <span class="keyword">if</span> ((b &amp; byte(<span class="number">1</span>)) != <span class="number">0</span>) &#123;</span><br><span class="line">      p ^= a;</span><br><span class="line">    &#125;</span><br><span class="line">    hi_bit_set = (byte) (a &amp; byte(<span class="number">0x80</span>));</span><br><span class="line">    a &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (hi_bit_set != <span class="number">0</span>) &#123;</span><br><span class="line">      a ^= <span class="number">0x1b</span>; <span class="comment">/* x^8 + x^4 + x^3 + x + 1 */</span></span><br><span class="line">    &#125;</span><br><span class="line">    b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 逆列混淆</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">InvMixColumns</span><span class="params">(byte mtx[<span class="number">4</span>*<span class="number">4</span>])</span> </span>&#123;</span><br><span class="line">  byte arr[<span class="number">4</span>];</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">4</span>; ++i) &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>; j&lt;<span class="number">4</span>; ++j)</span><br><span class="line">      arr[j] = mtx[i+j*<span class="number">4</span>];</span><br><span class="line"> </span><br><span class="line">    mtx[i] = GFMul(<span class="number">0x0e</span>, arr[<span class="number">0</span>]) ^ GFMul(<span class="number">0x0b</span>, arr[<span class="number">1</span>]) </span><br><span class="line">      ^ GFMul(<span class="number">0x0d</span>, arr[<span class="number">2</span>]) ^ GFMul(<span class="number">0x09</span>, arr[<span class="number">3</span>]);</span><br><span class="line">    mtx[i+<span class="number">4</span>] = GFMul(<span class="number">0x09</span>, arr[<span class="number">0</span>]) ^ GFMul(<span class="number">0x0e</span>, arr[<span class="number">1</span>]) </span><br><span class="line">      ^ GFMul(<span class="number">0x0b</span>, arr[<span class="number">2</span>]) ^ GFMul(<span class="number">0x0d</span>, arr[<span class="number">3</span>]);</span><br><span class="line">    mtx[i+<span class="number">8</span>] = GFMul(<span class="number">0x0d</span>, arr[<span class="number">0</span>]) ^ GFMul(<span class="number">0x09</span>, arr[<span class="number">1</span>]) </span><br><span class="line">      ^ GFMul(<span class="number">0x0e</span>, arr[<span class="number">2</span>]) ^ GFMul(<span class="number">0x0b</span>, arr[<span class="number">3</span>]);</span><br><span class="line">    mtx[i+<span class="number">12</span>] = GFMul(<span class="number">0x0b</span>, arr[<span class="number">0</span>]) ^ GFMul(<span class="number">0x0d</span>, arr[<span class="number">1</span>]) </span><br><span class="line">      ^ GFMul(<span class="number">0x09</span>, arr[<span class="number">2</span>]) ^ GFMul(<span class="number">0x0e</span>, arr[<span class="number">3</span>]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 轮密钥加变换 - 将每一列与扩展密钥进行异或</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">AddRoundKey</span><span class="params">(byte mtx[<span class="number">4</span>*<span class="number">4</span>], word k[<span class="number">4</span>])</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">4</span>; ++i) &#123;</span><br><span class="line">    word k1 = k[i] &gt;&gt; <span class="number">24</span>;</span><br><span class="line">    word k2 = (k[i] &lt;&lt; <span class="number">8</span>) &gt;&gt; <span class="number">24</span>;</span><br><span class="line">    word k3 = (k[i] &lt;&lt; <span class="number">16</span>) &gt;&gt; <span class="number">24</span>;</span><br><span class="line">    word k4 = (k[i] &lt;&lt; <span class="number">24</span>) &gt;&gt; <span class="number">24</span>;</span><br><span class="line">     </span><br><span class="line">    mtx[i] = mtx[i] ^ byte(k1.to_ulong());</span><br><span class="line">    mtx[i+<span class="number">4</span>] = mtx[i+<span class="number">4</span>] ^ byte(k2.to_ulong());</span><br><span class="line">    mtx[i+<span class="number">8</span>] = mtx[i+<span class="number">8</span>] ^ byte(k3.to_ulong());</span><br><span class="line">    mtx[i+<span class="number">12</span>] = mtx[i+<span class="number">12</span>] ^ byte(k4.to_ulong());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 解密</span></span><br><span class="line">void decrypt(byte in[4*4], word w[4*(Nr+1)]) &#123;</span><br><span class="line">  word key[<span class="number">4</span>];</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">4</span>; ++i)</span><br><span class="line">    key[i] = w[<span class="number">4</span>*Nr+i];</span><br><span class="line">  AddRoundKey(in, key);</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> round=Nr<span class="number">-1</span>; round&gt;<span class="number">0</span>; --round) &#123;</span><br><span class="line">    InvShiftRows(in);</span><br><span class="line">    InvSubBytes(in);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">4</span>; ++i)</span><br><span class="line">      key[i] = w[<span class="number">4</span>*round+i];</span><br><span class="line">    AddRoundKey(in, key);</span><br><span class="line">    InvMixColumns(in);</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  InvShiftRows(in);</span><br><span class="line">  InvSubBytes(in);</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">4</span>; ++i)</span><br><span class="line">    key[i] = w[i];</span><br><span class="line">  AddRoundKey(in, key);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="References"><a href="#References" class="headerlink" title="References"></a>References</h3><ul>
<li><a href="http://www.ruanyifeng.com/blog/2006/12/notes_on_cryptography.html">阮一峰: 密码学笔记</a></li>
<li><a href="http://www.jianshu.com/p/7e30a71626a8">DES加密算法：设计与实现</a></li>
<li><a href="http://www.alonemonkey.com/2016/05/25/aes-and-des/">AloneMonkey: DES和AES算法详解</a></li>
<li><a href="http://www.cnblogs.com/songwenlong/p/5944139.html">安全体系（一）—— DES算法详解</a></li>
<li><a href="http://keeganlee.me/post/reading/20160629">Keegan小钢: 读《图解密码技术》(一):密码</a></li>
<li><a href="https://my.oschina.net/zchuanzhao/blog/525898">对称加密算法DES、3DES原理和实现方式</a></li>
<li><a href="https://zh.wikipedia.org/wiki/%E4%B8%89%E9%87%8D%E8%B3%87%E6%96%99%E5%8A%A0%E5%AF%86%E6%BC%94%E7%AE%97%E6%B3%95">Wikipedia：三重資料加密演算法-密钥选项</a></li>
<li><a href="https://songlee24.github.io/2014/12/13/aes-encrypt/">神奕的博客：AES加密算法的C++实现</a></li>
</ul>

      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>本文标题:</span><a href="/2017/07/11/programPearls_DES$3DES$AES/">密码学：DES、3DES、AES</a></p>

        <!-- 
        <p><span>文章作者:</span><a href="/" title="回到主页">Gary</a></p>
        -->
        <p><span>文章作者:</span>Gary</p>

        <p><span>发布时间:</span>2017-07-11, 18:02:16</p>
        <p><span>最后更新:</span>2017-07-14, 17:21:43</p>
        <p>
            <span>原始链接:</span><a class="post-url" href="/2017/07/11/programPearls_DES$3DES$AES/" title="密码学：DES、3DES、AES">http://durant35.github.io/2017/07/11/programPearls_DES$3DES$AES/</a>
            <span class="copy-path" data-clipboard-text="原文: http://durant35.github.io/2017/07/11/programPearls_DES$3DES$AES/　　作者: Gary" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>

        <!-- not to show license information
        <p>
            <span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="CC BY-NC-SA 4.0 International" target = "_blank">"署名-非商用-相同方式共享 4.0"</a> 转载请保留原文链接及作者。
        </p>
        -->
    </div>



    <nav id="article-nav">
        
            <div id="article-nav-newer" class="article-nav-title">
                <a href="/2017/07/13/Algorithms_OnlineJudge4Huawei2017/">
                    算法设计与分析[0023] 秋招华为在线笔试
                </a>
            </div>
        
        
            <div id="article-nav-older" class="article-nav-title">
                <a href="/2017/07/11/programPearls_JPEG$Arithmetic$LZW/">
                    JPEG编码&amp;算术编码、LZW编码
                </a>
            </div>
        
    </nav>

  
</article>

    <div id="toc" class="toc-article">
        <strong class="toc-title">文章目录</strong>
        
            <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#DES-算法"><span class="toc-number">1.</span> <span class="toc-text">DES 算法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#密钥的产生：子密钥-K-i-（48-bit）生成算法"><span class="toc-number">1.1.</span> <span class="toc-text">密钥的产生：子密钥 $K_i$（48 bit）生成算法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#明文加密过程"><span class="toc-number">1.2.</span> <span class="toc-text">明文加密过程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#密文解密过程"><span class="toc-number">1.3.</span> <span class="toc-text">密文解密过程</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3DES-算法"><span class="toc-number">2.</span> <span class="toc-text">3DES 算法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AES-算法"><span class="toc-number">3.</span> <span class="toc-text">AES 算法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#密钥扩展"><span class="toc-number">3.1.</span> <span class="toc-text">密钥扩展</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#加密过程"><span class="toc-number">3.2.</span> <span class="toc-text">加密过程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#解密过程"><span class="toc-number">3.3.</span> <span class="toc-text">解密过程</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#References"><span class="toc-number">4.</span> <span class="toc-text">References</span></a></li></ol>
        
    </div>
    <style>
        .left-col .switch-btn,
        .left-col .switch-area {
            display: none;
        }
        .toc-level-4 i,
        .toc-level-4 ol {
            display: none !important;
        }
    </style>

    <input type="button" id="tocButton" value="隐藏目录"  title="点击按钮隐藏或者显示文章目录">

    <script>
        yiliaConfig.toc = ["隐藏目录", "显示目录", !!"true"];
    </script>



    
<div class="share">
    
        <div class="bdsharebuttonbox">
        <!--
            <a href="#" class="fa fa-twitter bds_twi" data-cmd="twi" title="分享到推特"></a>
        -->
            <a href="#" class="fa fa-weibo bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
            <a href="#" class="fa fa-qq bds_sqq" data-cmd="sqq" title="分享给 QQ 好友"></a>
            <a href="#" class="fa fa-weixin bds_weixin" data-cmd="weixin" title="生成文章二维码"></a>
            <a href="#" class="fa fa-files-o bds_copy" data-cmd="copy" title="复制网址"></a>
        <!--
            <a href="#" class="fa fa fa-envelope-o bds_mail" data-cmd="mail" title="通过邮件分享"></a>
        -->
            <a href="#" class="fa fa-share-alt bds_more" data-cmd="more"></i></a>
        </div>
        <script>
            window._bd_share_config={
                "common":{"bdSnsKey":{},"bdText":"密码学：DES、3DES、AES　| Gary's Blog　","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
        </script>
    

    
</div>







    
        <section id="comments">
    <style> aside.comment-bar { margin: auto 30px; }</style>
    <div id="disqus_thread"></div>
    <script>
        var disqus_config = function(){
            this.page.url = 'http://durant35.github.io/2017/07/11/programPearls_DES$3DES$AES/';
            this.page.identifier = '2017/07/11/programPearls_DES$3DES$AES/';
        };
        var loadComment = function(){
            var d = document, s = d.createElement('script');
            s.src = '//durant35.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        }
    </script>
    
    <script> loadComment(); </script>

</section>


    




    <div class="scroll" id="post-nav-button">
        
            <a href="/2017/07/13/Algorithms_OnlineJudge4Huawei2017/" title="上一篇: 算法设计与分析[0023] 秋招华为在线笔试">
                <i class="fa fa-angle-left"></i>
            </a>
        

        <a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>

        
            <a href="/2017/07/11/programPearls_JPEG$Arithmetic$LZW/" title="下一篇: JPEG编码&amp;算术编码、LZW编码">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>

    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/09/10/cpp_C++ BasicMiscs/">C++ Basic</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/30/TACouses_ES2017_MCU_GPIO/">GPIO 的几种输入输出模式</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/06/VM_VirtualAddr2PhysicalAddr/">虚拟内存[0?] 虚拟内存地址 $\Longrightarrow$ 物理内存地址</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/06/VM_Changes4LifeCycle/">虚拟内存[02] 不同阶段下的内存变化</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/06/VM_MemoryManage/">虚拟内存[0?] 内存管理</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/06/VM0_AddressSpace/">虚拟内存[00] 虚拟内存地址空间</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/29/VM_Stacks/">虚拟内存[02] Linux 中的各种栈：进程栈 线程栈 内核栈 中断栈</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/29/VM1_UserSpaceSegments/">虚拟内存[01] 用户内存空间的各个段分布</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/24/TACouses_ES2017_PriorityInversionbyResourceSharing/">嵌入式系统导论[04] Solutions for Priority Inversion in Real-time Scheduling</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/24/TACouses_ES2017_MoCs/">嵌入式系统导论[03] Model of Computation</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/28/TACouses_ES2017_Java/">嵌入式系统导论[01] Linux 下手动配置 Java 环境</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/26/TACouses_ES2017_SystemC/">嵌入式系统导论[02] 浅谈 System C</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/03/programPearls_Summary after Interview in Robosense/">Summary after Robosense's Interview</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/08/linux_ldconfig4RuntimeLibraries/">ldconfig：[load]运行时库管理</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/21/Algorithms_ICP/">[0024] Iterative Closest Points（迭代最近点）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/21/Algorithms_LeastSquaresLineFitting/">[0025] Least Squares Line Fitting（最小二乘法直线拟合）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/21/programPearls_i=i++/">i = i++;</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/14/tool_CMake_find_package$pkg_check_module/">CMake 查找库: find_package vs pkg_check_modules</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/14/ROS_<arg>$<param>$<rosparam>/">ROS launch file: <arg> vs <param> vs <rosparam></a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/14/hexo_DisqusInsteadofDuoshuo/">hexo：告别多说，拥抱 Disqus</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/14/programPearls_32-bit program on 64-bit OS $ 64-bit program on 32-bit OS/">32-bit program on 64-bit OS & 64-bit program on 32-bit OS</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/13/Algorithms_OnlineJudge4Huawei2017/">算法设计与分析[0023] 秋招华为在线笔试</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/11/programPearls_DES$3DES$AES/">密码学：DES、3DES、AES</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/11/programPearls_JPEG$Arithmetic$LZW/">JPEG编码&算术编码、LZW编码</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/08/Algorithms_BST$R-B Tree/">算法设计与分析[0022] BST（二叉查找树）和 R-B Tree（红黑树）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/07/programPearls_declaration$definition$initialization$assignment/">声明/定义/初始化/赋值</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/06/programPearls_inline$static$const$extern$volatile/">C/C++常见修饰符（inline&static&const&extern&volatile）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/02/Algorithms_BasicMiscs/">算法设计与分析[0021] Some Algorithms Basic Details Review（课程总结）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/26/Algorithms_GraphProblems/">算法设计与分析[0020] 几个有关图的问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/26/Algorithms_GreedyAlgorithms/">算法设计与分析[0019] Greedy Algorithms（贪心策略）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/24/Algorithms_Vertex$Edge connectivity degree/">算法设计与分析[0018] 图的点连通度和边连通度</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/08/Algorithms_NP-Complete(I)/">算法设计与分析[0017] NP-完全问题：概述（两道证明习题）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/02/DARPA_Boss_BossandtheUrbanChallenge/">DARPA[Boss]: Boss and the Urban Challenge</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/02/DARPA_Boss_MotionPlanninginUrbanEnvironments/">DARPA[Boss]: Motion Planning in Urban Environments</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/01/Algorithms_BiGraphMatching/">算法设计与分析[0016] 二分图匹配问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/01/Algorithms_UnionFindSet/">算法设计与分析[0015] Union Find Set（并查集）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/26/Algorithms_Dynamic Programming(V)/">算法设计与分析[0014] Dynamic Programming(V) 一道习题</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/19/Algorithms_MaximizingFlow/">算法设计与分析[0013] 网络流：最大流（Max Flow）问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/16/hsw_CPUWipeoutIlliteracy/">CPU 扫盲（核心数/线程数）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/13/hsw_UbuntuSystemBootSequence/">一张图带你看 Ubuntu(Linux) 系统启动过程</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/12/Algorithms_LongestPalindromicSubsequence/">算法设计与分析[0012] Dynamic Programming(IV)（Longest Palindromic Subsequence）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/03/Algorithms_LongestCommonSubsequence/">算法设计与分析[0011] Dynamic Programming(III)（Longest Common Subsequence）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/28/Algorithms_LongestIncreasingSubsequence/">算法设计与分析[0010] Longest Increasing Subsequence（最长递增子序列）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/23/Algorithms_Dynamic Programming(II)/">算法设计与分析[0009] Dynamic Programming(II)（Maximum Sum/Product Subarray）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/13/Algorithms_Dynamic Programming(I)/">算法设计与分析[0008] Dynamic Programming(I)（Unique Paths）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/06/Algorithms_Minimum Spanning Tree/">算法设计与分析[0007] Minimum Spanning Tree（最小生成树）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/29/Algorithms_Some Shortest-path Algorithms/">算法设计与分析[0006] Some Shortest-path Algorithms（最短路径算法）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/22/Algorithms_BFS/">算法设计与分析[0005] Breadth First Search（广度优先搜索）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/15/Algorithms_DFS/">算法设计与分析[0004] Depth First Search（深度优先搜索）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/10/Algorithms_An Alibaba Interview Question/">算法设计与分析[0003] 一道阿里巴巴面试题（2017） </a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/04/Algorithms_FFT/">算法设计与分析[0002] Divide and Conquer——FFT（快速傅里叶变换）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/26/Algorithms_Divide and Conquer/">算法设计与分析[0001] Divide and Conquer </a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/04/cv_Digital-Image-Process(pg_2016)/">Digital Image Process</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/04/linux_LinuxCommandNotes/">Linux命令小纸条</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/04/tool_vim几步走/">vim几步走</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/04/TACourses_Summer-trainning-in-July,2016/">Summer-trainning in July, 2016</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/02/hexo-md源文件内容修改预览页面刷新无效/">hexo，md源文件内容修改预览页面刷新无效</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/25/raspberry_using_an_external_wireless_card(CF-WU855P)/">RaspberryPi, Use an external wireless card(ComFast-WU855P)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/25/raspberry_enable-ssh-without-UI/">RaspberryPi, enable ssh without UI</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/24/python_sort-Functions/">8 sort functions using python</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/10/linux_libpcap 32-bit$64-bit/">libpcap, 32-bit&64-bit</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/09/OverlappingSounds_Key Word Engineering/">Key Word Engineering</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/07/hexo_Theme Yelee Migrant Note(2)/">hexo博客主题Yelee迁移笔记(二)</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/03/ROS_ROS_Navigation_GettingStarted/">初识ROS自主导航</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/03/linux_sudo_unable_to_resolve_host/">sudo, unable to resolve host</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/02/ROS_ROS_Basics/">ROS Basics</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/01/TACouses_Embedded_System_2016/">嵌入式系统导论[00] Overview, DOL and MPARM</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/17/hsw_从VS的dumpbin目录谈x86,i386,x86-64,amd64/">从 VS 的 dumpbin 目录谈 x86、xi386、x86-64、amd64...</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/16/hexo_Theme Yelee Migrant Note/">hexo博客主题Yelee迁移笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/16/programPearls_dumpbin指南/">dumpbin 指南</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/08/programPearls_Win$Linux下操作ini配置文件(DIY)/">Win/Linux下操作ini配置文件(DIY)</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/08/programPearls_Win$Linux下基本文件操作/">Win/Linux下基本文件操作</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/08/programPearls_Win$Linux Operate ini configuration files(API)/">Win/Linux下操作ini配置文件(API)</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/08/programPearls_precise delay using select/">使用 select 函数实现更为精确的延时</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/08/linux_瞎谈Socket编程_3/">瞎谈Socket编程(三) Win/Linux下的UDP编程</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/26/tool_git几步走/">git几步走</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/16/linux_瞎谈Socket编程_2/">瞎谈 Socket 编程(二)</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/16/hexo_hexo分级目录与多标签/">hexo分级目录与多标签</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/15/linux_瞎谈Socket编程_1/">瞎谈 Socket 编程(一)</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/02/programPearls_C语言中结构体内存free/">C语言中结构体内存free</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/30/programPearls_Java到底是不是一种纯面向对象语言？/">Java到底是不是一种纯面向对象语言？</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/12/OverlappingSounds_写于幸运保研后/">写于幸运保研后</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/09/OverlappingSounds_Basketball_Never_Stops/">Basketball Never Stops</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/21/tool_CMake_快速入门/">CMake 快速入门</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/21/programPearls_.h中的ifndef..define..endif/">.h中的#ifndef..#define..#endif</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/25/programPearls_Coding中的编码问题之回顾$深入/">Coding中的编码问题之回顾&深入</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/22/programPearls_Coding中的编码问题之系统学习/">Coding中的编码问题之系统学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/21/programPearls_Coding中的编码问题之入门$概览/">Coding中的编码问题之入门&概览</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/16/mcu_老顽童STM32开发板系列教程笔记/">老顽童STM32开发板系列教程笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/11/movies_漫威电影/">漫威21部系列电影(持续更新)</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/02/programPearls_Qt_借Qt中文乱码谈谈Coding中的编码问题/">借Qt中文乱码谈谈Coding中的编码问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/02/System_Win8.1简体中文系统切换到繁体中文系统/">Win8.1简体中文系统切换到繁体中文系统</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/02/tool_NotePad/">NotePad++</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/02/hexo_在hexo new之后立即打开新建的Markdown文稿/">在hexo new之后立即打开Markdown文稿</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/01/26/hexo_自定义主题/">hexo自定义主题</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/01/26/hexo_添加about导航栏/">hexo添加about导航栏</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/01/24/hexo_hexo错误的分类或标签无法删除/">hexo错误的分类或标签无法删除</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/01/24/hexo_hexo扫盲/">hexo扫盲</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/01/24/hexo_2.0x hexo迁移至最新版本笔记/">2.0x hexo迁移至最新版本笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/01/22/hexo_push你的新博客到Github/">hexo，push你的新博客到Github</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/11/29/iotCourse_03_ADO连接MySQL数据库/">ADO连接MySQL数据库</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/10/16/iotCourse_02 Windows下的静态库和动态库/">Windows下的静态库和动态库</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/10/03/graduatedesign_02 MFRC500-射频芯片射频读写模块完整设计/">MFRC500 射频芯片射频读写模块完整设计</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/09/28/iotCourse_01 MFC-TabControl控件实现选项卡功能/">MFC TabControl控件实现选项卡功能</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/07/15/Android_快速搭建Android-ADT开发环境-基于Win7-Win8-1-其他仅供参考/">快速搭建Android ADT开发环境(基于Win7&Win8.1(both 64-bit),其他仅供参考)</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/07/09/graduatedesign_01 STM32_Keil$JLink/">(一) 搭建STM32开发环境</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/06/16/opengl_数媒HW4参考资料/">数媒HW4参考资料</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/05/24/opencl_写两个星期OpenCL先-1/">写两个星期OpenCL先(1)</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/05/24/opencl_win7-64位下VS搭建OpenCL开发环境-Intel显卡/">win7 64位下VS2012搭建OpenCL开发环境(Intel显卡)[win8.1下VS2013亲测同样可行]</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/05/16/JSP考勤系统-二-JDBC连接MySQL数据库/">JSP考勤系统(二) JDBC连接MySQL数据库</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/05/15/JSP考勤系统-一-站点框架介绍与入门/">JSP考勤系统(一) 站点框架介绍与入门</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/05/11/考勤系统-四-MFC-UI控件之ListCtrl/">考勤系统(四) MFC UI控件之ListCtrl</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/05/11/考勤系统-三-MFC-UI控件之ComboBox/">考勤系统(三) MFC UI控件之ComboBox</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/05/06/考勤系统-一-搭建起项目需要的开发环境/">考勤系统(一) 搭建起项目需要的开发环境</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/04/30/考勤系统-二-MFC-ADO连接MySQL数据库/">考勤系统(二) MFC ADO连接MySQL数据库</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/04/30/hexo_win搭建hexo/">win搭建hexo</a></li></ul>




    <script>
        
    </script>



</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i> 
                2014-2018 Gary
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的博客框架">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减 Hexo 双栏博客主题  v3.5">Yelee</a> by <a href="http://moxfive.xyz/" target="_blank"> MOxFIVE </a><i class="fa fa-heart animated infinite pulse"></i>
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" title="本站到访数"><i class="fa fa-user" aria-hidden="true"></i><span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>| </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit"  title="本页阅读量"><i class="fa fa-eye animated infinite pulse" aria-hidden="true"></i><span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>
    </div>
    
<script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.2.0/require.min.js"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 5;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>





    <script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<div class="scroll" id="scroll">
    <a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" onclick="load$hide();" title="查看评论"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        var oOpenInNew = {
            
            
             post: ".article-entry a[href], .copyright a[href]", 
            
            
            
            
            
            
             friends: "#js-friends a", 
             socail: ".social a" 
        }
        for (var x in oOpenInNew) {
            $(oOpenInNew[x]).attr("target", "_blank");
        }
    
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
</body>
</html>